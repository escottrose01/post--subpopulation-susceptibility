!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function r(){}n.r(e);function a(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(a)}function l(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t){return 0===Object.keys(t).length}new Set;let u=!1;function d(t,e){t.appendChild(e)}function p(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode.removeChild(t)}function h(t){return document.createElement(t)}function m(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function y(t){return document.createTextNode(t)}function g(){return y(" ")}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function $(t,e,n,r){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}new Map;let x;function w(t){x=t}function k(){if(!x)throw new Error("Function called outside component initialization");return x}function S(t){k().$$.on_mount.push(t)}const L=[],I=[],_=[],M=[],E=Promise.resolve();let A=!1;function j(){A||(A=!0,E.then(C))}function P(t){_.push(t)}const D=new Set;let T=0;function C(){const t=x;do{for(;T<L.length;){const t=L[T];T++,w(t),O(t.$$)}for(w(null),L.length=0,T=0;I.length;)I.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];D.has(e)||(D.add(e),e())}_.length=0}while(L.length);for(;M.length;)M.pop()();A=!1,D.clear(),w(t)}function O(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(P)}}const B=new Set;function q(t,e){t&&t.i&&(B.delete(t),t.i(e))}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let z;function F(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function N(t,e,n,i,c,d,p,h=[-1]){const m=x;w(t);const y=t.$$={fragment:null,ctx:null,props:d,update:r,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(m?m.$$.context:[])),callbacks:o(),dirty:h,skip_bound:!1,root:e.target||m.$$.root};p&&p(y.root);let g=!1;if(y.ctx=n?n(t,e.props||{},(e,n,...r)=>{const a=r.length?r[0]:n;return y.ctx&&c(y.ctx[e],y.ctx[e]=a)&&(!y.skip_bound&&y.bound[e]&&y.bound[e](a),g&&function(t,e){-1===t.$$.dirty[0]&&(L.push(t),j(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),n}):[],y.update(),g=!0,s(y.before_update),y.fragment=!!i&&i(y.ctx),e.target){if(e.hydrate){u=!0;const t=(v=e.target,Array.from(v.childNodes));y.fragment&&y.fragment.l(t),t.forEach(f)}else y.fragment&&y.fragment.c();e.intro&&q(t.$$.fragment),function(t,e,n,r){const{fragment:o,on_mount:i,on_destroy:c,after_update:u}=t.$$;o&&o.m(e,n),r||P(()=>{const e=i.map(a).filter(l);c?c.push(...e):s(e),t.$$.on_mount=[]}),u.forEach(P)}(t,e.target,e.anchor,e.customElement),u=!1,C()}var v;w(m)}"function"==typeof HTMLElement&&(z=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(a).filter(l);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){s(this.$$.on_disconnect)}$destroy(){F(this,1),this.$destroy=r}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class Z{$destroy(){F(this,1),this.$destroy=r}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function H(t){return function(t){if(Array.isArray(t))return R(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return R(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function U(t){return Array(t).fill().map((function(t,e){return e}))}function G(t,e,n){var r=e[0],a=e[1],o=(-t[2]-r*t[0])/t[1],s=(-t[2]-a*t[0])/t[1],l=[],i=[[r,n[0]],[r,n[1]],[a,n[1]],[a,n[0]],[r,n[0]]];if(o>n[1]&&s>n[1]){var c=[l,i];i=c[0],l=c[1]}else l=[[r,o],[a,s],[a,Math.min(o,n[0])],[r,Math.min(o,n[0])],[r,o]],i=[[r,o],[a,s],[a,Math.max(o,n[1])],[r,Math.max(o,n[1])],[r,o]];return{boundary:[[r,o],[a,s]],below:l,above:i}}var J={state:1,m:2147483648,a:1103515245,c:12345};function K(){return J.state=(J.a*J.state+J.c)%J.m,J.state/(J.m-1)}function Q(){for(var t=0,e=0;0===t;)t=K();for(;0===e;)e=K();return Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*e)}function V(t){return parseInt(t*K())%t}function W(t,e,n,r){var a=[],o=[];J.state=r;V(2),V(2);[-1,1].forEach((function(r){for(var s=K()+.5,l=K()+.5,i=Q()/2,c=U(t/2).map((function(){var t=[r*n+s*Q(),r*n+l*Q()];return t[1]+=i*t[0],t})),u=0;u<2;++u);a=a.concat(c),o=o.concat(U(t/2).map((function(){return 2*K()<e?-r:r})))}));for(var s=function(t){var e=[Math.min.apply(Math,H(a.map((function(e){return e[t]})))),Math.max.apply(Math,H(a.map((function(e){return e[t]}))))],n=e[0],r=e[1]-n;a=a.map((function(e){return e[t]=(e[t]-n)/r,e}))},l=0;l<2;++l)s(l);return a.map((function(t,e){return{x:t,y:o[e],subpops:[]}}))}function X(t){let e,n,a,o,s,l,i,c,u,x,w,k,S,L,I,_,M,E,A,j,P,D;return{c(){e=m("svg"),n=m("text"),a=y(t[6]),o=y(" / "),s=y(t[7]),l=y(" Poisons"),i=g(),c=h("canvas"),u=g(),x=h("button"),w=m("svg"),k=m("path"),S=g(),L=h("button"),I=m("svg"),_=m("path"),M=g(),E=h("button"),A=m("svg"),j=m("path"),P=g(),D=h("input"),v(n,"text-anchor","middle"),v(n,"x","50%"),v(n,"y","99%"),v(e,"width",Y),v(e,"height",tt),v(e,"class","overlay"),v(c,"width",Y),v(c,"height",tt),v(k,"d",et),v(k,"fill","#888"),v(w,"width","10"),v(w,"height","10"),v(w,"viewBox","0 0 10 10"),v(x,"class","button play-button"),$(x,"cursor","pointer"),v(_,"d",nt),v(_,"fill","#888"),v(I,"width","10"),v(I,"height","10"),v(I,"viewBox","0 0 10 10"),v(L,"class","button step-forward-button"),$(L,"cursor","pointer"),v(j,"d",rt),v(j,"fill","#888"),v(A,"width","10"),v(A,"height","10"),v(A,"viewBox","0 0 10 10"),v(E,"class","button step-back-button"),$(E,"cursor","pointer"),v(D,"type","range"),v(D,"class","slider attack-slider"),v(D,"min","0"),v(D,"max","1"),D.value="0"},m(r,f){p(r,e,f),d(e,n),d(n,a),d(n,o),d(n,s),d(n,l),t[11](e),p(r,i,f),p(r,c,f),t[12](c),p(r,u,f),p(r,x,f),d(x,w),d(w,k),t[13](x),p(r,S,f),p(r,L,f),d(L,I),d(I,_),t[14](L),p(r,M,f),p(r,E,f),d(E,A),d(A,j),t[15](E),p(r,P,f),p(r,D,f),t[16](D)},p(t,[e]){64&e&&b(a,t[6]),128&e&&b(s,t[7])},i:r,o:r,d(n){n&&f(e),t[11](null),n&&f(i),n&&f(c),t[12](null),n&&f(u),n&&f(x),t[13](null),n&&f(S),n&&f(L),t[14](null),n&&f(M),n&&f(E),t[15](null),n&&f(P),n&&f(D),t[16](null)}}}const Y=704,tt=600,et="M 0 0 L 0 10 L 3 10 L 3 0 Z M 6 0 L 6 10 L 9 10 L 9 0 Z",nt="M 0 0 L 3 0 L 9 5 L 3 10 L 0 10 L 0 10 L 6 5 L 0 0",rt="M 9 0 L 6 0 L 0 5 L 6 10 L 9 10 L 9 10 L 3 5 L 9 0";function at(t,e,n){let r,a,o,s,l,i,{initSpIndex:c}=e,{data:u}=e,{fID:d}=e,p=c,f=-1,h=0,m=[],y=u.attacks[p].poisons.length,g=Math.max(Math.min(15,parseInt((y+1)/10)),1),v=!0,b=!1;const $=()=>{let t=u.dset;const e=t=>t.x[0],c=t=>t.x[1],$=t=>null==t.subpops?1==t.y?"blue-poison":"red-poison":t.subpops.includes(p)?"target-point":t.subpops.includes(f)?"selected-point":1==t.y?"blue-point":"red-point",x=60,w=40,k=Y-w-40,S=tt-x-60;let L=d3.extent(t,e);L=[L[0]-.1,L[1]+.1];const I=d3.scaleLinear().domain(L).range([0,k]).nice();let _=d3.extent(t,c);_=[_[0]-.1,_[1]+.1];const M=d3.scaleLinear().domain(_).range([S,0]).nice(),E=d3.select(a).attr("pointer-events","none").append("g").attr("transform",`translate(${w},${x})`),A=d3.select(a).attr("pointer-events","none").append("g").attr("transform",`translate(${w},${x})`),j=d3.select(a).attr("pointer-events","none").append("g").attr("transform",`translate(${w},${x})`),P=d3.select(a).attr("pointer-events","none").append("g").attr("transform",`translate(${w},${x})`),D=d3.axisBottom(I).tickSize(-S).tickPadding(15),T=d3.axisLeft(M).tickSize(-k).tickPadding(10);A.append("g").call(T),A.append("g").call(D).attr("transform",`translate(0,${S})`);let C=d3.line().x(t=>I(t[0])).y(t=>M(t[1]));P.append("clipPath").attr("id","rect-clip"+d).append("rect").attr("x",0).attr("y",0).attr("width",k).attr("height",S);const O=P.append("line").style("stroke","darkgray").style("stroke-width",5).attr("clip-path",`url(#rect-clip${d})`),B=P.append("line").style("stroke","black").style("stroke-width",5).attr("clip-path",`url(#rect-clip${d})`),q=E.append("path").attr("clip-path",`url(#rect-clip${d})`),z=E.append("path").attr("clip-path",`url(#rect-clip${d})`);let F=A.selectAll("circle").data(t).enter().append("circle").attr("class",$).attr("cx",t=>I(e(t))).attr("cy",t=>M(c(t))),N=j.selectAll("path");const Z=()=>{N.attr("class",$),F.attr("class",$)},H=t=>{v=null==t?!v:t,d3.select(s).select("svg").select("path").attr("d",v?et:"M 0 0 L 10 5 L 0 10 Z")},R=()=>{v&&!b&&(n(2,o.value=(+o.value+1)%(y+1),o),K(!1),h==y&&(b=!0,setTimeout(()=>b=!1,1e3))),setTimeout(R,1e3/g)},U=()=>{let t,e=u.attacks[p].im_models[0],n=u.attacks[p].im_models[h];t=G(e,L,_),O.attr("x1",I(t.boundary[0][0])).attr("x2",I(t.boundary[1][0])).attr("y1",M(t.boundary[0][1])).attr("y2",M(t.boundary[1][1])),t=G(n,L,_),B.attr("x1",I(t.boundary[0][0])).attr("x2",I(t.boundary[1][0])).attr("y1",M(t.boundary[0][1])).attr("y2",M(t.boundary[1][1])),q.attr("d",C(t.below)).attr("class",n[1]<0?"area-blue":"area-red"),z.attr("d",C(t.above)).attr("class",n[1]<0?"area-red":"area-blue")},J=()=>{m.forEach((t,e)=>t.id=e.toString()),N=j.selectAll("path").data(m,t=>t.id),N.enter().append("path").attr("class",t=>$(t)).attr("d",d3.symbol().type(d3.symbolCross).size(600)).attr("transform",t=>`translate(${I(e(t))},${M(c(t))})`).transition().duration(200).attr("d",d3.symbol().type(d3.symbolCross).size(200)),N.exit().remove()},K=t=>{t&&H(!1),n(6,h=+o.value),m=u.attacks[p].poisons.slice(0,h),J(),U()};d3.select(r).on("mousemove",t=>{let e,[n,r]=d3.pointer(t);n-=w,r-=x,[n,r]=[I.invert(n),M.invert(r)],[e,f]=u.cluster_centers.map((t,e)=>{return[(a=t,o=[n,r],s=o[0]-a[0],l=o[1]-a[1],s*s+l*l),e];var a,o,s,l}).reduce((t,e)=>e[0]<t[0]?e:t),e>.05&&(f=-1),Z()}).on("click",t=>{-1!=f&&f!=p&&(p=f,n(7,y=u.attacks[p].poisons.length),g=Math.max(Math.min(15,parseInt((y+1)/10)),1),n(2,o.value=n(6,h=0),o),d3.select(o).attr("max",y),K(),Z())}).on("mouseout",t=>{f=-1,Z(),U()}),d3.select(o).attr("max",y).on("input",()=>K(!0)),d3.select(s).on("click",H),d3.select(l).on("click",()=>{n(2,o.value=Math.min(+o.value+1,y),o),K(!0)}),d3.select(i).on("click",()=>{n(2,o.value=Math.max(+o.value-1,0),o),K(!0)}),J(),J(),U(),setTimeout(R,1e3/g)};return S(()=>{$()}),t.$$set=t=>{"initSpIndex"in t&&n(8,c=t.initSpIndex),"data"in t&&n(9,u=t.data),"fID"in t&&n(10,d=t.fID)},[r,a,o,s,l,i,h,y,c,u,d,function(t){I[t?"unshift":"push"](()=>{a=t,n(1,a)})},function(t){I[t?"unshift":"push"](()=>{r=t,n(0,r)})},function(t){I[t?"unshift":"push"](()=>{s=t,n(3,s)})},function(t){I[t?"unshift":"push"](()=>{l=t,n(4,l)})},function(t){I[t?"unshift":"push"](()=>{i=t,n(5,i)})},function(t){I[t?"unshift":"push"](()=>{o=t,n(2,o)})}]}var ot=class extends Z{constructor(t){super(),N(this,t,at,X,i,{initSpIndex:8,data:9,fID:10})}};function st(t){let e,n,a;return{c(){e=m("svg"),n=g(),a=h("canvas"),v(e,"width",lt),v(e,"height",it),v(e,"class","overlay"),v(a,"width",lt),v(a,"height",it)},m(r,o){p(r,e,o),t[4](e),p(r,n,o),p(r,a,o),t[5](a)},p:r,i:r,o:r,d(r){r&&f(e),t[4](null),r&&f(n),r&&f(a),t[5](null)}}}const lt=984,it=450;function ct(t,e,n){let r,a,o,s,l,i,c,u,{fID:d}=e,{controls:p}=e,f=0,h=1,m=1,y=W(128,f,h,m),g=-1,v=[],b=[];const $=()=>{const t=t=>t.x[0],e=t=>t.x[1],n=t=>null==t.subpops?1==t.y?"blue-poison":"red-poison":t.subpops.includes(0)?"target-point":t.subpops.includes(g)?"selected-point":1==t.y?"blue-point":"red-point",$=5,x=40,w=lt-x-40,k=it-$-150;let S=[0,1],L=[S[0]-.1,S[1]+.1];const I=d3.scaleLinear().domain(L).range([0,w]).nice();let _=[-0,1],M=[_[0]-.1,_[1]+.1];const E=d3.scaleLinear().domain(M).range([k,0]).nice(),A=d3.select(a).attr("pointer-events","none").append("g").attr("transform",`translate(${x},${$})`),j=d3.select(a).attr("pointer-events","none").append("g").attr("transform",`translate(${x},${$})`),P=d3.select(a).attr("pointer-events","none").append("g").attr("transform",`translate(${x},${$})`),D=d3.select(a).attr("pointer-events","none").append("g").attr("transform",`translate(${x},${$})`),T=d3.select(a).attr("pointer-events","none").append("g").attr("transform",`translate(${x},${$})`),C=d3.axisBottom(I).tickSize(-k).tickPadding(15),O=d3.axisLeft(E).tickSize(-w).tickPadding(10);j.append("g").call(O),j.append("g").call(C).attr("transform",`translate(0,${k})`);d3.line().x(t=>I(t[0])).y(t=>E(t[1]));T.append("clipPath").attr("id","rect-clip"+d).append("rect").attr("x",0).attr("y",0).attr("width",w).attr("height",k);T.append("line").style("stroke","darkgray").style("stroke-width",5).attr("clip-path",`url(#rect-clip${d})`),T.append("line").style("stroke","black").style("stroke-width",5).attr("clip-path",`url(#rect-clip${d})`),A.append("path").attr("clip-path",`url(#rect-clip${d})`),A.append("path").attr("clip-path",`url(#rect-clip${d})`);let B=j.selectAll("circle").data(y).enter().append("circle").attr("class",n).attr("cx",e=>I(t(e))).attr("cy",t=>E(e(t))),q=P.selectAll("path"),z=D.selectAll("path");o=d3.select(p).select("#alphaSlider"),s=d3.select(p).select("#betaSlider"),l=d3.select(p).select("#seedSlider"),i=d3.select(p).selectAll("svg").select("#alphaText"),c=d3.select(p).selectAll("svg").select("#betaText"),u=d3.select(p).selectAll("svg").select("#seedText");const F=()=>{q.attr("class",n),B.attr("class",n)},N=r=>{switch(r){case"alpha":h=.25*+o.node().value,i.text("Class Separation α = "+h.toFixed(2));break;case"beta":f=.1*+s.node().value,c.text("Random Label Fraction β = "+f.toFixed(2));break;case"seed":m=+l.node().value,u.text("Dataset Seed s = "+m)}y=W(128,f,h,m),B=j.selectAll("circle").data(y),B.data(y).attr("class",n).transition().duration(250).attr("cx",e=>I(t(e))).attr("cy",t=>E(e(t))),B.exit().remove()};d3.select(r).on("mousemove",r=>{let[a,o]=d3.pointer(r);a-=x,o-=$,[a,o]=[I.invert(a),E.invert(o)],b=a>=S[0]&&a<=S[1]&&o>=_[0]&&o<=_[1]?[{x:[a,o],y:1}]:[],z=D.selectAll("path").data(b),z.exit().remove(),z.attr("d",d3.symbol().type(d3.symbolCross).size(200)).attr("transform",n=>`translate(${I(t(n))},${E(e(n))})`).enter().append("path").attr("class",n).attr("d",d3.symbol().type(d3.symbolCross).size(200)).attr("transform",n=>`translate(${I(t(n))},${E(e(n))})`),F()}).on("click",r=>{let[a,o]=d3.pointer(r);a-=x,o-=$,[a,o]=[I.invert(a),E.invert(o)];let s=[a,o];a>=S[0]&&a<=S[1]&&o>=_[0]&&o<=_[1]&&(v.push({x:s,y:1}),q=P.selectAll("path").data(v),q.enter().append("path").attr("class",n).attr("d",d3.symbol().type(d3.symbolCross).size(200)).attr("transform",n=>`translate(${I(t(n))},${E(e(n))})`)),console.log(v)}).on("mouseout",t=>{g=-1,F(),z.data([]).exit().remove()}),o.on("input",()=>N("alpha")),s.on("input",()=>N("beta")),l.on("change",()=>N("seed"))};return S(()=>{$()}),t.$$set=t=>{"fID"in t&&n(2,d=t.fID),"controls"in t&&n(3,p=t.controls)},[r,a,d,p,function(t){I[t?"unshift":"push"](()=>{a=t,n(1,a)})},function(t){I[t?"unshift":"push"](()=>{r=t,n(0,r)})}]}var ut=class extends Z{constructor(t){super(),N(this,t,ct,st,i,{fID:2,controls:3})}},dt=0,pt=document.getElementById("svelte-poison-demo-dfigure");pt.addEventListener("ready",(function(){var t=pt.querySelector("#svelte-demo-target"),e=pt.querySelector("#svelte-demo-controls");new ut({target:t,props:{fID:dt++,controls:e}})}));var ft=document.getElementById("svelte-scatterplot-dfigure-example1");ft.addEventListener("ready",(function(){fetch("https://escottrose01.github.io/poisoning-data/1.00-0.1-5.json").then((function(t){return t.json()})).then((function(t){var e=ft.querySelector("#svelte-scatterplot-target");new ot({target:e,props:{data:t,initSpIndex:6,fID:dt++}})}))}));var ht=document.getElementById("svelte-scatterplot-dfigure-example2");ht.addEventListener("ready",(function(){fetch("https://escottrose01.github.io/poisoning-data/2.00-1.0-4.json").then((function(t){return t.json()})).then((function(t){var e=ht.querySelector("#svelte-scatterplot-target");new ot({target:e,props:{data:t,initSpIndex:6,fID:dt++}})}))}));var mt=document.getElementById("svelte-scatterplot-dfigure-example3");mt.addEventListener("ready",(function(){fetch("https://escottrose01.github.io/poisoning-data/0.00-0.0-4.json").then((function(t){return t.json()})).then((function(t){var e=mt.querySelector("#svelte-scatterplot-target");new ot({target:e,props:{data:t,initSpIndex:8,fID:dt++}})}))}));var yt=document.getElementById("svelte-scatterplot-dfigure-example4");yt.addEventListener("ready",(function(){fetch("https://escottrose01.github.io/poisoning-data/2.00-0.0-4.json").then((function(t){return t.json()})).then((function(t){var e=yt.querySelector("#svelte-scatterplot-target");new ot({target:e,props:{data:t,initSpIndex:4,fID:dt++}})}))}));var gt=document.getElementById("svelte-scatterplot-dfigure-example5");gt.addEventListener("ready",(function(){fetch("https://escottrose01.github.io/poisoning-data/data/2.00-0.0-4.json").then((function(t){return t.json()})).then((function(t){var e=gt.querySelector("#svelte-scatterplot-target");new ot({target:e,props:{data:t,initSpIndex:3,fID:dt++}})}))}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9pbnRlcm5hbC9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwuanMiLCJ3ZWJwYWNrOi8vL2F0dGFjay1hbmltYXRpb24uc3ZlbHRlIiwid2VicGFjazovLy9wb2lzb25pbmctZGVtby5zdmVsdGUiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwibm9vcCIsInJ1biIsImZuIiwiYmxhbmtfb2JqZWN0IiwicnVuX2FsbCIsImZucyIsImZvckVhY2giLCJpc19mdW5jdGlvbiIsInRoaW5nIiwic2FmZV9ub3RfZXF1YWwiLCJhIiwiYiIsImlzX2VtcHR5Iiwib2JqIiwia2V5cyIsImxlbmd0aCIsIlNldCIsImlzX2h5ZHJhdGluZyIsImFwcGVuZCIsInRhcmdldCIsIm5vZGUiLCJhcHBlbmRDaGlsZCIsImluc2VydCIsImFuY2hvciIsImluc2VydEJlZm9yZSIsImRldGFjaCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInN2Z19lbGVtZW50IiwiY3JlYXRlRWxlbWVudE5TIiwiZGF0YSIsImNyZWF0ZVRleHROb2RlIiwic3BhY2UiLCJhdHRyIiwiYXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiZ2V0QXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwic2V0X2RhdGEiLCJ0ZXh0Iiwid2hvbGVUZXh0Iiwic2V0X3N0eWxlIiwiaW1wb3J0YW50Iiwic3R5bGUiLCJyZW1vdmVQcm9wZXJ0eSIsInNldFByb3BlcnR5IiwiTWFwIiwiY3VycmVudF9jb21wb25lbnQiLCJzZXRfY3VycmVudF9jb21wb25lbnQiLCJjb21wb25lbnQiLCJnZXRfY3VycmVudF9jb21wb25lbnQiLCJFcnJvciIsIm9uTW91bnQiLCIkJCIsIm9uX21vdW50IiwicHVzaCIsImRpcnR5X2NvbXBvbmVudHMiLCJiaW5kaW5nX2NhbGxiYWNrcyIsInJlbmRlcl9jYWxsYmFja3MiLCJmbHVzaF9jYWxsYmFja3MiLCJyZXNvbHZlZF9wcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJ1cGRhdGVfc2NoZWR1bGVkIiwic2NoZWR1bGVfdXBkYXRlIiwidGhlbiIsImZsdXNoIiwiYWRkX3JlbmRlcl9jYWxsYmFjayIsInNlZW5fY2FsbGJhY2tzIiwiZmx1c2hpZHgiLCJzYXZlZF9jb21wb25lbnQiLCJ1cGRhdGUiLCJwb3AiLCJjYWxsYmFjayIsImhhcyIsImFkZCIsImNsZWFyIiwiZnJhZ21lbnQiLCJiZWZvcmVfdXBkYXRlIiwiZGlydHkiLCJjdHgiLCJhZnRlcl91cGRhdGUiLCJvdXRyb2luZyIsInRyYW5zaXRpb25faW4iLCJibG9jayIsImxvY2FsIiwiZGVsZXRlIiwid2luZG93IiwiZ2xvYmFsVGhpcyIsImdsb2JhbCIsIlN2ZWx0ZUVsZW1lbnQiLCJkZXN0cm95X2NvbXBvbmVudCIsImRldGFjaGluZyIsIm9uX2Rlc3Ryb3kiLCJpbml0Iiwib3B0aW9ucyIsImluc3RhbmNlIiwiY3JlYXRlX2ZyYWdtZW50Iiwibm90X2VxdWFsIiwicHJvcHMiLCJhcHBlbmRfc3R5bGVzIiwicGFyZW50X2NvbXBvbmVudCIsImJvdW5kIiwib25fZGlzY29ubmVjdCIsImNvbnRleHQiLCJjYWxsYmFja3MiLCJza2lwX2JvdW5kIiwicm9vdCIsInJlYWR5IiwicmV0IiwicmVzdCIsImZpbGwiLCJtYWtlX2RpcnR5IiwiaHlkcmF0ZSIsIm5vZGVzIiwiZWxlbWVudCIsIkFycmF5IiwiZnJvbSIsImNoaWxkTm9kZXMiLCJpbnRybyIsImN1c3RvbUVsZW1lbnQiLCJuZXdfb25fZGVzdHJveSIsIm1hcCIsImZpbHRlciIsIm1vdW50X2NvbXBvbmVudCIsIkhUTUxFbGVtZW50Iiwic3VwZXIiLCJ0aGlzIiwiYXR0YWNoU2hhZG93Iiwic2xvdHRlZCIsIl9vbGRWYWx1ZSIsIm5ld1ZhbHVlIiwiJGRlc3Ryb3kiLCJ0eXBlIiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiJCRwcm9wcyIsIiQkc2V0IiwiU3ZlbHRlQ29tcG9uZW50IiwicmFuZ2UiLCJfIiwiZ2V0TW9kZWxTaGFwZSIsInRoZXRhIiwieGxpbSIsInlsaW0iLCJ4MSIsIngyIiwieTEiLCJ5MiIsImJlbG93IiwiYWJvdmUiLCJNYXRoIiwibWluIiwibWF4IiwiYm91bmRhcnkiLCJybmciLCJzdGF0ZSIsInJhbmRvbSIsInJhbmRHYXVzcyIsInUiLCJ2Iiwic3FydCIsImxvZyIsImNvcyIsIlBJIiwicmFuZEludCIsInBhcnNlSW50IiwibWFrZV9jbGFzc2lmaWNhdGlvbiIsIm5fc2FtcGxlcyIsImZsaXBfeSIsImNsYXNzX3NlcCIsInNlZWQiLCJYIiwieSIsImxhYmVsIiwiczEiLCJzMiIsImNsdXN0ZXIiLCJlIiwiY29uY2F0IiwieCIsInhNaW4iLCJwMnAiLCJzdWJwb3BzIiwicGF1c2VQYXRoIiwic3RlcEZvcndhcmRQYXRoIiwic3RlcEJhY2tQYXRoIiwid2lkdGgiLCJoZWlnaHQiLCJjYW52YXMiLCJzdmciLCJzbGlkZXIiLCJwbGF5QnV0dG9uIiwic3RlcEZvcndhcmRCdXR0b24iLCJzdGVwQmFja0J1dHRvbiIsImluaXRTcEluZGV4IiwiZklEIiwic3BfaW5kZXgiLCJob3Zlcl9pbmRleCIsInBvaXNvbkluZGV4IiwicG9pc29ucyIsIm5Qb2lzb25zIiwiYXR0YWNrcyIsImZyYW1lcmF0ZSIsImlzUGxheWluZyIsIndhaXRpbmciLCJyZW5kZXIiLCJkc2V0IiwieFZhbHVlIiwieVZhbHVlIiwiZ2V0Q2xhc3MiLCJ1bmRlZmluZWQiLCJpbmNsdWRlcyIsIm1hcmdpbiIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsImV4dGVudFgiLCJkMyIsImV4dGVudCIsInhTY2FsZSIsInNjYWxlTGluZWFyIiwiZG9tYWluIiwibmljZSIsImV4dGVudFkiLCJ5U2NhbGUiLCJzaGFkaW5nRyIsInNlbGVjdCIsImRzZXRHIiwicG9pc29uRyIsIm1vZGVsRyIsInhBeGlzIiwiYXhpc0JvdHRvbSIsInRpY2tTaXplIiwidGlja1BhZGRpbmciLCJ5QXhpcyIsImF4aXNMZWZ0IiwibGluZSIsIm1vZGVsX2MiLCJtb2RlbF90IiwiYmVsb3dBcmVhIiwiYWJvdmVBcmVhIiwiZHNldFNjYXR0ZXIiLCJzZWxlY3RBbGwiLCJlbnRlciIsInBvaXNvblNjYXR0ZXIiLCJ1cGRhdGVDbGFzc2VzIiwicGF1c2UiLCJwYXVzZWQiLCJhbmltU3RlcEZyYW1lIiwic2xpZGVySGFuZGxlciIsInNldFRpbWVvdXQiLCJ1cGRhdGVNb2RlbHMiLCJtb2RlbFNoYXBlIiwidGhldGFfYyIsImltX21vZGVscyIsInRoZXRhX3QiLCJ1cGRhdGVEYXRhIiwiaWQiLCJ0b1N0cmluZyIsInN5bWJvbCIsInN5bWJvbENyb3NzIiwic2l6ZSIsInRyYW5zaXRpb24iLCJkdXJhdGlvbiIsImV4aXQiLCJyZW1vdmUiLCJpc1VzZXIiLCJzbGljZSIsIm9uIiwiZXZlbnQiLCJwb2ludGVyIiwiaW52ZXJ0IiwiY2x1c3Rlcl9jZW50ZXJzIiwicDEiLCJwMiIsImR4IiwiZHkiLCJyZWR1Y2UiLCJwcmV2IiwiY3VyIiwiYWxwaGFTbGlkZXIiLCJiZXRhU2xpZGVyIiwic2VlZFNsaWRlciIsImFscGhhVGV4dCIsImJldGFUZXh0Iiwic2VlZFRleHQiLCJjb250cm9scyIsInByZXZpZXdQb2lzb24iLCJleHRlbnRYUGFkIiwiZXh0ZW50WVBhZCIsInByZXZpZXdQb2lzb25HIiwicHJldmlld1BvaXNvblNjYXR0ZXIiLCJ0b0ZpeGVkIiwicG9pc29uIiwiY29uc29sZSIsImZpZ3VyZSIsImdldEVsZW1lbnRCeUlkIiwiYWRkRXZlbnRMaXN0ZW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJQb2lzb25EZW1vIiwiZmV0Y2giLCJyZXNwIiwianNvbiIsImRhdGFKc29uIiwiQXR0YWNrQW5pbWF0aW9uIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BC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TWtSLEVBQ041RyxZQUFhLEVBQ2JDLElBQUtBLGNBUWYsSUFBTW1HLEdBQVM5USxTQUFTK1EsZUFBZSx1Q0FFdkNELEdBQU9FLGlCQUFpQixTQUFTLFdBQy9CRyxNQUFNLHNFQUNINU8sTUFBSyxTQUFDNk8sR0FBRCxPQUFVQSxFQUFLQyxVQUNwQjlPLE1BQUssU0FBQytPLEdBQ0wsSUFBTS9SLEVBQVN1UixHQUFPRyxjQUFjLDhCQUN0QixJQUFJTSxHQUFnQixDQUNoQ2hTLE9BQVFBLEVBQ1JrRixNQUFPLENBQ0xyRSxLQUFNa1IsRUFDTjVHLFlBQWEsRUFDYkMsSUFBS0EiLCJmaWxlIjoiaW5kZXguYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZnVuY3Rpb24gbm9vcCgpIHsgfVxuY29uc3QgaWRlbnRpdHkgPSB4ID0+IHg7XG5mdW5jdGlvbiBhc3NpZ24odGFyLCBzcmMpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZm9yIChjb25zdCBrIGluIHNyYylcbiAgICAgICAgdGFyW2tdID0gc3JjW2tdO1xuICAgIHJldHVybiB0YXI7XG59XG5mdW5jdGlvbiBpc19wcm9taXNlKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIHZhbHVlLnRoZW4gPT09ICdmdW5jdGlvbic7XG59XG5mdW5jdGlvbiBhZGRfbG9jYXRpb24oZWxlbWVudCwgZmlsZSwgbGluZSwgY29sdW1uLCBjaGFyKSB7XG4gICAgZWxlbWVudC5fX3N2ZWx0ZV9tZXRhID0ge1xuICAgICAgICBsb2M6IHsgZmlsZSwgbGluZSwgY29sdW1uLCBjaGFyIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gcnVuKGZuKSB7XG4gICAgcmV0dXJuIGZuKCk7XG59XG5mdW5jdGlvbiBibGFua19vYmplY3QoKSB7XG4gICAgcmV0dXJuIE9iamVjdC5jcmVhdGUobnVsbCk7XG59XG5mdW5jdGlvbiBydW5fYWxsKGZucykge1xuICAgIGZucy5mb3JFYWNoKHJ1bik7XG59XG5mdW5jdGlvbiBpc19mdW5jdGlvbih0aGluZykge1xuICAgIHJldHVybiB0eXBlb2YgdGhpbmcgPT09ICdmdW5jdGlvbic7XG59XG5mdW5jdGlvbiBzYWZlX25vdF9lcXVhbChhLCBiKSB7XG4gICAgcmV0dXJuIGEgIT0gYSA/IGIgPT0gYiA6IGEgIT09IGIgfHwgKChhICYmIHR5cGVvZiBhID09PSAnb2JqZWN0JykgfHwgdHlwZW9mIGEgPT09ICdmdW5jdGlvbicpO1xufVxubGV0IHNyY191cmxfZXF1YWxfYW5jaG9yO1xuZnVuY3Rpb24gc3JjX3VybF9lcXVhbChlbGVtZW50X3NyYywgdXJsKSB7XG4gICAgaWYgKCFzcmNfdXJsX2VxdWFsX2FuY2hvcikge1xuICAgICAgICBzcmNfdXJsX2VxdWFsX2FuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICB9XG4gICAgc3JjX3VybF9lcXVhbF9hbmNob3IuaHJlZiA9IHVybDtcbiAgICByZXR1cm4gZWxlbWVudF9zcmMgPT09IHNyY191cmxfZXF1YWxfYW5jaG9yLmhyZWY7XG59XG5mdW5jdGlvbiBub3RfZXF1YWwoYSwgYikge1xuICAgIHJldHVybiBhICE9IGEgPyBiID09IGIgOiBhICE9PSBiO1xufVxuZnVuY3Rpb24gaXNfZW1wdHkob2JqKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID09PSAwO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVfc3RvcmUoc3RvcmUsIG5hbWUpIHtcbiAgICBpZiAoc3RvcmUgIT0gbnVsbCAmJiB0eXBlb2Ygc3RvcmUuc3Vic2NyaWJlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7bmFtZX0nIGlzIG5vdCBhIHN0b3JlIHdpdGggYSAnc3Vic2NyaWJlJyBtZXRob2RgKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzdWJzY3JpYmUoc3RvcmUsIC4uLmNhbGxiYWNrcykge1xuICAgIGlmIChzdG9yZSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBub29wO1xuICAgIH1cbiAgICBjb25zdCB1bnN1YiA9IHN0b3JlLnN1YnNjcmliZSguLi5jYWxsYmFja3MpO1xuICAgIHJldHVybiB1bnN1Yi51bnN1YnNjcmliZSA/ICgpID0+IHVuc3ViLnVuc3Vic2NyaWJlKCkgOiB1bnN1Yjtcbn1cbmZ1bmN0aW9uIGdldF9zdG9yZV92YWx1ZShzdG9yZSkge1xuICAgIGxldCB2YWx1ZTtcbiAgICBzdWJzY3JpYmUoc3RvcmUsIF8gPT4gdmFsdWUgPSBfKSgpO1xuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIGNvbXBvbmVudF9zdWJzY3JpYmUoY29tcG9uZW50LCBzdG9yZSwgY2FsbGJhY2spIHtcbiAgICBjb21wb25lbnQuJCQub25fZGVzdHJveS5wdXNoKHN1YnNjcmliZShzdG9yZSwgY2FsbGJhY2spKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9zbG90KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pIHtcbiAgICBpZiAoZGVmaW5pdGlvbikge1xuICAgICAgICBjb25zdCBzbG90X2N0eCA9IGdldF9zbG90X2NvbnRleHQoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbik7XG4gICAgICAgIHJldHVybiBkZWZpbml0aW9uWzBdKHNsb3RfY3R4KTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRfc2xvdF9jb250ZXh0KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pIHtcbiAgICByZXR1cm4gZGVmaW5pdGlvblsxXSAmJiBmblxuICAgICAgICA/IGFzc2lnbigkJHNjb3BlLmN0eC5zbGljZSgpLCBkZWZpbml0aW9uWzFdKGZuKGN0eCkpKVxuICAgICAgICA6ICQkc2NvcGUuY3R4O1xufVxuZnVuY3Rpb24gZ2V0X3Nsb3RfY2hhbmdlcyhkZWZpbml0aW9uLCAkJHNjb3BlLCBkaXJ0eSwgZm4pIHtcbiAgICBpZiAoZGVmaW5pdGlvblsyXSAmJiBmbikge1xuICAgICAgICBjb25zdCBsZXRzID0gZGVmaW5pdGlvblsyXShmbihkaXJ0eSkpO1xuICAgICAgICBpZiAoJCRzY29wZS5kaXJ0eSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gbGV0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGxldHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBjb25zdCBtZXJnZWQgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IGxlbiA9IE1hdGgubWF4KCQkc2NvcGUuZGlydHkubGVuZ3RoLCBsZXRzLmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgbWVyZ2VkW2ldID0gJCRzY29wZS5kaXJ0eVtpXSB8IGxldHNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWVyZ2VkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkJHNjb3BlLmRpcnR5IHwgbGV0cztcbiAgICB9XG4gICAgcmV0dXJuICQkc2NvcGUuZGlydHk7XG59XG5mdW5jdGlvbiB1cGRhdGVfc2xvdF9iYXNlKHNsb3QsIHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBzbG90X2NoYW5nZXMsIGdldF9zbG90X2NvbnRleHRfZm4pIHtcbiAgICBpZiAoc2xvdF9jaGFuZ2VzKSB7XG4gICAgICAgIGNvbnN0IHNsb3RfY29udGV4dCA9IGdldF9zbG90X2NvbnRleHQoc2xvdF9kZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGdldF9zbG90X2NvbnRleHRfZm4pO1xuICAgICAgICBzbG90LnAoc2xvdF9jb250ZXh0LCBzbG90X2NoYW5nZXMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVwZGF0ZV9zbG90KHNsb3QsIHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBkaXJ0eSwgZ2V0X3Nsb3RfY2hhbmdlc19mbiwgZ2V0X3Nsb3RfY29udGV4dF9mbikge1xuICAgIGNvbnN0IHNsb3RfY2hhbmdlcyA9IGdldF9zbG90X2NoYW5nZXMoc2xvdF9kZWZpbml0aW9uLCAkJHNjb3BlLCBkaXJ0eSwgZ2V0X3Nsb3RfY2hhbmdlc19mbik7XG4gICAgdXBkYXRlX3Nsb3RfYmFzZShzbG90LCBzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgc2xvdF9jaGFuZ2VzLCBnZXRfc2xvdF9jb250ZXh0X2ZuKTtcbn1cbmZ1bmN0aW9uIGdldF9hbGxfZGlydHlfZnJvbV9zY29wZSgkJHNjb3BlKSB7XG4gICAgaWYgKCQkc2NvcGUuY3R4Lmxlbmd0aCA+IDMyKSB7XG4gICAgICAgIGNvbnN0IGRpcnR5ID0gW107XG4gICAgICAgIGNvbnN0IGxlbmd0aCA9ICQkc2NvcGUuY3R4Lmxlbmd0aCAvIDMyO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBkaXJ0eVtpXSA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkaXJ0eTtcbiAgICB9XG4gICAgcmV0dXJuIC0xO1xufVxuZnVuY3Rpb24gZXhjbHVkZV9pbnRlcm5hbF9wcm9wcyhwcm9wcykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3QgayBpbiBwcm9wcylcbiAgICAgICAgaWYgKGtbMF0gIT09ICckJylcbiAgICAgICAgICAgIHJlc3VsdFtrXSA9IHByb3BzW2tdO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBjb21wdXRlX3Jlc3RfcHJvcHMocHJvcHMsIGtleXMpIHtcbiAgICBjb25zdCByZXN0ID0ge307XG4gICAga2V5cyA9IG5ldyBTZXQoa2V5cyk7XG4gICAgZm9yIChjb25zdCBrIGluIHByb3BzKVxuICAgICAgICBpZiAoIWtleXMuaGFzKGspICYmIGtbMF0gIT09ICckJylcbiAgICAgICAgICAgIHJlc3Rba10gPSBwcm9wc1trXTtcbiAgICByZXR1cm4gcmVzdDtcbn1cbmZ1bmN0aW9uIGNvbXB1dGVfc2xvdHMoc2xvdHMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBzbG90cykge1xuICAgICAgICByZXN1bHRba2V5XSA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBvbmNlKGZuKSB7XG4gICAgbGV0IHJhbiA9IGZhbHNlO1xuICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICBpZiAocmFuKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICByYW4gPSB0cnVlO1xuICAgICAgICBmbi5jYWxsKHRoaXMsIC4uLmFyZ3MpO1xuICAgIH07XG59XG5mdW5jdGlvbiBudWxsX3RvX2VtcHR5KHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xufVxuZnVuY3Rpb24gc2V0X3N0b3JlX3ZhbHVlKHN0b3JlLCByZXQsIHZhbHVlKSB7XG4gICAgc3RvcmUuc2V0KHZhbHVlKTtcbiAgICByZXR1cm4gcmV0O1xufVxuY29uc3QgaGFzX3Byb3AgPSAob2JqLCBwcm9wKSA9PiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcbmZ1bmN0aW9uIGFjdGlvbl9kZXN0cm95ZXIoYWN0aW9uX3Jlc3VsdCkge1xuICAgIHJldHVybiBhY3Rpb25fcmVzdWx0ICYmIGlzX2Z1bmN0aW9uKGFjdGlvbl9yZXN1bHQuZGVzdHJveSkgPyBhY3Rpb25fcmVzdWx0LmRlc3Ryb3kgOiBub29wO1xufVxuXG5jb25zdCBpc19jbGllbnQgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJztcbmxldCBub3cgPSBpc19jbGllbnRcbiAgICA/ICgpID0+IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKVxuICAgIDogKCkgPT4gRGF0ZS5ub3coKTtcbmxldCByYWYgPSBpc19jbGllbnQgPyBjYiA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2IpIDogbm9vcDtcbi8vIHVzZWQgaW50ZXJuYWxseSBmb3IgdGVzdGluZ1xuZnVuY3Rpb24gc2V0X25vdyhmbikge1xuICAgIG5vdyA9IGZuO1xufVxuZnVuY3Rpb24gc2V0X3JhZihmbikge1xuICAgIHJhZiA9IGZuO1xufVxuXG5jb25zdCB0YXNrcyA9IG5ldyBTZXQoKTtcbmZ1bmN0aW9uIHJ1bl90YXNrcyhub3cpIHtcbiAgICB0YXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICBpZiAoIXRhc2suYyhub3cpKSB7XG4gICAgICAgICAgICB0YXNrcy5kZWxldGUodGFzayk7XG4gICAgICAgICAgICB0YXNrLmYoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmICh0YXNrcy5zaXplICE9PSAwKVxuICAgICAgICByYWYocnVuX3Rhc2tzKTtcbn1cbi8qKlxuICogRm9yIHRlc3RpbmcgcHVycG9zZXMgb25seSFcbiAqL1xuZnVuY3Rpb24gY2xlYXJfbG9vcHMoKSB7XG4gICAgdGFza3MuY2xlYXIoKTtcbn1cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB0YXNrIHRoYXQgcnVucyBvbiBlYWNoIHJhZiBmcmFtZVxuICogdW50aWwgaXQgcmV0dXJucyBhIGZhbHN5IHZhbHVlIG9yIGlzIGFib3J0ZWRcbiAqL1xuZnVuY3Rpb24gbG9vcChjYWxsYmFjaykge1xuICAgIGxldCB0YXNrO1xuICAgIGlmICh0YXNrcy5zaXplID09PSAwKVxuICAgICAgICByYWYocnVuX3Rhc2tzKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9taXNlOiBuZXcgUHJvbWlzZShmdWxmaWxsID0+IHtcbiAgICAgICAgICAgIHRhc2tzLmFkZCh0YXNrID0geyBjOiBjYWxsYmFjaywgZjogZnVsZmlsbCB9KTtcbiAgICAgICAgfSksXG4gICAgICAgIGFib3J0KCkge1xuICAgICAgICAgICAgdGFza3MuZGVsZXRlKHRhc2spO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuLy8gVHJhY2sgd2hpY2ggbm9kZXMgYXJlIGNsYWltZWQgZHVyaW5nIGh5ZHJhdGlvbi4gVW5jbGFpbWVkIG5vZGVzIGNhbiB0aGVuIGJlIHJlbW92ZWQgZnJvbSB0aGUgRE9NXG4vLyBhdCB0aGUgZW5kIG9mIGh5ZHJhdGlvbiB3aXRob3V0IHRvdWNoaW5nIHRoZSByZW1haW5pbmcgbm9kZXMuXG5sZXQgaXNfaHlkcmF0aW5nID0gZmFsc2U7XG5mdW5jdGlvbiBzdGFydF9oeWRyYXRpbmcoKSB7XG4gICAgaXNfaHlkcmF0aW5nID0gdHJ1ZTtcbn1cbmZ1bmN0aW9uIGVuZF9oeWRyYXRpbmcoKSB7XG4gICAgaXNfaHlkcmF0aW5nID0gZmFsc2U7XG59XG5mdW5jdGlvbiB1cHBlcl9ib3VuZChsb3csIGhpZ2gsIGtleSwgdmFsdWUpIHtcbiAgICAvLyBSZXR1cm4gZmlyc3QgaW5kZXggb2YgdmFsdWUgbGFyZ2VyIHRoYW4gaW5wdXQgdmFsdWUgaW4gdGhlIHJhbmdlIFtsb3csIGhpZ2gpXG4gICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHtcbiAgICAgICAgY29uc3QgbWlkID0gbG93ICsgKChoaWdoIC0gbG93KSA+PiAxKTtcbiAgICAgICAgaWYgKGtleShtaWQpIDw9IHZhbHVlKSB7XG4gICAgICAgICAgICBsb3cgPSBtaWQgKyAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaGlnaCA9IG1pZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbG93O1xufVxuZnVuY3Rpb24gaW5pdF9oeWRyYXRlKHRhcmdldCkge1xuICAgIGlmICh0YXJnZXQuaHlkcmF0ZV9pbml0KVxuICAgICAgICByZXR1cm47XG4gICAgdGFyZ2V0Lmh5ZHJhdGVfaW5pdCA9IHRydWU7XG4gICAgLy8gV2Uga25vdyB0aGF0IGFsbCBjaGlsZHJlbiBoYXZlIGNsYWltX29yZGVyIHZhbHVlcyBzaW5jZSB0aGUgdW5jbGFpbWVkIGhhdmUgYmVlbiBkZXRhY2hlZCBpZiB0YXJnZXQgaXMgbm90IDxoZWFkPlxuICAgIGxldCBjaGlsZHJlbiA9IHRhcmdldC5jaGlsZE5vZGVzO1xuICAgIC8vIElmIHRhcmdldCBpcyA8aGVhZD4sIHRoZXJlIG1heSBiZSBjaGlsZHJlbiB3aXRob3V0IGNsYWltX29yZGVyXG4gICAgaWYgKHRhcmdldC5ub2RlTmFtZSA9PT0gJ0hFQUQnKSB7XG4gICAgICAgIGNvbnN0IG15Q2hpbGRyZW4gPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IGNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgaWYgKG5vZGUuY2xhaW1fb3JkZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIG15Q2hpbGRyZW4ucHVzaChub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjaGlsZHJlbiA9IG15Q2hpbGRyZW47XG4gICAgfVxuICAgIC8qXG4gICAgKiBSZW9yZGVyIGNsYWltZWQgY2hpbGRyZW4gb3B0aW1hbGx5LlxuICAgICogV2UgY2FuIHJlb3JkZXIgY2xhaW1lZCBjaGlsZHJlbiBvcHRpbWFsbHkgYnkgZmluZGluZyB0aGUgbG9uZ2VzdCBzdWJzZXF1ZW5jZSBvZlxuICAgICogbm9kZXMgdGhhdCBhcmUgYWxyZWFkeSBjbGFpbWVkIGluIG9yZGVyIGFuZCBvbmx5IG1vdmluZyB0aGUgcmVzdC4gVGhlIGxvbmdlc3RcbiAgICAqIHN1YnNlcXVlbmNlIHN1YnNlcXVlbmNlIG9mIG5vZGVzIHRoYXQgYXJlIGNsYWltZWQgaW4gb3JkZXIgY2FuIGJlIGZvdW5kIGJ5XG4gICAgKiBjb21wdXRpbmcgdGhlIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZSBvZiAuY2xhaW1fb3JkZXIgdmFsdWVzLlxuICAgICpcbiAgICAqIFRoaXMgYWxnb3JpdGhtIGlzIG9wdGltYWwgaW4gZ2VuZXJhdGluZyB0aGUgbGVhc3QgYW1vdW50IG9mIHJlb3JkZXIgb3BlcmF0aW9uc1xuICAgICogcG9zc2libGUuXG4gICAgKlxuICAgICogUHJvb2Y6XG4gICAgKiBXZSBrbm93IHRoYXQsIGdpdmVuIGEgc2V0IG9mIHJlb3JkZXJpbmcgb3BlcmF0aW9ucywgdGhlIG5vZGVzIHRoYXQgZG8gbm90IG1vdmVcbiAgICAqIGFsd2F5cyBmb3JtIGFuIGluY3JlYXNpbmcgc3Vic2VxdWVuY2UsIHNpbmNlIHRoZXkgZG8gbm90IG1vdmUgYW1vbmcgZWFjaCBvdGhlclxuICAgICogbWVhbmluZyB0aGF0IHRoZXkgbXVzdCBiZSBhbHJlYWR5IG9yZGVyZWQgYW1vbmcgZWFjaCBvdGhlci4gVGh1cywgdGhlIG1heGltYWxcbiAgICAqIHNldCBvZiBub2RlcyB0aGF0IGRvIG5vdCBtb3ZlIGZvcm0gYSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2UuXG4gICAgKi9cbiAgICAvLyBDb21wdXRlIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZVxuICAgIC8vIG06IHN1YnNlcXVlbmNlIGxlbmd0aCBqID0+IGluZGV4IGsgb2Ygc21hbGxlc3QgdmFsdWUgdGhhdCBlbmRzIGFuIGluY3JlYXNpbmcgc3Vic2VxdWVuY2Ugb2YgbGVuZ3RoIGpcbiAgICBjb25zdCBtID0gbmV3IEludDMyQXJyYXkoY2hpbGRyZW4ubGVuZ3RoICsgMSk7XG4gICAgLy8gUHJlZGVjZXNzb3IgaW5kaWNlcyArIDFcbiAgICBjb25zdCBwID0gbmV3IEludDMyQXJyYXkoY2hpbGRyZW4ubGVuZ3RoKTtcbiAgICBtWzBdID0gLTE7XG4gICAgbGV0IGxvbmdlc3QgPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IGNoaWxkcmVuW2ldLmNsYWltX29yZGVyO1xuICAgICAgICAvLyBGaW5kIHRoZSBsYXJnZXN0IHN1YnNlcXVlbmNlIGxlbmd0aCBzdWNoIHRoYXQgaXQgZW5kcyBpbiBhIHZhbHVlIGxlc3MgdGhhbiBvdXIgY3VycmVudCB2YWx1ZVxuICAgICAgICAvLyB1cHBlcl9ib3VuZCByZXR1cm5zIGZpcnN0IGdyZWF0ZXIgdmFsdWUsIHNvIHdlIHN1YnRyYWN0IG9uZVxuICAgICAgICAvLyB3aXRoIGZhc3QgcGF0aCBmb3Igd2hlbiB3ZSBhcmUgb24gdGhlIGN1cnJlbnQgbG9uZ2VzdCBzdWJzZXF1ZW5jZVxuICAgICAgICBjb25zdCBzZXFMZW4gPSAoKGxvbmdlc3QgPiAwICYmIGNoaWxkcmVuW21bbG9uZ2VzdF1dLmNsYWltX29yZGVyIDw9IGN1cnJlbnQpID8gbG9uZ2VzdCArIDEgOiB1cHBlcl9ib3VuZCgxLCBsb25nZXN0LCBpZHggPT4gY2hpbGRyZW5bbVtpZHhdXS5jbGFpbV9vcmRlciwgY3VycmVudCkpIC0gMTtcbiAgICAgICAgcFtpXSA9IG1bc2VxTGVuXSArIDE7XG4gICAgICAgIGNvbnN0IG5ld0xlbiA9IHNlcUxlbiArIDE7XG4gICAgICAgIC8vIFdlIGNhbiBndWFyYW50ZWUgdGhhdCBjdXJyZW50IGlzIHRoZSBzbWFsbGVzdCB2YWx1ZS4gT3RoZXJ3aXNlLCB3ZSB3b3VsZCBoYXZlIGdlbmVyYXRlZCBhIGxvbmdlciBzZXF1ZW5jZS5cbiAgICAgICAgbVtuZXdMZW5dID0gaTtcbiAgICAgICAgbG9uZ2VzdCA9IE1hdGgubWF4KG5ld0xlbiwgbG9uZ2VzdCk7XG4gICAgfVxuICAgIC8vIFRoZSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2Ugb2Ygbm9kZXMgKGluaXRpYWxseSByZXZlcnNlZClcbiAgICBjb25zdCBsaXMgPSBbXTtcbiAgICAvLyBUaGUgcmVzdCBvZiB0aGUgbm9kZXMsIG5vZGVzIHRoYXQgd2lsbCBiZSBtb3ZlZFxuICAgIGNvbnN0IHRvTW92ZSA9IFtdO1xuICAgIGxldCBsYXN0ID0gY2hpbGRyZW4ubGVuZ3RoIC0gMTtcbiAgICBmb3IgKGxldCBjdXIgPSBtW2xvbmdlc3RdICsgMTsgY3VyICE9IDA7IGN1ciA9IHBbY3VyIC0gMV0pIHtcbiAgICAgICAgbGlzLnB1c2goY2hpbGRyZW5bY3VyIC0gMV0pO1xuICAgICAgICBmb3IgKDsgbGFzdCA+PSBjdXI7IGxhc3QtLSkge1xuICAgICAgICAgICAgdG9Nb3ZlLnB1c2goY2hpbGRyZW5bbGFzdF0pO1xuICAgICAgICB9XG4gICAgICAgIGxhc3QtLTtcbiAgICB9XG4gICAgZm9yICg7IGxhc3QgPj0gMDsgbGFzdC0tKSB7XG4gICAgICAgIHRvTW92ZS5wdXNoKGNoaWxkcmVuW2xhc3RdKTtcbiAgICB9XG4gICAgbGlzLnJldmVyc2UoKTtcbiAgICAvLyBXZSBzb3J0IHRoZSBub2RlcyBiZWluZyBtb3ZlZCB0byBndWFyYW50ZWUgdGhhdCB0aGVpciBpbnNlcnRpb24gb3JkZXIgbWF0Y2hlcyB0aGUgY2xhaW0gb3JkZXJcbiAgICB0b01vdmUuc29ydCgoYSwgYikgPT4gYS5jbGFpbV9vcmRlciAtIGIuY2xhaW1fb3JkZXIpO1xuICAgIC8vIEZpbmFsbHksIHdlIG1vdmUgdGhlIG5vZGVzXG4gICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdG9Nb3ZlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHdoaWxlIChqIDwgbGlzLmxlbmd0aCAmJiB0b01vdmVbaV0uY2xhaW1fb3JkZXIgPj0gbGlzW2pdLmNsYWltX29yZGVyKSB7XG4gICAgICAgICAgICBqKys7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYW5jaG9yID0gaiA8IGxpcy5sZW5ndGggPyBsaXNbal0gOiBudWxsO1xuICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKHRvTW92ZVtpXSwgYW5jaG9yKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhcHBlbmQodGFyZ2V0LCBub2RlKSB7XG4gICAgdGFyZ2V0LmFwcGVuZENoaWxkKG5vZGUpO1xufVxuZnVuY3Rpb24gYXBwZW5kX3N0eWxlcyh0YXJnZXQsIHN0eWxlX3NoZWV0X2lkLCBzdHlsZXMpIHtcbiAgICBjb25zdCBhcHBlbmRfc3R5bGVzX3RvID0gZ2V0X3Jvb3RfZm9yX3N0eWxlKHRhcmdldCk7XG4gICAgaWYgKCFhcHBlbmRfc3R5bGVzX3RvLmdldEVsZW1lbnRCeUlkKHN0eWxlX3NoZWV0X2lkKSkge1xuICAgICAgICBjb25zdCBzdHlsZSA9IGVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgICAgIHN0eWxlLmlkID0gc3R5bGVfc2hlZXRfaWQ7XG4gICAgICAgIHN0eWxlLnRleHRDb250ZW50ID0gc3R5bGVzO1xuICAgICAgICBhcHBlbmRfc3R5bGVzaGVldChhcHBlbmRfc3R5bGVzX3RvLCBzdHlsZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0X3Jvb3RfZm9yX3N0eWxlKG5vZGUpIHtcbiAgICBpZiAoIW5vZGUpXG4gICAgICAgIHJldHVybiBkb2N1bWVudDtcbiAgICBjb25zdCByb290ID0gbm9kZS5nZXRSb290Tm9kZSA/IG5vZGUuZ2V0Um9vdE5vZGUoKSA6IG5vZGUub3duZXJEb2N1bWVudDtcbiAgICBpZiAocm9vdCAmJiByb290Lmhvc3QpIHtcbiAgICAgICAgcmV0dXJuIHJvb3Q7XG4gICAgfVxuICAgIHJldHVybiBub2RlLm93bmVyRG9jdW1lbnQ7XG59XG5mdW5jdGlvbiBhcHBlbmRfZW1wdHlfc3R5bGVzaGVldChub2RlKSB7XG4gICAgY29uc3Qgc3R5bGVfZWxlbWVudCA9IGVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgYXBwZW5kX3N0eWxlc2hlZXQoZ2V0X3Jvb3RfZm9yX3N0eWxlKG5vZGUpLCBzdHlsZV9lbGVtZW50KTtcbiAgICByZXR1cm4gc3R5bGVfZWxlbWVudC5zaGVldDtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9zdHlsZXNoZWV0KG5vZGUsIHN0eWxlKSB7XG4gICAgYXBwZW5kKG5vZGUuaGVhZCB8fCBub2RlLCBzdHlsZSk7XG59XG5mdW5jdGlvbiBhcHBlbmRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSkge1xuICAgIGlmIChpc19oeWRyYXRpbmcpIHtcbiAgICAgICAgaW5pdF9oeWRyYXRlKHRhcmdldCk7XG4gICAgICAgIGlmICgodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgPT09IHVuZGVmaW5lZCkgfHwgKCh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCAhPT0gbnVsbCkgJiYgKHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkLnBhcmVudEVsZW1lbnQgIT09IHRhcmdldCkpKSB7XG4gICAgICAgICAgICB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCA9IHRhcmdldC5maXJzdENoaWxkO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNraXAgbm9kZXMgb2YgdW5kZWZpbmVkIG9yZGVyaW5nXG4gICAgICAgIHdoaWxlICgodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgIT09IG51bGwpICYmICh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZC5jbGFpbV9vcmRlciA9PT0gdW5kZWZpbmVkKSkge1xuICAgICAgICAgICAgdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgPSB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZC5uZXh0U2libGluZztcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZSAhPT0gdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQpIHtcbiAgICAgICAgICAgIC8vIFdlIG9ubHkgaW5zZXJ0IGlmIHRoZSBvcmRlcmluZyBvZiB0aGlzIG5vZGUgc2hvdWxkIGJlIG1vZGlmaWVkIG9yIHRoZSBwYXJlbnQgbm9kZSBpcyBub3QgdGFyZ2V0XG4gICAgICAgICAgICBpZiAobm9kZS5jbGFpbV9vcmRlciAhPT0gdW5kZWZpbmVkIHx8IG5vZGUucGFyZW50Tm9kZSAhPT0gdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Lmluc2VydEJlZm9yZShub2RlLCB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCA9IG5vZGUubmV4dFNpYmxpbmc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAobm9kZS5wYXJlbnROb2RlICE9PSB0YXJnZXQgfHwgbm9kZS5uZXh0U2libGluZyAhPT0gbnVsbCkge1xuICAgICAgICB0YXJnZXQuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gaW5zZXJ0KHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgdGFyZ2V0Lmluc2VydEJlZm9yZShub2RlLCBhbmNob3IgfHwgbnVsbCk7XG59XG5mdW5jdGlvbiBpbnNlcnRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgaWYgKGlzX2h5ZHJhdGluZyAmJiAhYW5jaG9yKSB7XG4gICAgICAgIGFwcGVuZF9oeWRyYXRpb24odGFyZ2V0LCBub2RlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobm9kZS5wYXJlbnROb2RlICE9PSB0YXJnZXQgfHwgbm9kZS5uZXh0U2libGluZyAhPSBhbmNob3IpIHtcbiAgICAgICAgdGFyZ2V0Lmluc2VydEJlZm9yZShub2RlLCBhbmNob3IgfHwgbnVsbCk7XG4gICAgfVxufVxuZnVuY3Rpb24gZGV0YWNoKG5vZGUpIHtcbiAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7XG59XG5mdW5jdGlvbiBkZXN0cm95X2VhY2goaXRlcmF0aW9ucywgZGV0YWNoaW5nKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVyYXRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChpdGVyYXRpb25zW2ldKVxuICAgICAgICAgICAgaXRlcmF0aW9uc1tpXS5kKGRldGFjaGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZWxlbWVudChuYW1lKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSk7XG59XG5mdW5jdGlvbiBlbGVtZW50X2lzKG5hbWUsIGlzKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSwgeyBpcyB9KTtcbn1cbmZ1bmN0aW9uIG9iamVjdF93aXRob3V0X3Byb3BlcnRpZXMob2JqLCBleGNsdWRlKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0ge307XG4gICAgZm9yIChjb25zdCBrIGluIG9iaikge1xuICAgICAgICBpZiAoaGFzX3Byb3Aob2JqLCBrKVxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgJiYgZXhjbHVkZS5pbmRleE9mKGspID09PSAtMSkge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGFyZ2V0W2tdID0gb2JqW2tdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59XG5mdW5jdGlvbiBzdmdfZWxlbWVudChuYW1lKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCBuYW1lKTtcbn1cbmZ1bmN0aW9uIHRleHQoZGF0YSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkYXRhKTtcbn1cbmZ1bmN0aW9uIHNwYWNlKCkge1xuICAgIHJldHVybiB0ZXh0KCcgJyk7XG59XG5mdW5jdGlvbiBlbXB0eSgpIHtcbiAgICByZXR1cm4gdGV4dCgnJyk7XG59XG5mdW5jdGlvbiBsaXN0ZW4obm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpIHtcbiAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gcHJldmVudF9kZWZhdWx0KGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gc3RvcF9wcm9wYWdhdGlvbihmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBzZWxmKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmIChldmVudC50YXJnZXQgPT09IHRoaXMpXG4gICAgICAgICAgICBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gdHJ1c3RlZChmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBpZiAoZXZlbnQuaXNUcnVzdGVkKVxuICAgICAgICAgICAgZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGF0dHIobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PSBudWxsKVxuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICAgIGVsc2UgaWYgKG5vZGUuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkgIT09IHZhbHVlKVxuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsIHZhbHVlKTtcbn1cbmZ1bmN0aW9uIHNldF9hdHRyaWJ1dGVzKG5vZGUsIGF0dHJpYnV0ZXMpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY29uc3QgZGVzY3JpcHRvcnMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhub2RlLl9fcHJvdG9fXyk7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICBpZiAoYXR0cmlidXRlc1trZXldID09IG51bGwpIHtcbiAgICAgICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSAnc3R5bGUnKSB7XG4gICAgICAgICAgICBub2RlLnN0eWxlLmNzc1RleHQgPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSAnX192YWx1ZScpIHtcbiAgICAgICAgICAgIG5vZGUudmFsdWUgPSBub2RlW2tleV0gPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGVzY3JpcHRvcnNba2V5XSAmJiBkZXNjcmlwdG9yc1trZXldLnNldCkge1xuICAgICAgICAgICAgbm9kZVtrZXldID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYXR0cihub2RlLCBrZXksIGF0dHJpYnV0ZXNba2V5XSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfc3ZnX2F0dHJpYnV0ZXMobm9kZSwgYXR0cmlidXRlcykge1xuICAgIGZvciAoY29uc3Qga2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgYXR0cihub2RlLCBrZXksIGF0dHJpYnV0ZXNba2V5XSk7XG4gICAgfVxufVxuZnVuY3Rpb24gc2V0X2N1c3RvbV9lbGVtZW50X2RhdGEobm9kZSwgcHJvcCwgdmFsdWUpIHtcbiAgICBpZiAocHJvcCBpbiBub2RlKSB7XG4gICAgICAgIG5vZGVbcHJvcF0gPSB0eXBlb2Ygbm9kZVtwcm9wXSA9PT0gJ2Jvb2xlYW4nICYmIHZhbHVlID09PSAnJyA/IHRydWUgOiB2YWx1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGF0dHIobm9kZSwgcHJvcCwgdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHhsaW5rX2F0dHIobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgIG5vZGUuc2V0QXR0cmlidXRlTlMoJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnLCBhdHRyaWJ1dGUsIHZhbHVlKTtcbn1cbmZ1bmN0aW9uIGdldF9iaW5kaW5nX2dyb3VwX3ZhbHVlKGdyb3VwLCBfX3ZhbHVlLCBjaGVja2VkKSB7XG4gICAgY29uc3QgdmFsdWUgPSBuZXcgU2V0KCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBncm91cC5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBpZiAoZ3JvdXBbaV0uY2hlY2tlZClcbiAgICAgICAgICAgIHZhbHVlLmFkZChncm91cFtpXS5fX3ZhbHVlKTtcbiAgICB9XG4gICAgaWYgKCFjaGVja2VkKSB7XG4gICAgICAgIHZhbHVlLmRlbGV0ZShfX3ZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIEFycmF5LmZyb20odmFsdWUpO1xufVxuZnVuY3Rpb24gdG9fbnVtYmVyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09PSAnJyA/IG51bGwgOiArdmFsdWU7XG59XG5mdW5jdGlvbiB0aW1lX3Jhbmdlc190b19hcnJheShyYW5nZXMpIHtcbiAgICBjb25zdCBhcnJheSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGFycmF5LnB1c2goeyBzdGFydDogcmFuZ2VzLnN0YXJ0KGkpLCBlbmQ6IHJhbmdlcy5lbmQoaSkgfSk7XG4gICAgfVxuICAgIHJldHVybiBhcnJheTtcbn1cbmZ1bmN0aW9uIGNoaWxkcmVuKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShlbGVtZW50LmNoaWxkTm9kZXMpO1xufVxuZnVuY3Rpb24gaW5pdF9jbGFpbV9pbmZvKG5vZGVzKSB7XG4gICAgaWYgKG5vZGVzLmNsYWltX2luZm8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBub2Rlcy5jbGFpbV9pbmZvID0geyBsYXN0X2luZGV4OiAwLCB0b3RhbF9jbGFpbWVkOiAwIH07XG4gICAgfVxufVxuZnVuY3Rpb24gY2xhaW1fbm9kZShub2RlcywgcHJlZGljYXRlLCBwcm9jZXNzTm9kZSwgY3JlYXRlTm9kZSwgZG9udFVwZGF0ZUxhc3RJbmRleCA9IGZhbHNlKSB7XG4gICAgLy8gVHJ5IHRvIGZpbmQgbm9kZXMgaW4gYW4gb3JkZXIgc3VjaCB0aGF0IHdlIGxlbmd0aGVuIHRoZSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2VcbiAgICBpbml0X2NsYWltX2luZm8obm9kZXMpO1xuICAgIGNvbnN0IHJlc3VsdE5vZGUgPSAoKCkgPT4ge1xuICAgICAgICAvLyBXZSBmaXJzdCB0cnkgdG8gZmluZCBhbiBlbGVtZW50IGFmdGVyIHRoZSBwcmV2aW91cyBvbmVcbiAgICAgICAgZm9yIChsZXQgaSA9IG5vZGVzLmNsYWltX2luZm8ubGFzdF9pbmRleDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gbm9kZXNbaV07XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSBwcm9jZXNzTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVwbGFjZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXSA9IHJlcGxhY2VtZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWRvbnRVcGRhdGVMYXN0SW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4ID0gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0cnkgdG8gZmluZCBvbmUgYmVmb3JlXG4gICAgICAgIC8vIFdlIGl0ZXJhdGUgaW4gcmV2ZXJzZSBzbyB0aGF0IHdlIGRvbid0IGdvIHRvbyBmYXIgYmFja1xuICAgICAgICBmb3IgKGxldCBpID0gbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4IC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUobm9kZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlbWVudCA9IHByb2Nlc3NOb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlbWVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldID0gcmVwbGFjZW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZG9udFVwZGF0ZUxhc3RJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChyZXBsYWNlbWVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFNpbmNlIHdlIHNwbGljZWQgYmVmb3JlIHRoZSBsYXN0X2luZGV4LCB3ZSBkZWNyZWFzZSBpdFxuICAgICAgICAgICAgICAgICAgICBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXgtLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgd2UgY2FuJ3QgZmluZCBhbnkgbWF0Y2hpbmcgbm9kZSwgd2UgY3JlYXRlIGEgbmV3IG9uZVxuICAgICAgICByZXR1cm4gY3JlYXRlTm9kZSgpO1xuICAgIH0pKCk7XG4gICAgcmVzdWx0Tm9kZS5jbGFpbV9vcmRlciA9IG5vZGVzLmNsYWltX2luZm8udG90YWxfY2xhaW1lZDtcbiAgICBub2Rlcy5jbGFpbV9pbmZvLnRvdGFsX2NsYWltZWQgKz0gMTtcbiAgICByZXR1cm4gcmVzdWx0Tm9kZTtcbn1cbmZ1bmN0aW9uIGNsYWltX2VsZW1lbnRfYmFzZShub2RlcywgbmFtZSwgYXR0cmlidXRlcywgY3JlYXRlX2VsZW1lbnQpIHtcbiAgICByZXR1cm4gY2xhaW1fbm9kZShub2RlcywgKG5vZGUpID0+IG5vZGUubm9kZU5hbWUgPT09IG5hbWUsIChub2RlKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlbW92ZSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG5vZGUuYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gbm9kZS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgaWYgKCFhdHRyaWJ1dGVzW2F0dHJpYnV0ZS5uYW1lXSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZS5wdXNoKGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZW1vdmUuZm9yRWFjaCh2ID0+IG5vZGUucmVtb3ZlQXR0cmlidXRlKHYpKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9LCAoKSA9PiBjcmVhdGVfZWxlbWVudChuYW1lKSk7XG59XG5mdW5jdGlvbiBjbGFpbV9lbGVtZW50KG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzKSB7XG4gICAgcmV0dXJuIGNsYWltX2VsZW1lbnRfYmFzZShub2RlcywgbmFtZSwgYXR0cmlidXRlcywgZWxlbWVudCk7XG59XG5mdW5jdGlvbiBjbGFpbV9zdmdfZWxlbWVudChub2RlcywgbmFtZSwgYXR0cmlidXRlcykge1xuICAgIHJldHVybiBjbGFpbV9lbGVtZW50X2Jhc2Uobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMsIHN2Z19lbGVtZW50KTtcbn1cbmZ1bmN0aW9uIGNsYWltX3RleHQobm9kZXMsIGRhdGEpIHtcbiAgICByZXR1cm4gY2xhaW1fbm9kZShub2RlcywgKG5vZGUpID0+IG5vZGUubm9kZVR5cGUgPT09IDMsIChub2RlKSA9PiB7XG4gICAgICAgIGNvbnN0IGRhdGFTdHIgPSAnJyArIGRhdGE7XG4gICAgICAgIGlmIChub2RlLmRhdGEuc3RhcnRzV2l0aChkYXRhU3RyKSkge1xuICAgICAgICAgICAgaWYgKG5vZGUuZGF0YS5sZW5ndGggIT09IGRhdGFTdHIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuc3BsaXRUZXh0KGRhdGFTdHIubGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5vZGUuZGF0YSA9IGRhdGFTdHI7XG4gICAgICAgIH1cbiAgICB9LCAoKSA9PiB0ZXh0KGRhdGEpLCB0cnVlIC8vIFRleHQgbm9kZXMgc2hvdWxkIG5vdCB1cGRhdGUgbGFzdCBpbmRleCBzaW5jZSBpdCBpcyBsaWtlbHkgbm90IHdvcnRoIGl0IHRvIGVsaW1pbmF0ZSBhbiBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlIG9mIGFjdHVhbCBlbGVtZW50c1xuICAgICk7XG59XG5mdW5jdGlvbiBjbGFpbV9zcGFjZShub2Rlcykge1xuICAgIHJldHVybiBjbGFpbV90ZXh0KG5vZGVzLCAnICcpO1xufVxuZnVuY3Rpb24gZmluZF9jb21tZW50KG5vZGVzLCB0ZXh0LCBzdGFydCkge1xuICAgIGZvciAobGV0IGkgPSBzdGFydDsgaSA8IG5vZGVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDggLyogY29tbWVudCBub2RlICovICYmIG5vZGUudGV4dENvbnRlbnQudHJpbSgpID09PSB0ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbm9kZXMubGVuZ3RoO1xufVxuZnVuY3Rpb24gY2xhaW1faHRtbF90YWcobm9kZXMpIHtcbiAgICAvLyBmaW5kIGh0bWwgb3BlbmluZyB0YWdcbiAgICBjb25zdCBzdGFydF9pbmRleCA9IGZpbmRfY29tbWVudChub2RlcywgJ0hUTUxfVEFHX1NUQVJUJywgMCk7XG4gICAgY29uc3QgZW5kX2luZGV4ID0gZmluZF9jb21tZW50KG5vZGVzLCAnSFRNTF9UQUdfRU5EJywgc3RhcnRfaW5kZXgpO1xuICAgIGlmIChzdGFydF9pbmRleCA9PT0gZW5kX2luZGV4KSB7XG4gICAgICAgIHJldHVybiBuZXcgSHRtbFRhZ0h5ZHJhdGlvbigpO1xuICAgIH1cbiAgICBpbml0X2NsYWltX2luZm8obm9kZXMpO1xuICAgIGNvbnN0IGh0bWxfdGFnX25vZGVzID0gbm9kZXMuc3BsaWNlKHN0YXJ0X2luZGV4LCBlbmRfaW5kZXggLSBzdGFydF9pbmRleCArIDEpO1xuICAgIGRldGFjaChodG1sX3RhZ19ub2Rlc1swXSk7XG4gICAgZGV0YWNoKGh0bWxfdGFnX25vZGVzW2h0bWxfdGFnX25vZGVzLmxlbmd0aCAtIDFdKTtcbiAgICBjb25zdCBjbGFpbWVkX25vZGVzID0gaHRtbF90YWdfbm9kZXMuc2xpY2UoMSwgaHRtbF90YWdfbm9kZXMubGVuZ3RoIC0gMSk7XG4gICAgZm9yIChjb25zdCBuIG9mIGNsYWltZWRfbm9kZXMpIHtcbiAgICAgICAgbi5jbGFpbV9vcmRlciA9IG5vZGVzLmNsYWltX2luZm8udG90YWxfY2xhaW1lZDtcbiAgICAgICAgbm9kZXMuY2xhaW1faW5mby50b3RhbF9jbGFpbWVkICs9IDE7XG4gICAgfVxuICAgIHJldHVybiBuZXcgSHRtbFRhZ0h5ZHJhdGlvbihjbGFpbWVkX25vZGVzKTtcbn1cbmZ1bmN0aW9uIHNldF9kYXRhKHRleHQsIGRhdGEpIHtcbiAgICBkYXRhID0gJycgKyBkYXRhO1xuICAgIGlmICh0ZXh0Lndob2xlVGV4dCAhPT0gZGF0YSlcbiAgICAgICAgdGV4dC5kYXRhID0gZGF0YTtcbn1cbmZ1bmN0aW9uIHNldF9pbnB1dF92YWx1ZShpbnB1dCwgdmFsdWUpIHtcbiAgICBpbnB1dC52YWx1ZSA9IHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xufVxuZnVuY3Rpb24gc2V0X2lucHV0X3R5cGUoaW5wdXQsIHR5cGUpIHtcbiAgICB0cnkge1xuICAgICAgICBpbnB1dC50eXBlID0gdHlwZTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9zdHlsZShub2RlLCBrZXksIHZhbHVlLCBpbXBvcnRhbnQpIHtcbiAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgbm9kZS5zdHlsZS5yZW1vdmVQcm9wZXJ0eShrZXkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbm9kZS5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHZhbHVlLCBpbXBvcnRhbnQgPyAnaW1wb3J0YW50JyA6ICcnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZWxlY3Rfb3B0aW9uKHNlbGVjdCwgdmFsdWUpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdC5vcHRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IHNlbGVjdC5vcHRpb25zW2ldO1xuICAgICAgICBpZiAob3B0aW9uLl9fdmFsdWUgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGVjdC5zZWxlY3RlZEluZGV4ID0gLTE7IC8vIG5vIG9wdGlvbiBzaG91bGQgYmUgc2VsZWN0ZWRcbn1cbmZ1bmN0aW9uIHNlbGVjdF9vcHRpb25zKHNlbGVjdCwgdmFsdWUpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdC5vcHRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IHNlbGVjdC5vcHRpb25zW2ldO1xuICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSB+dmFsdWUuaW5kZXhPZihvcHRpb24uX192YWx1ZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gc2VsZWN0X3ZhbHVlKHNlbGVjdCkge1xuICAgIGNvbnN0IHNlbGVjdGVkX29wdGlvbiA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yKCc6Y2hlY2tlZCcpIHx8IHNlbGVjdC5vcHRpb25zWzBdO1xuICAgIHJldHVybiBzZWxlY3RlZF9vcHRpb24gJiYgc2VsZWN0ZWRfb3B0aW9uLl9fdmFsdWU7XG59XG5mdW5jdGlvbiBzZWxlY3RfbXVsdGlwbGVfdmFsdWUoc2VsZWN0KSB7XG4gICAgcmV0dXJuIFtdLm1hcC5jYWxsKHNlbGVjdC5xdWVyeVNlbGVjdG9yQWxsKCc6Y2hlY2tlZCcpLCBvcHRpb24gPT4gb3B0aW9uLl9fdmFsdWUpO1xufVxuLy8gdW5mb3J0dW5hdGVseSB0aGlzIGNhbid0IGJlIGEgY29uc3RhbnQgYXMgdGhhdCB3b3VsZG4ndCBiZSB0cmVlLXNoYWtlYWJsZVxuLy8gc28gd2UgY2FjaGUgdGhlIHJlc3VsdCBpbnN0ZWFkXG5sZXQgY3Jvc3NvcmlnaW47XG5mdW5jdGlvbiBpc19jcm9zc29yaWdpbigpIHtcbiAgICBpZiAoY3Jvc3NvcmlnaW4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjcm9zc29yaWdpbiA9IGZhbHNlO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICB2b2lkIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjcm9zc29yaWdpbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNyb3Nzb3JpZ2luO1xufVxuZnVuY3Rpb24gYWRkX3Jlc2l6ZV9saXN0ZW5lcihub2RlLCBmbikge1xuICAgIGNvbnN0IGNvbXB1dGVkX3N0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICBpZiAoY29tcHV0ZWRfc3R5bGUucG9zaXRpb24gPT09ICdzdGF0aWMnKSB7XG4gICAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xuICAgIH1cbiAgICBjb25zdCBpZnJhbWUgPSBlbGVtZW50KCdpZnJhbWUnKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5OiBibG9jazsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDA7IGxlZnQ6IDA7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7ICcgK1xuICAgICAgICAnb3ZlcmZsb3c6IGhpZGRlbjsgYm9yZGVyOiAwOyBvcGFjaXR5OiAwOyBwb2ludGVyLWV2ZW50czogbm9uZTsgei1pbmRleDogLTE7Jyk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xuICAgIGlmcmFtZS50YWJJbmRleCA9IC0xO1xuICAgIGNvbnN0IGNyb3Nzb3JpZ2luID0gaXNfY3Jvc3NvcmlnaW4oKTtcbiAgICBsZXQgdW5zdWJzY3JpYmU7XG4gICAgaWYgKGNyb3Nzb3JpZ2luKSB7XG4gICAgICAgIGlmcmFtZS5zcmMgPSBcImRhdGE6dGV4dC9odG1sLDxzY3JpcHQ+b25yZXNpemU9ZnVuY3Rpb24oKXtwYXJlbnQucG9zdE1lc3NhZ2UoMCwnKicpfTwvc2NyaXB0PlwiO1xuICAgICAgICB1bnN1YnNjcmliZSA9IGxpc3Rlbih3aW5kb3csICdtZXNzYWdlJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuc291cmNlID09PSBpZnJhbWUuY29udGVudFdpbmRvdylcbiAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmcmFtZS5zcmMgPSAnYWJvdXQ6YmxhbmsnO1xuICAgICAgICBpZnJhbWUub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUgPSBsaXN0ZW4oaWZyYW1lLmNvbnRlbnRXaW5kb3csICdyZXNpemUnLCBmbik7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGFwcGVuZChub2RlLCBpZnJhbWUpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGlmIChjcm9zc29yaWdpbikge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh1bnN1YnNjcmliZSAmJiBpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgICAgICBkZXRhY2goaWZyYW1lKTtcbiAgICB9O1xufVxuZnVuY3Rpb24gdG9nZ2xlX2NsYXNzKGVsZW1lbnQsIG5hbWUsIHRvZ2dsZSkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0W3RvZ2dsZSA/ICdhZGQnIDogJ3JlbW92ZSddKG5hbWUpO1xufVxuZnVuY3Rpb24gY3VzdG9tX2V2ZW50KHR5cGUsIGRldGFpbCwgYnViYmxlcyA9IGZhbHNlKSB7XG4gICAgY29uc3QgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgIGUuaW5pdEN1c3RvbUV2ZW50KHR5cGUsIGJ1YmJsZXMsIGZhbHNlLCBkZXRhaWwpO1xuICAgIHJldHVybiBlO1xufVxuZnVuY3Rpb24gcXVlcnlfc2VsZWN0b3JfYWxsKHNlbGVjdG9yLCBwYXJlbnQgPSBkb2N1bWVudC5ib2R5KSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20ocGFyZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbn1cbmNsYXNzIEh0bWxUYWcge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmUgPSB0aGlzLm4gPSBudWxsO1xuICAgIH1cbiAgICBjKGh0bWwpIHtcbiAgICAgICAgdGhpcy5oKGh0bWwpO1xuICAgIH1cbiAgICBtKGh0bWwsIHRhcmdldCwgYW5jaG9yID0gbnVsbCkge1xuICAgICAgICBpZiAoIXRoaXMuZSkge1xuICAgICAgICAgICAgdGhpcy5lID0gZWxlbWVudCh0YXJnZXQubm9kZU5hbWUpO1xuICAgICAgICAgICAgdGhpcy50ID0gdGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5jKGh0bWwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaShhbmNob3IpO1xuICAgIH1cbiAgICBoKGh0bWwpIHtcbiAgICAgICAgdGhpcy5lLmlubmVySFRNTCA9IGh0bWw7XG4gICAgICAgIHRoaXMubiA9IEFycmF5LmZyb20odGhpcy5lLmNoaWxkTm9kZXMpO1xuICAgIH1cbiAgICBpKGFuY2hvcikge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubi5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgaW5zZXJ0KHRoaXMudCwgdGhpcy5uW2ldLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHAoaHRtbCkge1xuICAgICAgICB0aGlzLmQoKTtcbiAgICAgICAgdGhpcy5oKGh0bWwpO1xuICAgICAgICB0aGlzLmkodGhpcy5hKTtcbiAgICB9XG4gICAgZCgpIHtcbiAgICAgICAgdGhpcy5uLmZvckVhY2goZGV0YWNoKTtcbiAgICB9XG59XG5jbGFzcyBIdG1sVGFnSHlkcmF0aW9uIGV4dGVuZHMgSHRtbFRhZyB7XG4gICAgY29uc3RydWN0b3IoY2xhaW1lZF9ub2Rlcykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmUgPSB0aGlzLm4gPSBudWxsO1xuICAgICAgICB0aGlzLmwgPSBjbGFpbWVkX25vZGVzO1xuICAgIH1cbiAgICBjKGh0bWwpIHtcbiAgICAgICAgaWYgKHRoaXMubCkge1xuICAgICAgICAgICAgdGhpcy5uID0gdGhpcy5sO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3VwZXIuYyhodG1sKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpKGFuY2hvcikge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubi5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgaW5zZXJ0X2h5ZHJhdGlvbih0aGlzLnQsIHRoaXMubltpXSwgYW5jaG9yKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGF0dHJpYnV0ZV90b19vYmplY3QoYXR0cmlidXRlcykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3QgYXR0cmlidXRlIG9mIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgcmVzdWx0W2F0dHJpYnV0ZS5uYW1lXSA9IGF0dHJpYnV0ZS52YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGdldF9jdXN0b21fZWxlbWVudHNfc2xvdHMoZWxlbWVudCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGVsZW1lbnQuY2hpbGROb2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgIHJlc3VsdFtub2RlLnNsb3QgfHwgJ2RlZmF1bHQnXSA9IHRydWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8gd2UgbmVlZCB0byBzdG9yZSB0aGUgaW5mb3JtYXRpb24gZm9yIG11bHRpcGxlIGRvY3VtZW50cyBiZWNhdXNlIGEgU3ZlbHRlIGFwcGxpY2F0aW9uIGNvdWxkIGFsc28gY29udGFpbiBpZnJhbWVzXG4vLyBodHRwczovL2dpdGh1Yi5jb20vc3ZlbHRlanMvc3ZlbHRlL2lzc3Vlcy8zNjI0XG5jb25zdCBtYW5hZ2VkX3N0eWxlcyA9IG5ldyBNYXAoKTtcbmxldCBhY3RpdmUgPSAwO1xuLy8gaHR0cHM6Ly9naXRodWIuY29tL2Rhcmtza3lhcHAvc3RyaW5nLWhhc2gvYmxvYi9tYXN0ZXIvaW5kZXguanNcbmZ1bmN0aW9uIGhhc2goc3RyKSB7XG4gICAgbGV0IGhhc2ggPSA1MzgxO1xuICAgIGxldCBpID0gc3RyLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKVxuICAgICAgICBoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgXiBzdHIuY2hhckNvZGVBdChpKTtcbiAgICByZXR1cm4gaGFzaCA+Pj4gMDtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9zdHlsZV9pbmZvcm1hdGlvbihkb2MsIG5vZGUpIHtcbiAgICBjb25zdCBpbmZvID0geyBzdHlsZXNoZWV0OiBhcHBlbmRfZW1wdHlfc3R5bGVzaGVldChub2RlKSwgcnVsZXM6IHt9IH07XG4gICAgbWFuYWdlZF9zdHlsZXMuc2V0KGRvYywgaW5mbyk7XG4gICAgcmV0dXJuIGluZm87XG59XG5mdW5jdGlvbiBjcmVhdGVfcnVsZShub2RlLCBhLCBiLCBkdXJhdGlvbiwgZGVsYXksIGVhc2UsIGZuLCB1aWQgPSAwKSB7XG4gICAgY29uc3Qgc3RlcCA9IDE2LjY2NiAvIGR1cmF0aW9uO1xuICAgIGxldCBrZXlmcmFtZXMgPSAne1xcbic7XG4gICAgZm9yIChsZXQgcCA9IDA7IHAgPD0gMTsgcCArPSBzdGVwKSB7XG4gICAgICAgIGNvbnN0IHQgPSBhICsgKGIgLSBhKSAqIGVhc2UocCk7XG4gICAgICAgIGtleWZyYW1lcyArPSBwICogMTAwICsgYCV7JHtmbih0LCAxIC0gdCl9fVxcbmA7XG4gICAgfVxuICAgIGNvbnN0IHJ1bGUgPSBrZXlmcmFtZXMgKyBgMTAwJSB7JHtmbihiLCAxIC0gYil9fVxcbn1gO1xuICAgIGNvbnN0IG5hbWUgPSBgX19zdmVsdGVfJHtoYXNoKHJ1bGUpfV8ke3VpZH1gO1xuICAgIGNvbnN0IGRvYyA9IGdldF9yb290X2Zvcl9zdHlsZShub2RlKTtcbiAgICBjb25zdCB7IHN0eWxlc2hlZXQsIHJ1bGVzIH0gPSBtYW5hZ2VkX3N0eWxlcy5nZXQoZG9jKSB8fCBjcmVhdGVfc3R5bGVfaW5mb3JtYXRpb24oZG9jLCBub2RlKTtcbiAgICBpZiAoIXJ1bGVzW25hbWVdKSB7XG4gICAgICAgIHJ1bGVzW25hbWVdID0gdHJ1ZTtcbiAgICAgICAgc3R5bGVzaGVldC5pbnNlcnRSdWxlKGBAa2V5ZnJhbWVzICR7bmFtZX0gJHtydWxlfWAsIHN0eWxlc2hlZXQuY3NzUnVsZXMubGVuZ3RoKTtcbiAgICB9XG4gICAgY29uc3QgYW5pbWF0aW9uID0gbm9kZS5zdHlsZS5hbmltYXRpb24gfHwgJyc7XG4gICAgbm9kZS5zdHlsZS5hbmltYXRpb24gPSBgJHthbmltYXRpb24gPyBgJHthbmltYXRpb259LCBgIDogJyd9JHtuYW1lfSAke2R1cmF0aW9ufW1zIGxpbmVhciAke2RlbGF5fW1zIDEgYm90aGA7XG4gICAgYWN0aXZlICs9IDE7XG4gICAgcmV0dXJuIG5hbWU7XG59XG5mdW5jdGlvbiBkZWxldGVfcnVsZShub2RlLCBuYW1lKSB7XG4gICAgY29uc3QgcHJldmlvdXMgPSAobm9kZS5zdHlsZS5hbmltYXRpb24gfHwgJycpLnNwbGl0KCcsICcpO1xuICAgIGNvbnN0IG5leHQgPSBwcmV2aW91cy5maWx0ZXIobmFtZVxuICAgICAgICA/IGFuaW0gPT4gYW5pbS5pbmRleE9mKG5hbWUpIDwgMCAvLyByZW1vdmUgc3BlY2lmaWMgYW5pbWF0aW9uXG4gICAgICAgIDogYW5pbSA9PiBhbmltLmluZGV4T2YoJ19fc3ZlbHRlJykgPT09IC0xIC8vIHJlbW92ZSBhbGwgU3ZlbHRlIGFuaW1hdGlvbnNcbiAgICApO1xuICAgIGNvbnN0IGRlbGV0ZWQgPSBwcmV2aW91cy5sZW5ndGggLSBuZXh0Lmxlbmd0aDtcbiAgICBpZiAoZGVsZXRlZCkge1xuICAgICAgICBub2RlLnN0eWxlLmFuaW1hdGlvbiA9IG5leHQuam9pbignLCAnKTtcbiAgICAgICAgYWN0aXZlIC09IGRlbGV0ZWQ7XG4gICAgICAgIGlmICghYWN0aXZlKVxuICAgICAgICAgICAgY2xlYXJfcnVsZXMoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjbGVhcl9ydWxlcygpIHtcbiAgICByYWYoKCkgPT4ge1xuICAgICAgICBpZiAoYWN0aXZlKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBtYW5hZ2VkX3N0eWxlcy5mb3JFYWNoKGluZm8gPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBzdHlsZXNoZWV0IH0gPSBpbmZvO1xuICAgICAgICAgICAgbGV0IGkgPSBzdHlsZXNoZWV0LmNzc1J1bGVzLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pXG4gICAgICAgICAgICAgICAgc3R5bGVzaGVldC5kZWxldGVSdWxlKGkpO1xuICAgICAgICAgICAgaW5mby5ydWxlcyA9IHt9O1xuICAgICAgICB9KTtcbiAgICAgICAgbWFuYWdlZF9zdHlsZXMuY2xlYXIoKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlX2FuaW1hdGlvbihub2RlLCBmcm9tLCBmbiwgcGFyYW1zKSB7XG4gICAgaWYgKCFmcm9tKVxuICAgICAgICByZXR1cm4gbm9vcDtcbiAgICBjb25zdCB0byA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgaWYgKGZyb20ubGVmdCA9PT0gdG8ubGVmdCAmJiBmcm9tLnJpZ2h0ID09PSB0by5yaWdodCAmJiBmcm9tLnRvcCA9PT0gdG8udG9wICYmIGZyb20uYm90dG9tID09PSB0by5ib3R0b20pXG4gICAgICAgIHJldHVybiBub29wO1xuICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIFxuICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogc2hvdWxkIHRoaXMgYmUgc2VwYXJhdGVkIGZyb20gZGVzdHJ1Y3R1cmluZz8gT3Igc3RhcnQvZW5kIGFkZGVkIHRvIHB1YmxpYyBhcGkgYW5kIGRvY3VtZW50YXRpb24/XG4gICAgc3RhcnQ6IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5LCBcbiAgICAvLyBAdHMtaWdub3JlIHRvZG86XG4gICAgZW5kID0gc3RhcnRfdGltZSArIGR1cmF0aW9uLCB0aWNrID0gbm9vcCwgY3NzIH0gPSBmbihub2RlLCB7IGZyb20sIHRvIH0sIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSB0cnVlO1xuICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgbGV0IG5hbWU7XG4gICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgIG5hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAwLCAxLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRlbGF5KSB7XG4gICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgbmFtZSk7XG4gICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgbG9vcChub3cgPT4ge1xuICAgICAgICBpZiAoIXN0YXJ0ZWQgJiYgbm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydGVkICYmIG5vdyA+PSBlbmQpIHtcbiAgICAgICAgICAgIHRpY2soMSwgMCk7XG4gICAgICAgICAgICBzdG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFydW5uaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHAgPSBub3cgLSBzdGFydF90aW1lO1xuICAgICAgICAgICAgY29uc3QgdCA9IDAgKyAxICogZWFzaW5nKHAgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgICBzdGFydCgpO1xuICAgIHRpY2soMCwgMSk7XG4gICAgcmV0dXJuIHN0b3A7XG59XG5mdW5jdGlvbiBmaXhfcG9zaXRpb24obm9kZSkge1xuICAgIGNvbnN0IHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICBpZiAoc3R5bGUucG9zaXRpb24gIT09ICdhYnNvbHV0ZScgJiYgc3R5bGUucG9zaXRpb24gIT09ICdmaXhlZCcpIHtcbiAgICAgICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSBzdHlsZTtcbiAgICAgICAgY29uc3QgYSA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICBub2RlLnN0eWxlLndpZHRoID0gd2lkdGg7XG4gICAgICAgIG5vZGUuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICBhZGRfdHJhbnNmb3JtKG5vZGUsIGEpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFkZF90cmFuc2Zvcm0obm9kZSwgYSkge1xuICAgIGNvbnN0IGIgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGlmIChhLmxlZnQgIT09IGIubGVmdCB8fCBhLnRvcCAhPT0gYi50b3ApIHtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgICAgICBjb25zdCB0cmFuc2Zvcm0gPSBzdHlsZS50cmFuc2Zvcm0gPT09ICdub25lJyA/ICcnIDogc3R5bGUudHJhbnNmb3JtO1xuICAgICAgICBub2RlLnN0eWxlLnRyYW5zZm9ybSA9IGAke3RyYW5zZm9ybX0gdHJhbnNsYXRlKCR7YS5sZWZ0IC0gYi5sZWZ0fXB4LCAke2EudG9wIC0gYi50b3B9cHgpYDtcbiAgICB9XG59XG5cbmxldCBjdXJyZW50X2NvbXBvbmVudDtcbmZ1bmN0aW9uIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpIHtcbiAgICBjdXJyZW50X2NvbXBvbmVudCA9IGNvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGdldF9jdXJyZW50X2NvbXBvbmVudCgpIHtcbiAgICBpZiAoIWN1cnJlbnRfY29tcG9uZW50KVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Z1bmN0aW9uIGNhbGxlZCBvdXRzaWRlIGNvbXBvbmVudCBpbml0aWFsaXphdGlvbicpO1xuICAgIHJldHVybiBjdXJyZW50X2NvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGJlZm9yZVVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmJlZm9yZV91cGRhdGUucHVzaChmbik7XG59XG5mdW5jdGlvbiBvbk1vdW50KGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQub25fbW91bnQucHVzaChmbik7XG59XG5mdW5jdGlvbiBhZnRlclVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmFmdGVyX3VwZGF0ZS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIG9uRGVzdHJveShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLm9uX2Rlc3Ryb3kucHVzaChmbik7XG59XG5mdW5jdGlvbiBjcmVhdGVFdmVudERpc3BhdGNoZXIoKSB7XG4gICAgY29uc3QgY29tcG9uZW50ID0gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCk7XG4gICAgcmV0dXJuICh0eXBlLCBkZXRhaWwpID0+IHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gY29tcG9uZW50LiQkLmNhbGxiYWNrc1t0eXBlXTtcbiAgICAgICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICAgICAgLy8gVE9ETyBhcmUgdGhlcmUgc2l0dWF0aW9ucyB3aGVyZSBldmVudHMgY291bGQgYmUgZGlzcGF0Y2hlZFxuICAgICAgICAgICAgLy8gaW4gYSBzZXJ2ZXIgKG5vbi1ET00pIGVudmlyb25tZW50P1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBjdXN0b21fZXZlbnQodHlwZSwgZGV0YWlsKTtcbiAgICAgICAgICAgIGNhbGxiYWNrcy5zbGljZSgpLmZvckVhY2goZm4gPT4ge1xuICAgICAgICAgICAgICAgIGZuLmNhbGwoY29tcG9uZW50LCBldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBzZXRDb250ZXh0KGtleSwgY29udGV4dCkge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQuc2V0KGtleSwgY29udGV4dCk7XG59XG5mdW5jdGlvbiBnZXRDb250ZXh0KGtleSkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LmdldChrZXkpO1xufVxuZnVuY3Rpb24gZ2V0QWxsQ29udGV4dHMoKSB7XG4gICAgcmV0dXJuIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQ7XG59XG5mdW5jdGlvbiBoYXNDb250ZXh0KGtleSkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LmhhcyhrZXkpO1xufVxuLy8gVE9ETyBmaWd1cmUgb3V0IGlmIHdlIHN0aWxsIHdhbnQgdG8gc3VwcG9ydFxuLy8gc2hvcnRoYW5kIGV2ZW50cywgb3IgaWYgd2Ugd2FudCB0byBpbXBsZW1lbnRcbi8vIGEgcmVhbCBidWJibGluZyBtZWNoYW5pc21cbmZ1bmN0aW9uIGJ1YmJsZShjb21wb25lbnQsIGV2ZW50KSB7XG4gICAgY29uc3QgY2FsbGJhY2tzID0gY29tcG9uZW50LiQkLmNhbGxiYWNrc1tldmVudC50eXBlXTtcbiAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY2FsbGJhY2tzLnNsaWNlKCkuZm9yRWFjaChmbiA9PiBmbi5jYWxsKHRoaXMsIGV2ZW50KSk7XG4gICAgfVxufVxuXG5jb25zdCBkaXJ0eV9jb21wb25lbnRzID0gW107XG5jb25zdCBpbnRyb3MgPSB7IGVuYWJsZWQ6IGZhbHNlIH07XG5jb25zdCBiaW5kaW5nX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgcmVuZGVyX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgZmx1c2hfY2FsbGJhY2tzID0gW107XG5jb25zdCByZXNvbHZlZF9wcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG5sZXQgdXBkYXRlX3NjaGVkdWxlZCA9IGZhbHNlO1xuZnVuY3Rpb24gc2NoZWR1bGVfdXBkYXRlKCkge1xuICAgIGlmICghdXBkYXRlX3NjaGVkdWxlZCkge1xuICAgICAgICB1cGRhdGVfc2NoZWR1bGVkID0gdHJ1ZTtcbiAgICAgICAgcmVzb2x2ZWRfcHJvbWlzZS50aGVuKGZsdXNoKTtcbiAgICB9XG59XG5mdW5jdGlvbiB0aWNrKCkge1xuICAgIHNjaGVkdWxlX3VwZGF0ZSgpO1xuICAgIHJldHVybiByZXNvbHZlZF9wcm9taXNlO1xufVxuZnVuY3Rpb24gYWRkX3JlbmRlcl9jYWxsYmFjayhmbikge1xuICAgIHJlbmRlcl9jYWxsYmFja3MucHVzaChmbik7XG59XG5mdW5jdGlvbiBhZGRfZmx1c2hfY2FsbGJhY2soZm4pIHtcbiAgICBmbHVzaF9jYWxsYmFja3MucHVzaChmbik7XG59XG4vLyBmbHVzaCgpIGNhbGxzIGNhbGxiYWNrcyBpbiB0aGlzIG9yZGVyOlxuLy8gMS4gQWxsIGJlZm9yZVVwZGF0ZSBjYWxsYmFja3MsIGluIG9yZGVyOiBwYXJlbnRzIGJlZm9yZSBjaGlsZHJlblxuLy8gMi4gQWxsIGJpbmQ6dGhpcyBjYWxsYmFja3MsIGluIHJldmVyc2Ugb3JkZXI6IGNoaWxkcmVuIGJlZm9yZSBwYXJlbnRzLlxuLy8gMy4gQWxsIGFmdGVyVXBkYXRlIGNhbGxiYWNrcywgaW4gb3JkZXI6IHBhcmVudHMgYmVmb3JlIGNoaWxkcmVuLiBFWENFUFRcbi8vICAgIGZvciBhZnRlclVwZGF0ZXMgY2FsbGVkIGR1cmluZyB0aGUgaW5pdGlhbCBvbk1vdW50LCB3aGljaCBhcmUgY2FsbGVkIGluXG4vLyAgICByZXZlcnNlIG9yZGVyOiBjaGlsZHJlbiBiZWZvcmUgcGFyZW50cy5cbi8vIFNpbmNlIGNhbGxiYWNrcyBtaWdodCB1cGRhdGUgY29tcG9uZW50IHZhbHVlcywgd2hpY2ggY291bGQgdHJpZ2dlciBhbm90aGVyXG4vLyBjYWxsIHRvIGZsdXNoKCksIHRoZSBmb2xsb3dpbmcgc3RlcHMgZ3VhcmQgYWdhaW5zdCB0aGlzOlxuLy8gMS4gRHVyaW5nIGJlZm9yZVVwZGF0ZSwgYW55IHVwZGF0ZWQgY29tcG9uZW50cyB3aWxsIGJlIGFkZGVkIHRvIHRoZVxuLy8gICAgZGlydHlfY29tcG9uZW50cyBhcnJheSBhbmQgd2lsbCBjYXVzZSBhIHJlZW50cmFudCBjYWxsIHRvIGZsdXNoKCkuIEJlY2F1c2Vcbi8vICAgIHRoZSBmbHVzaCBpbmRleCBpcyBrZXB0IG91dHNpZGUgdGhlIGZ1bmN0aW9uLCB0aGUgcmVlbnRyYW50IGNhbGwgd2lsbCBwaWNrXG4vLyAgICB1cCB3aGVyZSB0aGUgZWFybGllciBjYWxsIGxlZnQgb2ZmIGFuZCBnbyB0aHJvdWdoIGFsbCBkaXJ0eSBjb21wb25lbnRzLiBUaGVcbi8vICAgIGN1cnJlbnRfY29tcG9uZW50IHZhbHVlIGlzIHNhdmVkIGFuZCByZXN0b3JlZCBzbyB0aGF0IHRoZSByZWVudHJhbnQgY2FsbCB3aWxsXG4vLyAgICBub3QgaW50ZXJmZXJlIHdpdGggdGhlIFwicGFyZW50XCIgZmx1c2goKSBjYWxsLlxuLy8gMi4gYmluZDp0aGlzIGNhbGxiYWNrcyBjYW5ub3QgdHJpZ2dlciBuZXcgZmx1c2goKSBjYWxscy5cbi8vIDMuIER1cmluZyBhZnRlclVwZGF0ZSwgYW55IHVwZGF0ZWQgY29tcG9uZW50cyB3aWxsIE5PVCBoYXZlIHRoZWlyIGFmdGVyVXBkYXRlXG4vLyAgICBjYWxsYmFjayBjYWxsZWQgYSBzZWNvbmQgdGltZTsgdGhlIHNlZW5fY2FsbGJhY2tzIHNldCwgb3V0c2lkZSB0aGUgZmx1c2goKVxuLy8gICAgZnVuY3Rpb24sIGd1YXJhbnRlZXMgdGhpcyBiZWhhdmlvci5cbmNvbnN0IHNlZW5fY2FsbGJhY2tzID0gbmV3IFNldCgpO1xubGV0IGZsdXNoaWR4ID0gMDsgLy8gRG8gKm5vdCogbW92ZSB0aGlzIGluc2lkZSB0aGUgZmx1c2goKSBmdW5jdGlvblxuZnVuY3Rpb24gZmx1c2goKSB7XG4gICAgY29uc3Qgc2F2ZWRfY29tcG9uZW50ID0gY3VycmVudF9jb21wb25lbnQ7XG4gICAgZG8ge1xuICAgICAgICAvLyBmaXJzdCwgY2FsbCBiZWZvcmVVcGRhdGUgZnVuY3Rpb25zXG4gICAgICAgIC8vIGFuZCB1cGRhdGUgY29tcG9uZW50c1xuICAgICAgICB3aGlsZSAoZmx1c2hpZHggPCBkaXJ0eV9jb21wb25lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gZGlydHlfY29tcG9uZW50c1tmbHVzaGlkeF07XG4gICAgICAgICAgICBmbHVzaGlkeCsrO1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgICAgICAgICB1cGRhdGUoY29tcG9uZW50LiQkKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgIGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoID0gMDtcbiAgICAgICAgZmx1c2hpZHggPSAwO1xuICAgICAgICB3aGlsZSAoYmluZGluZ19jYWxsYmFja3MubGVuZ3RoKVxuICAgICAgICAgICAgYmluZGluZ19jYWxsYmFja3MucG9wKCkoKTtcbiAgICAgICAgLy8gdGhlbiwgb25jZSBjb21wb25lbnRzIGFyZSB1cGRhdGVkLCBjYWxsXG4gICAgICAgIC8vIGFmdGVyVXBkYXRlIGZ1bmN0aW9ucy4gVGhpcyBtYXkgY2F1c2VcbiAgICAgICAgLy8gc3Vic2VxdWVudCB1cGRhdGVzLi4uXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVuZGVyX2NhbGxiYWNrcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSByZW5kZXJfY2FsbGJhY2tzW2ldO1xuICAgICAgICAgICAgaWYgKCFzZWVuX2NhbGxiYWNrcy5oYXMoY2FsbGJhY2spKSB7XG4gICAgICAgICAgICAgICAgLy8gLi4uc28gZ3VhcmQgYWdhaW5zdCBpbmZpbml0ZSBsb29wc1xuICAgICAgICAgICAgICAgIHNlZW5fY2FsbGJhY2tzLmFkZChjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZW5kZXJfY2FsbGJhY2tzLmxlbmd0aCA9IDA7XG4gICAgfSB3aGlsZSAoZGlydHlfY29tcG9uZW50cy5sZW5ndGgpO1xuICAgIHdoaWxlIChmbHVzaF9jYWxsYmFja3MubGVuZ3RoKSB7XG4gICAgICAgIGZsdXNoX2NhbGxiYWNrcy5wb3AoKSgpO1xuICAgIH1cbiAgICB1cGRhdGVfc2NoZWR1bGVkID0gZmFsc2U7XG4gICAgc2Vlbl9jYWxsYmFja3MuY2xlYXIoKTtcbiAgICBzZXRfY3VycmVudF9jb21wb25lbnQoc2F2ZWRfY29tcG9uZW50KTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZSgkJCkge1xuICAgIGlmICgkJC5mcmFnbWVudCAhPT0gbnVsbCkge1xuICAgICAgICAkJC51cGRhdGUoKTtcbiAgICAgICAgcnVuX2FsbCgkJC5iZWZvcmVfdXBkYXRlKTtcbiAgICAgICAgY29uc3QgZGlydHkgPSAkJC5kaXJ0eTtcbiAgICAgICAgJCQuZGlydHkgPSBbLTFdO1xuICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5wKCQkLmN0eCwgZGlydHkpO1xuICAgICAgICAkJC5hZnRlcl91cGRhdGUuZm9yRWFjaChhZGRfcmVuZGVyX2NhbGxiYWNrKTtcbiAgICB9XG59XG5cbmxldCBwcm9taXNlO1xuZnVuY3Rpb24gd2FpdCgpIHtcbiAgICBpZiAoIXByb21pc2UpIHtcbiAgICAgICAgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICBwcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcHJvbWlzZSA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoKG5vZGUsIGRpcmVjdGlvbiwga2luZCkge1xuICAgIG5vZGUuZGlzcGF0Y2hFdmVudChjdXN0b21fZXZlbnQoYCR7ZGlyZWN0aW9uID8gJ2ludHJvJyA6ICdvdXRybyd9JHtraW5kfWApKTtcbn1cbmNvbnN0IG91dHJvaW5nID0gbmV3IFNldCgpO1xubGV0IG91dHJvcztcbmZ1bmN0aW9uIGdyb3VwX291dHJvcygpIHtcbiAgICBvdXRyb3MgPSB7XG4gICAgICAgIHI6IDAsXG4gICAgICAgIGM6IFtdLFxuICAgICAgICBwOiBvdXRyb3MgLy8gcGFyZW50IGdyb3VwXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNoZWNrX291dHJvcygpIHtcbiAgICBpZiAoIW91dHJvcy5yKSB7XG4gICAgICAgIHJ1bl9hbGwob3V0cm9zLmMpO1xuICAgIH1cbiAgICBvdXRyb3MgPSBvdXRyb3MucDtcbn1cbmZ1bmN0aW9uIHRyYW5zaXRpb25faW4oYmxvY2ssIGxvY2FsKSB7XG4gICAgaWYgKGJsb2NrICYmIGJsb2NrLmkpIHtcbiAgICAgICAgb3V0cm9pbmcuZGVsZXRlKGJsb2NrKTtcbiAgICAgICAgYmxvY2suaShsb2NhbCk7XG4gICAgfVxufVxuZnVuY3Rpb24gdHJhbnNpdGlvbl9vdXQoYmxvY2ssIGxvY2FsLCBkZXRhY2gsIGNhbGxiYWNrKSB7XG4gICAgaWYgKGJsb2NrICYmIGJsb2NrLm8pIHtcbiAgICAgICAgaWYgKG91dHJvaW5nLmhhcyhibG9jaykpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIG91dHJvaW5nLmFkZChibG9jayk7XG4gICAgICAgIG91dHJvcy5jLnB1c2goKCkgPT4ge1xuICAgICAgICAgICAgb3V0cm9pbmcuZGVsZXRlKGJsb2NrKTtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGlmIChkZXRhY2gpXG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLmQoMSk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGJsb2NrLm8obG9jYWwpO1xuICAgIH1cbn1cbmNvbnN0IG51bGxfdHJhbnNpdGlvbiA9IHsgZHVyYXRpb246IDAgfTtcbmZ1bmN0aW9uIGNyZWF0ZV9pbl90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMpIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IGZhbHNlO1xuICAgIGxldCBhbmltYXRpb25fbmFtZTtcbiAgICBsZXQgdGFzaztcbiAgICBsZXQgdWlkID0gMDtcbiAgICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdvKCkge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAwLCAxLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzLCB1aWQrKyk7XG4gICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgIGNvbnN0IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5O1xuICAgICAgICBjb25zdCBlbmRfdGltZSA9IHN0YXJ0X3RpbWUgKyBkdXJhdGlvbjtcbiAgICAgICAgaWYgKHRhc2spXG4gICAgICAgICAgICB0YXNrLmFib3J0KCk7XG4gICAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IGRpc3BhdGNoKG5vZGUsIHRydWUsICdzdGFydCcpKTtcbiAgICAgICAgdGFzayA9IGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBlbmRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDEsIDApO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCB0cnVlLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBzdGFydF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlYXNpbmcoKG5vdyAtIHN0YXJ0X3RpbWUpIC8gZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcnVubmluZztcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3RhcnQoKSB7XG4gICAgICAgICAgICBpZiAoc3RhcnRlZClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUpO1xuICAgICAgICAgICAgaWYgKGlzX2Z1bmN0aW9uKGNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgICAgICB3YWl0KCkudGhlbihnbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBnbygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpbnZhbGlkYXRlKCkge1xuICAgICAgICAgICAgc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBlbmQoKSB7XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlX291dF90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMpIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IHRydWU7XG4gICAgbGV0IGFuaW1hdGlvbl9uYW1lO1xuICAgIGNvbnN0IGdyb3VwID0gb3V0cm9zO1xuICAgIGdyb3VwLnIgKz0gMTtcbiAgICBmdW5jdGlvbiBnbygpIHtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgdGljayA9IG5vb3AsIGNzcyB9ID0gY29uZmlnIHx8IG51bGxfdHJhbnNpdGlvbjtcbiAgICAgICAgaWYgKGNzcylcbiAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgMSwgMCwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcyk7XG4gICAgICAgIGNvbnN0IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5O1xuICAgICAgICBjb25zdCBlbmRfdGltZSA9IHN0YXJ0X3RpbWUgKyBkdXJhdGlvbjtcbiAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiBkaXNwYXRjaChub2RlLCBmYWxzZSwgJ3N0YXJ0JykpO1xuICAgICAgICBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gZW5kX3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGljaygwLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgZmFsc2UsICdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEtLWdyb3VwLnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgd2lsbCByZXN1bHQgaW4gYGVuZCgpYCBiZWluZyBjYWxsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzbyB3ZSBkb24ndCBuZWVkIHRvIGNsZWFuIHVwIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bl9hbGwoZ3JvdXAuYyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGVhc2luZygobm93IC0gc3RhcnRfdGltZSkgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHRpY2soMSAtIHQsIHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBydW5uaW5nO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGlzX2Z1bmN0aW9uKGNvbmZpZykpIHtcbiAgICAgICAgd2FpdCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgY29uZmlnID0gY29uZmlnKCk7XG4gICAgICAgICAgICBnbygpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGdvKCk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGVuZChyZXNldCkge1xuICAgICAgICAgICAgaWYgKHJlc2V0ICYmIGNvbmZpZy50aWNrKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLnRpY2soMSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25fbmFtZSlcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgYW5pbWF0aW9uX25hbWUpO1xuICAgICAgICAgICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBjcmVhdGVfYmlkaXJlY3Rpb25hbF90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMsIGludHJvKSB7XG4gICAgbGV0IGNvbmZpZyA9IGZuKG5vZGUsIHBhcmFtcyk7XG4gICAgbGV0IHQgPSBpbnRybyA/IDAgOiAxO1xuICAgIGxldCBydW5uaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgIGxldCBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgIGxldCBhbmltYXRpb25fbmFtZSA9IG51bGw7XG4gICAgZnVuY3Rpb24gY2xlYXJfYW5pbWF0aW9uKCkge1xuICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGluaXQocHJvZ3JhbSwgZHVyYXRpb24pIHtcbiAgICAgICAgY29uc3QgZCA9IChwcm9ncmFtLmIgLSB0KTtcbiAgICAgICAgZHVyYXRpb24gKj0gTWF0aC5hYnMoZCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhOiB0LFxuICAgICAgICAgICAgYjogcHJvZ3JhbS5iLFxuICAgICAgICAgICAgZCxcbiAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgc3RhcnQ6IHByb2dyYW0uc3RhcnQsXG4gICAgICAgICAgICBlbmQ6IHByb2dyYW0uc3RhcnQgKyBkdXJhdGlvbixcbiAgICAgICAgICAgIGdyb3VwOiBwcm9ncmFtLmdyb3VwXG4gICAgICAgIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdvKGIpIHtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgdGljayA9IG5vb3AsIGNzcyB9ID0gY29uZmlnIHx8IG51bGxfdHJhbnNpdGlvbjtcbiAgICAgICAgY29uc3QgcHJvZ3JhbSA9IHtcbiAgICAgICAgICAgIHN0YXJ0OiBub3coKSArIGRlbGF5LFxuICAgICAgICAgICAgYlxuICAgICAgICB9O1xuICAgICAgICBpZiAoIWIpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICBwcm9ncmFtLmdyb3VwID0gb3V0cm9zO1xuICAgICAgICAgICAgb3V0cm9zLnIgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocnVubmluZ19wcm9ncmFtIHx8IHBlbmRpbmdfcHJvZ3JhbSkge1xuICAgICAgICAgICAgcGVuZGluZ19wcm9ncmFtID0gcHJvZ3JhbTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgYW4gaW50cm8sIGFuZCB0aGVyZSdzIGEgZGVsYXksIHdlIG5lZWQgdG8gZG9cbiAgICAgICAgICAgIC8vIGFuIGluaXRpYWwgdGljayBhbmQvb3IgYXBwbHkgQ1NTIGFuaW1hdGlvbiBpbW1lZGlhdGVseVxuICAgICAgICAgICAgaWYgKGNzcykge1xuICAgICAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgdCwgYiwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYilcbiAgICAgICAgICAgICAgICB0aWNrKDAsIDEpO1xuICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gaW5pdChwcm9ncmFtLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IGRpc3BhdGNoKG5vZGUsIGIsICdzdGFydCcpKTtcbiAgICAgICAgICAgIGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocGVuZGluZ19wcm9ncmFtICYmIG5vdyA+IHBlbmRpbmdfcHJvZ3JhbS5zdGFydCkge1xuICAgICAgICAgICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBpbml0KHBlbmRpbmdfcHJvZ3JhbSwgZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCBydW5uaW5nX3Byb2dyYW0uYiwgJ3N0YXJ0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCB0LCBydW5uaW5nX3Byb2dyYW0uYiwgcnVubmluZ19wcm9ncmFtLmR1cmF0aW9uLCAwLCBlYXNpbmcsIGNvbmZpZy5jc3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChydW5uaW5nX3Byb2dyYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBydW5uaW5nX3Byb2dyYW0uZW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aWNrKHQgPSBydW5uaW5nX3Byb2dyYW0uYiwgMSAtIHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgcnVubmluZ19wcm9ncmFtLmIsICdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGVuZGluZ19wcm9ncmFtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UncmUgZG9uZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChydW5uaW5nX3Byb2dyYW0uYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbnRybyDigJQgd2UgY2FuIHRpZHkgdXAgaW1tZWRpYXRlbHlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBvdXRybyDigJQgbmVlZHMgdG8gYmUgY29vcmRpbmF0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEtLXJ1bm5pbmdfcHJvZ3JhbS5ncm91cC5yKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVuX2FsbChydW5uaW5nX3Byb2dyYW0uZ3JvdXAuYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChub3cgPj0gcnVubmluZ19wcm9ncmFtLnN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwID0gbm93IC0gcnVubmluZ19wcm9ncmFtLnN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdCA9IHJ1bm5pbmdfcHJvZ3JhbS5hICsgcnVubmluZ19wcm9ncmFtLmQgKiBlYXNpbmcocCAvIHJ1bm5pbmdfcHJvZ3JhbS5kdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gISEocnVubmluZ19wcm9ncmFtIHx8IHBlbmRpbmdfcHJvZ3JhbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBydW4oYikge1xuICAgICAgICAgICAgaWYgKGlzX2Z1bmN0aW9uKGNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICB3YWl0KCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnID0gY29uZmlnKCk7XG4gICAgICAgICAgICAgICAgICAgIGdvKGIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZ28oYik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVuZCgpIHtcbiAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gcGVuZGluZ19wcm9ncmFtID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGhhbmRsZV9wcm9taXNlKHByb21pc2UsIGluZm8pIHtcbiAgICBjb25zdCB0b2tlbiA9IGluZm8udG9rZW4gPSB7fTtcbiAgICBmdW5jdGlvbiB1cGRhdGUodHlwZSwgaW5kZXgsIGtleSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKGluZm8udG9rZW4gIT09IHRva2VuKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpbmZvLnJlc29sdmVkID0gdmFsdWU7XG4gICAgICAgIGxldCBjaGlsZF9jdHggPSBpbmZvLmN0eDtcbiAgICAgICAgaWYgKGtleSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjaGlsZF9jdHggPSBjaGlsZF9jdHguc2xpY2UoKTtcbiAgICAgICAgICAgIGNoaWxkX2N0eFtrZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYmxvY2sgPSB0eXBlICYmIChpbmZvLmN1cnJlbnQgPSB0eXBlKShjaGlsZF9jdHgpO1xuICAgICAgICBsZXQgbmVlZHNfZmx1c2ggPSBmYWxzZTtcbiAgICAgICAgaWYgKGluZm8uYmxvY2spIHtcbiAgICAgICAgICAgIGlmIChpbmZvLmJsb2Nrcykge1xuICAgICAgICAgICAgICAgIGluZm8uYmxvY2tzLmZvckVhY2goKGJsb2NrLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpICE9PSBpbmRleCAmJiBibG9jaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBfb3V0cm9zKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uX291dChibG9jaywgMSwgMSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmJsb2Nrc1tpXSA9PT0gYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mby5ibG9ja3NbaV0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tfb3V0cm9zKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZm8uYmxvY2suZCgxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJsb2NrLmMoKTtcbiAgICAgICAgICAgIHRyYW5zaXRpb25faW4oYmxvY2ssIDEpO1xuICAgICAgICAgICAgYmxvY2subShpbmZvLm1vdW50KCksIGluZm8uYW5jaG9yKTtcbiAgICAgICAgICAgIG5lZWRzX2ZsdXNoID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpbmZvLmJsb2NrID0gYmxvY2s7XG4gICAgICAgIGlmIChpbmZvLmJsb2NrcylcbiAgICAgICAgICAgIGluZm8uYmxvY2tzW2luZGV4XSA9IGJsb2NrO1xuICAgICAgICBpZiAobmVlZHNfZmx1c2gpIHtcbiAgICAgICAgICAgIGZsdXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGlzX3Byb21pc2UocHJvbWlzZSkpIHtcbiAgICAgICAgY29uc3QgY3VycmVudF9jb21wb25lbnQgPSBnZXRfY3VycmVudF9jb21wb25lbnQoKTtcbiAgICAgICAgcHJvbWlzZS50aGVuKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjdXJyZW50X2NvbXBvbmVudCk7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby50aGVuLCAxLCBpbmZvLnZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgIH0sIGVycm9yID0+IHtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjdXJyZW50X2NvbXBvbmVudCk7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby5jYXRjaCwgMiwgaW5mby5lcnJvciwgZXJyb3IpO1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KG51bGwpO1xuICAgICAgICAgICAgaWYgKCFpbmZvLmhhc0NhdGNoKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBpZiB3ZSBwcmV2aW91c2x5IGhhZCBhIHRoZW4vY2F0Y2ggYmxvY2ssIGRlc3Ryb3kgaXRcbiAgICAgICAgaWYgKGluZm8uY3VycmVudCAhPT0gaW5mby5wZW5kaW5nKSB7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby5wZW5kaW5nLCAwKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoaW5mby5jdXJyZW50ICE9PSBpbmZvLnRoZW4pIHtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnRoZW4sIDEsIGluZm8udmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaW5mby5yZXNvbHZlZCA9IHByb21pc2U7XG4gICAgfVxufVxuZnVuY3Rpb24gdXBkYXRlX2F3YWl0X2Jsb2NrX2JyYW5jaChpbmZvLCBjdHgsIGRpcnR5KSB7XG4gICAgY29uc3QgY2hpbGRfY3R4ID0gY3R4LnNsaWNlKCk7XG4gICAgY29uc3QgeyByZXNvbHZlZCB9ID0gaW5mbztcbiAgICBpZiAoaW5mby5jdXJyZW50ID09PSBpbmZvLnRoZW4pIHtcbiAgICAgICAgY2hpbGRfY3R4W2luZm8udmFsdWVdID0gcmVzb2x2ZWQ7XG4gICAgfVxuICAgIGlmIChpbmZvLmN1cnJlbnQgPT09IGluZm8uY2F0Y2gpIHtcbiAgICAgICAgY2hpbGRfY3R4W2luZm8uZXJyb3JdID0gcmVzb2x2ZWQ7XG4gICAgfVxuICAgIGluZm8uYmxvY2sucChjaGlsZF9jdHgsIGRpcnR5KTtcbn1cblxuY29uc3QgZ2xvYmFscyA9ICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuICAgID8gd2luZG93XG4gICAgOiB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgPyBnbG9iYWxUaGlzXG4gICAgICAgIDogZ2xvYmFsKTtcblxuZnVuY3Rpb24gZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgYmxvY2suZCgxKTtcbiAgICBsb29rdXAuZGVsZXRlKGJsb2NrLmtleSk7XG59XG5mdW5jdGlvbiBvdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgdHJhbnNpdGlvbl9vdXQoYmxvY2ssIDEsIDEsICgpID0+IHtcbiAgICAgICAgbG9va3VwLmRlbGV0ZShibG9jay5rZXkpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZml4X2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICBibG9jay5mKCk7XG4gICAgZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKTtcbn1cbmZ1bmN0aW9uIGZpeF9hbmRfb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIGJsb2NrLmYoKTtcbiAgICBvdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZV9rZXllZF9lYWNoKG9sZF9ibG9ja3MsIGRpcnR5LCBnZXRfa2V5LCBkeW5hbWljLCBjdHgsIGxpc3QsIGxvb2t1cCwgbm9kZSwgZGVzdHJveSwgY3JlYXRlX2VhY2hfYmxvY2ssIG5leHQsIGdldF9jb250ZXh0KSB7XG4gICAgbGV0IG8gPSBvbGRfYmxvY2tzLmxlbmd0aDtcbiAgICBsZXQgbiA9IGxpc3QubGVuZ3RoO1xuICAgIGxldCBpID0gbztcbiAgICBjb25zdCBvbGRfaW5kZXhlcyA9IHt9O1xuICAgIHdoaWxlIChpLS0pXG4gICAgICAgIG9sZF9pbmRleGVzW29sZF9ibG9ja3NbaV0ua2V5XSA9IGk7XG4gICAgY29uc3QgbmV3X2Jsb2NrcyA9IFtdO1xuICAgIGNvbnN0IG5ld19sb29rdXAgPSBuZXcgTWFwKCk7XG4gICAgY29uc3QgZGVsdGFzID0gbmV3IE1hcCgpO1xuICAgIGkgPSBuO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY29uc3QgY2hpbGRfY3R4ID0gZ2V0X2NvbnRleHQoY3R4LCBsaXN0LCBpKTtcbiAgICAgICAgY29uc3Qga2V5ID0gZ2V0X2tleShjaGlsZF9jdHgpO1xuICAgICAgICBsZXQgYmxvY2sgPSBsb29rdXAuZ2V0KGtleSk7XG4gICAgICAgIGlmICghYmxvY2spIHtcbiAgICAgICAgICAgIGJsb2NrID0gY3JlYXRlX2VhY2hfYmxvY2soa2V5LCBjaGlsZF9jdHgpO1xuICAgICAgICAgICAgYmxvY2suYygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGR5bmFtaWMpIHtcbiAgICAgICAgICAgIGJsb2NrLnAoY2hpbGRfY3R4LCBkaXJ0eSk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3X2xvb2t1cC5zZXQoa2V5LCBuZXdfYmxvY2tzW2ldID0gYmxvY2spO1xuICAgICAgICBpZiAoa2V5IGluIG9sZF9pbmRleGVzKVxuICAgICAgICAgICAgZGVsdGFzLnNldChrZXksIE1hdGguYWJzKGkgLSBvbGRfaW5kZXhlc1trZXldKSk7XG4gICAgfVxuICAgIGNvbnN0IHdpbGxfbW92ZSA9IG5ldyBTZXQoKTtcbiAgICBjb25zdCBkaWRfbW92ZSA9IG5ldyBTZXQoKTtcbiAgICBmdW5jdGlvbiBpbnNlcnQoYmxvY2spIHtcbiAgICAgICAgdHJhbnNpdGlvbl9pbihibG9jaywgMSk7XG4gICAgICAgIGJsb2NrLm0obm9kZSwgbmV4dCk7XG4gICAgICAgIGxvb2t1cC5zZXQoYmxvY2sua2V5LCBibG9jayk7XG4gICAgICAgIG5leHQgPSBibG9jay5maXJzdDtcbiAgICAgICAgbi0tO1xuICAgIH1cbiAgICB3aGlsZSAobyAmJiBuKSB7XG4gICAgICAgIGNvbnN0IG5ld19ibG9jayA9IG5ld19ibG9ja3NbbiAtIDFdO1xuICAgICAgICBjb25zdCBvbGRfYmxvY2sgPSBvbGRfYmxvY2tzW28gLSAxXTtcbiAgICAgICAgY29uc3QgbmV3X2tleSA9IG5ld19ibG9jay5rZXk7XG4gICAgICAgIGNvbnN0IG9sZF9rZXkgPSBvbGRfYmxvY2sua2V5O1xuICAgICAgICBpZiAobmV3X2Jsb2NrID09PSBvbGRfYmxvY2spIHtcbiAgICAgICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICAgICAgICAgIG5leHQgPSBuZXdfYmxvY2suZmlyc3Q7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgICAgICBuLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIW5ld19sb29rdXAuaGFzKG9sZF9rZXkpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgb2xkIGJsb2NrXG4gICAgICAgICAgICBkZXN0cm95KG9sZF9ibG9jaywgbG9va3VwKTtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghbG9va3VwLmhhcyhuZXdfa2V5KSB8fCB3aWxsX21vdmUuaGFzKG5ld19rZXkpKSB7XG4gICAgICAgICAgICBpbnNlcnQobmV3X2Jsb2NrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkaWRfbW92ZS5oYXMob2xkX2tleSkpIHtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZWx0YXMuZ2V0KG5ld19rZXkpID4gZGVsdGFzLmdldChvbGRfa2V5KSkge1xuICAgICAgICAgICAgZGlkX21vdmUuYWRkKG5ld19rZXkpO1xuICAgICAgICAgICAgaW5zZXJ0KG5ld19ibG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB3aWxsX21vdmUuYWRkKG9sZF9rZXkpO1xuICAgICAgICAgICAgby0tO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdoaWxlIChvLS0pIHtcbiAgICAgICAgY29uc3Qgb2xkX2Jsb2NrID0gb2xkX2Jsb2Nrc1tvXTtcbiAgICAgICAgaWYgKCFuZXdfbG9va3VwLmhhcyhvbGRfYmxvY2sua2V5KSlcbiAgICAgICAgICAgIGRlc3Ryb3kob2xkX2Jsb2NrLCBsb29rdXApO1xuICAgIH1cbiAgICB3aGlsZSAobilcbiAgICAgICAgaW5zZXJ0KG5ld19ibG9ja3NbbiAtIDFdKTtcbiAgICByZXR1cm4gbmV3X2Jsb2Nrcztcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX2VhY2hfa2V5cyhjdHgsIGxpc3QsIGdldF9jb250ZXh0LCBnZXRfa2V5KSB7XG4gICAgY29uc3Qga2V5cyA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qga2V5ID0gZ2V0X2tleShnZXRfY29udGV4dChjdHgsIGxpc3QsIGkpKTtcbiAgICAgICAgaWYgKGtleXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGhhdmUgZHVwbGljYXRlIGtleXMgaW4gYSBrZXllZCBlYWNoJyk7XG4gICAgICAgIH1cbiAgICAgICAga2V5cy5hZGQoa2V5KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldF9zcHJlYWRfdXBkYXRlKGxldmVscywgdXBkYXRlcykge1xuICAgIGNvbnN0IHVwZGF0ZSA9IHt9O1xuICAgIGNvbnN0IHRvX251bGxfb3V0ID0ge307XG4gICAgY29uc3QgYWNjb3VudGVkX2ZvciA9IHsgJCRzY29wZTogMSB9O1xuICAgIGxldCBpID0gbGV2ZWxzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbnN0IG8gPSBsZXZlbHNbaV07XG4gICAgICAgIGNvbnN0IG4gPSB1cGRhdGVzW2ldO1xuICAgICAgICBpZiAobikge1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbykge1xuICAgICAgICAgICAgICAgIGlmICghKGtleSBpbiBuKSlcbiAgICAgICAgICAgICAgICAgICAgdG9fbnVsbF9vdXRba2V5XSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBuKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhY2NvdW50ZWRfZm9yW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlW2tleV0gPSBuW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRlZF9mb3Jba2V5XSA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV2ZWxzW2ldID0gbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG8pIHtcbiAgICAgICAgICAgICAgICBhY2NvdW50ZWRfZm9yW2tleV0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3Qga2V5IGluIHRvX251bGxfb3V0KSB7XG4gICAgICAgIGlmICghKGtleSBpbiB1cGRhdGUpKVxuICAgICAgICAgICAgdXBkYXRlW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGU7XG59XG5mdW5jdGlvbiBnZXRfc3ByZWFkX29iamVjdChzcHJlYWRfcHJvcHMpIHtcbiAgICByZXR1cm4gdHlwZW9mIHNwcmVhZF9wcm9wcyA9PT0gJ29iamVjdCcgJiYgc3ByZWFkX3Byb3BzICE9PSBudWxsID8gc3ByZWFkX3Byb3BzIDoge307XG59XG5cbi8vIHNvdXJjZTogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvaW5kaWNlcy5odG1sXG5jb25zdCBib29sZWFuX2F0dHJpYnV0ZXMgPSBuZXcgU2V0KFtcbiAgICAnYWxsb3dmdWxsc2NyZWVuJyxcbiAgICAnYWxsb3dwYXltZW50cmVxdWVzdCcsXG4gICAgJ2FzeW5jJyxcbiAgICAnYXV0b2ZvY3VzJyxcbiAgICAnYXV0b3BsYXknLFxuICAgICdjaGVja2VkJyxcbiAgICAnY29udHJvbHMnLFxuICAgICdkZWZhdWx0JyxcbiAgICAnZGVmZXInLFxuICAgICdkaXNhYmxlZCcsXG4gICAgJ2Zvcm1ub3ZhbGlkYXRlJyxcbiAgICAnaGlkZGVuJyxcbiAgICAnaXNtYXAnLFxuICAgICdsb29wJyxcbiAgICAnbXVsdGlwbGUnLFxuICAgICdtdXRlZCcsXG4gICAgJ25vbW9kdWxlJyxcbiAgICAnbm92YWxpZGF0ZScsXG4gICAgJ29wZW4nLFxuICAgICdwbGF5c2lubGluZScsXG4gICAgJ3JlYWRvbmx5JyxcbiAgICAncmVxdWlyZWQnLFxuICAgICdyZXZlcnNlZCcsXG4gICAgJ3NlbGVjdGVkJ1xuXSk7XG5cbmNvbnN0IGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyID0gL1tcXHMnXCI+Lz1cXHV7RkREMH0tXFx1e0ZERUZ9XFx1e0ZGRkV9XFx1e0ZGRkZ9XFx1ezFGRkZFfVxcdXsxRkZGRn1cXHV7MkZGRkV9XFx1ezJGRkZGfVxcdXszRkZGRX1cXHV7M0ZGRkZ9XFx1ezRGRkZFfVxcdXs0RkZGRn1cXHV7NUZGRkV9XFx1ezVGRkZGfVxcdXs2RkZGRX1cXHV7NkZGRkZ9XFx1ezdGRkZFfVxcdXs3RkZGRn1cXHV7OEZGRkV9XFx1ezhGRkZGfVxcdXs5RkZGRX1cXHV7OUZGRkZ9XFx1e0FGRkZFfVxcdXtBRkZGRn1cXHV7QkZGRkV9XFx1e0JGRkZGfVxcdXtDRkZGRX1cXHV7Q0ZGRkZ9XFx1e0RGRkZFfVxcdXtERkZGRn1cXHV7RUZGRkV9XFx1e0VGRkZGfVxcdXtGRkZGRX1cXHV7RkZGRkZ9XFx1ezEwRkZGRX1cXHV7MTBGRkZGfV0vdTtcbi8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL3N5bnRheC5odG1sI2F0dHJpYnV0ZXMtMlxuLy8gaHR0cHM6Ly9pbmZyYS5zcGVjLndoYXR3Zy5vcmcvI25vbmNoYXJhY3RlclxuZnVuY3Rpb24gc3ByZWFkKGFyZ3MsIGF0dHJzX3RvX2FkZCkge1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBPYmplY3QuYXNzaWduKHt9LCAuLi5hcmdzKTtcbiAgICBpZiAoYXR0cnNfdG9fYWRkKSB7XG4gICAgICAgIGNvbnN0IGNsYXNzZXNfdG9fYWRkID0gYXR0cnNfdG9fYWRkLmNsYXNzZXM7XG4gICAgICAgIGNvbnN0IHN0eWxlc190b19hZGQgPSBhdHRyc190b19hZGQuc3R5bGVzO1xuICAgICAgICBpZiAoY2xhc3Nlc190b19hZGQpIHtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLmNsYXNzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzID0gY2xhc3Nlc190b19hZGQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzICs9ICcgJyArIGNsYXNzZXNfdG9fYWRkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzdHlsZXNfdG9fYWRkKSB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5zdHlsZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5zdHlsZSA9IHN0eWxlX29iamVjdF90b19zdHJpbmcoc3R5bGVzX3RvX2FkZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnN0eWxlID0gc3R5bGVfb2JqZWN0X3RvX3N0cmluZyhtZXJnZV9zc3Jfc3R5bGVzKGF0dHJpYnV0ZXMuc3R5bGUsIHN0eWxlc190b19hZGQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgc3RyID0gJyc7XG4gICAgT2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgaWYgKGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyLnRlc3QobmFtZSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXR0cmlidXRlc1tuYW1lXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSB0cnVlKVxuICAgICAgICAgICAgc3RyICs9ICcgJyArIG5hbWU7XG4gICAgICAgIGVsc2UgaWYgKGJvb2xlYW5fYXR0cmlidXRlcy5oYXMobmFtZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlKVxuICAgICAgICAgICAgICAgIHN0ciArPSAnICcgKyBuYW1lO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHN0ciArPSBgICR7bmFtZX09XCIke3ZhbHVlfVwiYDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBzdHI7XG59XG5mdW5jdGlvbiBtZXJnZV9zc3Jfc3R5bGVzKHN0eWxlX2F0dHJpYnV0ZSwgc3R5bGVfZGlyZWN0aXZlKSB7XG4gICAgY29uc3Qgc3R5bGVfb2JqZWN0ID0ge307XG4gICAgZm9yIChjb25zdCBpbmRpdmlkdWFsX3N0eWxlIG9mIHN0eWxlX2F0dHJpYnV0ZS5zcGxpdCgnOycpKSB7XG4gICAgICAgIGNvbnN0IGNvbG9uX2luZGV4ID0gaW5kaXZpZHVhbF9zdHlsZS5pbmRleE9mKCc6Jyk7XG4gICAgICAgIGNvbnN0IG5hbWUgPSBpbmRpdmlkdWFsX3N0eWxlLnNsaWNlKDAsIGNvbG9uX2luZGV4KS50cmltKCk7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gaW5kaXZpZHVhbF9zdHlsZS5zbGljZShjb2xvbl9pbmRleCArIDEpLnRyaW0oKTtcbiAgICAgICAgaWYgKCFuYW1lKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIHN0eWxlX29iamVjdFtuYW1lXSA9IHZhbHVlO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gc3R5bGVfZGlyZWN0aXZlKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gc3R5bGVfZGlyZWN0aXZlW25hbWVdO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHN0eWxlX29iamVjdFtuYW1lXSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGVsZXRlIHN0eWxlX29iamVjdFtuYW1lXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3R5bGVfb2JqZWN0O1xufVxuY29uc3QgZXNjYXBlZCA9IHtcbiAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICBcIidcIjogJyYjMzk7JyxcbiAgICAnJic6ICcmYW1wOycsXG4gICAgJzwnOiAnJmx0OycsXG4gICAgJz4nOiAnJmd0Oydcbn07XG5mdW5jdGlvbiBlc2NhcGUoaHRtbCkge1xuICAgIHJldHVybiBTdHJpbmcoaHRtbCkucmVwbGFjZSgvW1wiJyY8Pl0vZywgbWF0Y2ggPT4gZXNjYXBlZFttYXRjaF0pO1xufVxuZnVuY3Rpb24gZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZSh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnID8gZXNjYXBlKHZhbHVlKSA6IHZhbHVlO1xufVxuZnVuY3Rpb24gZXNjYXBlX29iamVjdChvYmopIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBlc2NhcGVfYXR0cmlidXRlX3ZhbHVlKG9ialtrZXldKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGVhY2goaXRlbXMsIGZuKSB7XG4gICAgbGV0IHN0ciA9ICcnO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgc3RyICs9IGZuKGl0ZW1zW2ldLCBpKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cjtcbn1cbmNvbnN0IG1pc3NpbmdfY29tcG9uZW50ID0ge1xuICAgICQkcmVuZGVyOiAoKSA9PiAnJ1xufTtcbmZ1bmN0aW9uIHZhbGlkYXRlX2NvbXBvbmVudChjb21wb25lbnQsIG5hbWUpIHtcbiAgICBpZiAoIWNvbXBvbmVudCB8fCAhY29tcG9uZW50LiQkcmVuZGVyKSB7XG4gICAgICAgIGlmIChuYW1lID09PSAnc3ZlbHRlOmNvbXBvbmVudCcpXG4gICAgICAgICAgICBuYW1lICs9ICcgdGhpcz17Li4ufSc7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgPCR7bmFtZX0+IGlzIG5vdCBhIHZhbGlkIFNTUiBjb21wb25lbnQuIFlvdSBtYXkgbmVlZCB0byByZXZpZXcgeW91ciBidWlsZCBjb25maWcgdG8gZW5zdXJlIHRoYXQgZGVwZW5kZW5jaWVzIGFyZSBjb21waWxlZCwgcmF0aGVyIHRoYW4gaW1wb3J0ZWQgYXMgcHJlLWNvbXBpbGVkIG1vZHVsZXNgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGRlYnVnKGZpbGUsIGxpbmUsIGNvbHVtbiwgdmFsdWVzKSB7XG4gICAgY29uc29sZS5sb2coYHtAZGVidWd9ICR7ZmlsZSA/IGZpbGUgKyAnICcgOiAnJ30oJHtsaW5lfToke2NvbHVtbn0pYCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUubG9nKHZhbHVlcyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIHJldHVybiAnJztcbn1cbmxldCBvbl9kZXN0cm95O1xuZnVuY3Rpb24gY3JlYXRlX3Nzcl9jb21wb25lbnQoZm4pIHtcbiAgICBmdW5jdGlvbiAkJHJlbmRlcihyZXN1bHQsIHByb3BzLCBiaW5kaW5ncywgc2xvdHMsIGNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgcGFyZW50X2NvbXBvbmVudCA9IGN1cnJlbnRfY29tcG9uZW50O1xuICAgICAgICBjb25zdCAkJCA9IHtcbiAgICAgICAgICAgIG9uX2Rlc3Ryb3ksXG4gICAgICAgICAgICBjb250ZXh0OiBuZXcgTWFwKGNvbnRleHQgfHwgKHBhcmVudF9jb21wb25lbnQgPyBwYXJlbnRfY29tcG9uZW50LiQkLmNvbnRleHQgOiBbXSkpLFxuICAgICAgICAgICAgLy8gdGhlc2Ugd2lsbCBiZSBpbW1lZGlhdGVseSBkaXNjYXJkZWRcbiAgICAgICAgICAgIG9uX21vdW50OiBbXSxcbiAgICAgICAgICAgIGJlZm9yZV91cGRhdGU6IFtdLFxuICAgICAgICAgICAgYWZ0ZXJfdXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGNhbGxiYWNrczogYmxhbmtfb2JqZWN0KClcbiAgICAgICAgfTtcbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHsgJCQgfSk7XG4gICAgICAgIGNvbnN0IGh0bWwgPSBmbihyZXN1bHQsIHByb3BzLCBiaW5kaW5ncywgc2xvdHMpO1xuICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQocGFyZW50X2NvbXBvbmVudCk7XG4gICAgICAgIHJldHVybiBodG1sO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICByZW5kZXI6IChwcm9wcyA9IHt9LCB7ICQkc2xvdHMgPSB7fSwgY29udGV4dCA9IG5ldyBNYXAoKSB9ID0ge30pID0+IHtcbiAgICAgICAgICAgIG9uX2Rlc3Ryb3kgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHsgdGl0bGU6ICcnLCBoZWFkOiAnJywgY3NzOiBuZXcgU2V0KCkgfTtcbiAgICAgICAgICAgIGNvbnN0IGh0bWwgPSAkJHJlbmRlcihyZXN1bHQsIHByb3BzLCB7fSwgJCRzbG90cywgY29udGV4dCk7XG4gICAgICAgICAgICBydW5fYWxsKG9uX2Rlc3Ryb3kpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBodG1sLFxuICAgICAgICAgICAgICAgIGNzczoge1xuICAgICAgICAgICAgICAgICAgICBjb2RlOiBBcnJheS5mcm9tKHJlc3VsdC5jc3MpLm1hcChjc3MgPT4gY3NzLmNvZGUpLmpvaW4oJ1xcbicpLFxuICAgICAgICAgICAgICAgICAgICBtYXA6IG51bGwgLy8gVE9ET1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaGVhZDogcmVzdWx0LnRpdGxlICsgcmVzdWx0LmhlYWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgICQkcmVuZGVyXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGFkZF9hdHRyaWJ1dGUobmFtZSwgdmFsdWUsIGJvb2xlYW4pIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCB8fCAoYm9vbGVhbiAmJiAhdmFsdWUpKVxuICAgICAgICByZXR1cm4gJyc7XG4gICAgcmV0dXJuIGAgJHtuYW1lfSR7dmFsdWUgPT09IHRydWUgJiYgYm9vbGVhbl9hdHRyaWJ1dGVzLmhhcyhuYW1lKSA/ICcnIDogYD0ke3R5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyBKU09OLnN0cmluZ2lmeShlc2NhcGUodmFsdWUpKSA6IGBcIiR7dmFsdWV9XCJgfWB9YDtcbn1cbmZ1bmN0aW9uIGFkZF9jbGFzc2VzKGNsYXNzZXMpIHtcbiAgICByZXR1cm4gY2xhc3NlcyA/IGAgY2xhc3M9XCIke2NsYXNzZXN9XCJgIDogJyc7XG59XG5mdW5jdGlvbiBzdHlsZV9vYmplY3RfdG9fc3RyaW5nKHN0eWxlX29iamVjdCkge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhzdHlsZV9vYmplY3QpXG4gICAgICAgIC5maWx0ZXIoa2V5ID0+IHN0eWxlX29iamVjdFtrZXldKVxuICAgICAgICAubWFwKGtleSA9PiBgJHtrZXl9OiAke3N0eWxlX29iamVjdFtrZXldfTtgKVxuICAgICAgICAuam9pbignICcpO1xufVxuZnVuY3Rpb24gYWRkX3N0eWxlcyhzdHlsZV9vYmplY3QpIHtcbiAgICBjb25zdCBzdHlsZXMgPSBzdHlsZV9vYmplY3RfdG9fc3RyaW5nKHN0eWxlX29iamVjdCk7XG4gICAgcmV0dXJuIHN0eWxlcyA/IGAgc3R5bGU9XCIke3N0eWxlc31cImAgOiAnJztcbn1cblxuZnVuY3Rpb24gYmluZChjb21wb25lbnQsIG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgY29uc3QgaW5kZXggPSBjb21wb25lbnQuJCQucHJvcHNbbmFtZV07XG4gICAgaWYgKGluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29tcG9uZW50LiQkLmJvdW5kW2luZGV4XSA9IGNhbGxiYWNrO1xuICAgICAgICBjYWxsYmFjayhjb21wb25lbnQuJCQuY3R4W2luZGV4XSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlX2NvbXBvbmVudChibG9jaykge1xuICAgIGJsb2NrICYmIGJsb2NrLmMoKTtcbn1cbmZ1bmN0aW9uIGNsYWltX2NvbXBvbmVudChibG9jaywgcGFyZW50X25vZGVzKSB7XG4gICAgYmxvY2sgJiYgYmxvY2subChwYXJlbnRfbm9kZXMpO1xufVxuZnVuY3Rpb24gbW91bnRfY29tcG9uZW50KGNvbXBvbmVudCwgdGFyZ2V0LCBhbmNob3IsIGN1c3RvbUVsZW1lbnQpIHtcbiAgICBjb25zdCB7IGZyYWdtZW50LCBvbl9tb3VudCwgb25fZGVzdHJveSwgYWZ0ZXJfdXBkYXRlIH0gPSBjb21wb25lbnQuJCQ7XG4gICAgZnJhZ21lbnQgJiYgZnJhZ21lbnQubSh0YXJnZXQsIGFuY2hvcik7XG4gICAgaWYgKCFjdXN0b21FbGVtZW50KSB7XG4gICAgICAgIC8vIG9uTW91bnQgaGFwcGVucyBiZWZvcmUgdGhlIGluaXRpYWwgYWZ0ZXJVcGRhdGVcbiAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdfb25fZGVzdHJveSA9IG9uX21vdW50Lm1hcChydW4pLmZpbHRlcihpc19mdW5jdGlvbik7XG4gICAgICAgICAgICBpZiAob25fZGVzdHJveSkge1xuICAgICAgICAgICAgICAgIG9uX2Rlc3Ryb3kucHVzaCguLi5uZXdfb25fZGVzdHJveSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBFZGdlIGNhc2UgLSBjb21wb25lbnQgd2FzIGRlc3Ryb3llZCBpbW1lZGlhdGVseSxcbiAgICAgICAgICAgICAgICAvLyBtb3N0IGxpa2VseSBhcyBhIHJlc3VsdCBvZiBhIGJpbmRpbmcgaW5pdGlhbGlzaW5nXG4gICAgICAgICAgICAgICAgcnVuX2FsbChuZXdfb25fZGVzdHJveSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb21wb25lbnQuJCQub25fbW91bnQgPSBbXTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFmdGVyX3VwZGF0ZS5mb3JFYWNoKGFkZF9yZW5kZXJfY2FsbGJhY2spO1xufVxuZnVuY3Rpb24gZGVzdHJveV9jb21wb25lbnQoY29tcG9uZW50LCBkZXRhY2hpbmcpIHtcbiAgICBjb25zdCAkJCA9IGNvbXBvbmVudC4kJDtcbiAgICBpZiAoJCQuZnJhZ21lbnQgIT09IG51bGwpIHtcbiAgICAgICAgcnVuX2FsbCgkJC5vbl9kZXN0cm95KTtcbiAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQuZChkZXRhY2hpbmcpO1xuICAgICAgICAvLyBUT0RPIG51bGwgb3V0IG90aGVyIHJlZnMsIGluY2x1ZGluZyBjb21wb25lbnQuJCQgKGJ1dCBuZWVkIHRvXG4gICAgICAgIC8vIHByZXNlcnZlIGZpbmFsIHN0YXRlPylcbiAgICAgICAgJCQub25fZGVzdHJveSA9ICQkLmZyYWdtZW50ID0gbnVsbDtcbiAgICAgICAgJCQuY3R4ID0gW107XG4gICAgfVxufVxuZnVuY3Rpb24gbWFrZV9kaXJ0eShjb21wb25lbnQsIGkpIHtcbiAgICBpZiAoY29tcG9uZW50LiQkLmRpcnR5WzBdID09PSAtMSkge1xuICAgICAgICBkaXJ0eV9jb21wb25lbnRzLnB1c2goY29tcG9uZW50KTtcbiAgICAgICAgc2NoZWR1bGVfdXBkYXRlKCk7XG4gICAgICAgIGNvbXBvbmVudC4kJC5kaXJ0eS5maWxsKDApO1xuICAgIH1cbiAgICBjb21wb25lbnQuJCQuZGlydHlbKGkgLyAzMSkgfCAwXSB8PSAoMSA8PCAoaSAlIDMxKSk7XG59XG5mdW5jdGlvbiBpbml0KGNvbXBvbmVudCwgb3B0aW9ucywgaW5zdGFuY2UsIGNyZWF0ZV9mcmFnbWVudCwgbm90X2VxdWFsLCBwcm9wcywgYXBwZW5kX3N0eWxlcywgZGlydHkgPSBbLTFdKSB7XG4gICAgY29uc3QgcGFyZW50X2NvbXBvbmVudCA9IGN1cnJlbnRfY29tcG9uZW50O1xuICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpO1xuICAgIGNvbnN0ICQkID0gY29tcG9uZW50LiQkID0ge1xuICAgICAgICBmcmFnbWVudDogbnVsbCxcbiAgICAgICAgY3R4OiBudWxsLFxuICAgICAgICAvLyBzdGF0ZVxuICAgICAgICBwcm9wcyxcbiAgICAgICAgdXBkYXRlOiBub29wLFxuICAgICAgICBub3RfZXF1YWwsXG4gICAgICAgIGJvdW5kOiBibGFua19vYmplY3QoKSxcbiAgICAgICAgLy8gbGlmZWN5Y2xlXG4gICAgICAgIG9uX21vdW50OiBbXSxcbiAgICAgICAgb25fZGVzdHJveTogW10sXG4gICAgICAgIG9uX2Rpc2Nvbm5lY3Q6IFtdLFxuICAgICAgICBiZWZvcmVfdXBkYXRlOiBbXSxcbiAgICAgICAgYWZ0ZXJfdXBkYXRlOiBbXSxcbiAgICAgICAgY29udGV4dDogbmV3IE1hcChvcHRpb25zLmNvbnRleHQgfHwgKHBhcmVudF9jb21wb25lbnQgPyBwYXJlbnRfY29tcG9uZW50LiQkLmNvbnRleHQgOiBbXSkpLFxuICAgICAgICAvLyBldmVyeXRoaW5nIGVsc2VcbiAgICAgICAgY2FsbGJhY2tzOiBibGFua19vYmplY3QoKSxcbiAgICAgICAgZGlydHksXG4gICAgICAgIHNraXBfYm91bmQ6IGZhbHNlLFxuICAgICAgICByb290OiBvcHRpb25zLnRhcmdldCB8fCBwYXJlbnRfY29tcG9uZW50LiQkLnJvb3RcbiAgICB9O1xuICAgIGFwcGVuZF9zdHlsZXMgJiYgYXBwZW5kX3N0eWxlcygkJC5yb290KTtcbiAgICBsZXQgcmVhZHkgPSBmYWxzZTtcbiAgICAkJC5jdHggPSBpbnN0YW5jZVxuICAgICAgICA/IGluc3RhbmNlKGNvbXBvbmVudCwgb3B0aW9ucy5wcm9wcyB8fCB7fSwgKGksIHJldCwgLi4ucmVzdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSByZXN0Lmxlbmd0aCA/IHJlc3RbMF0gOiByZXQ7XG4gICAgICAgICAgICBpZiAoJCQuY3R4ICYmIG5vdF9lcXVhbCgkJC5jdHhbaV0sICQkLmN0eFtpXSA9IHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGlmICghJCQuc2tpcF9ib3VuZCAmJiAkJC5ib3VuZFtpXSlcbiAgICAgICAgICAgICAgICAgICAgJCQuYm91bmRbaV0odmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChyZWFkeSlcbiAgICAgICAgICAgICAgICAgICAgbWFrZV9kaXJ0eShjb21wb25lbnQsIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfSlcbiAgICAgICAgOiBbXTtcbiAgICAkJC51cGRhdGUoKTtcbiAgICByZWFkeSA9IHRydWU7XG4gICAgcnVuX2FsbCgkJC5iZWZvcmVfdXBkYXRlKTtcbiAgICAvLyBgZmFsc2VgIGFzIGEgc3BlY2lhbCBjYXNlIG9mIG5vIERPTSBjb21wb25lbnRcbiAgICAkJC5mcmFnbWVudCA9IGNyZWF0ZV9mcmFnbWVudCA/IGNyZWF0ZV9mcmFnbWVudCgkJC5jdHgpIDogZmFsc2U7XG4gICAgaWYgKG9wdGlvbnMudGFyZ2V0KSB7XG4gICAgICAgIGlmIChvcHRpb25zLmh5ZHJhdGUpIHtcbiAgICAgICAgICAgIHN0YXJ0X2h5ZHJhdGluZygpO1xuICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSBjaGlsZHJlbihvcHRpb25zLnRhcmdldCk7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQubChub2Rlcyk7XG4gICAgICAgICAgICBub2Rlcy5mb3JFYWNoKGRldGFjaCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQuYygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmludHJvKVxuICAgICAgICAgICAgdHJhbnNpdGlvbl9pbihjb21wb25lbnQuJCQuZnJhZ21lbnQpO1xuICAgICAgICBtb3VudF9jb21wb25lbnQoY29tcG9uZW50LCBvcHRpb25zLnRhcmdldCwgb3B0aW9ucy5hbmNob3IsIG9wdGlvbnMuY3VzdG9tRWxlbWVudCk7XG4gICAgICAgIGVuZF9oeWRyYXRpbmcoKTtcbiAgICAgICAgZmx1c2goKTtcbiAgICB9XG4gICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHBhcmVudF9jb21wb25lbnQpO1xufVxubGV0IFN2ZWx0ZUVsZW1lbnQ7XG5pZiAodHlwZW9mIEhUTUxFbGVtZW50ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgU3ZlbHRlRWxlbWVudCA9IGNsYXNzIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgICB0aGlzLmF0dGFjaFNoYWRvdyh7IG1vZGU6ICdvcGVuJyB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgb25fbW91bnQgfSA9IHRoaXMuJCQ7XG4gICAgICAgICAgICB0aGlzLiQkLm9uX2Rpc2Nvbm5lY3QgPSBvbl9tb3VudC5tYXAocnVuKS5maWx0ZXIoaXNfZnVuY3Rpb24pO1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBpbXByb3ZlIHR5cGluZ3NcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuJCQuc2xvdHRlZCkge1xuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmRDaGlsZCh0aGlzLiQkLnNsb3R0ZWRba2V5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrKGF0dHIsIF9vbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXNbYXR0cl0gPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgICAgIHJ1bl9hbGwodGhpcy4kJC5vbl9kaXNjb25uZWN0KTtcbiAgICAgICAgfVxuICAgICAgICAkZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGRlc3Ryb3lfY29tcG9uZW50KHRoaXMsIDEpO1xuICAgICAgICAgICAgdGhpcy4kZGVzdHJveSA9IG5vb3A7XG4gICAgICAgIH1cbiAgICAgICAgJG9uKHR5cGUsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAvLyBUT0RPIHNob3VsZCB0aGlzIGRlbGVnYXRlIHRvIGFkZEV2ZW50TGlzdGVuZXI/XG4gICAgICAgICAgICBjb25zdCBjYWxsYmFja3MgPSAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gfHwgKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdID0gW10pKTtcbiAgICAgICAgICAgIGNhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBjYWxsYmFja3MuaW5kZXhPZihjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgICRzZXQoJCRwcm9wcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuJCRzZXQgJiYgIWlzX2VtcHR5KCQkcHJvcHMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLiQkc2V0KCQkcHJvcHMpO1xuICAgICAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbi8qKlxuICogQmFzZSBjbGFzcyBmb3IgU3ZlbHRlIGNvbXBvbmVudHMuIFVzZWQgd2hlbiBkZXY9ZmFsc2UuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudCB7XG4gICAgJGRlc3Ryb3koKSB7XG4gICAgICAgIGRlc3Ryb3lfY29tcG9uZW50KHRoaXMsIDEpO1xuICAgICAgICB0aGlzLiRkZXN0cm95ID0gbm9vcDtcbiAgICB9XG4gICAgJG9uKHR5cGUsIGNhbGxiYWNrKSB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSB8fCAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gPSBbXSkpO1xuICAgICAgICBjYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IGNhbGxiYWNrcy5pbmRleE9mKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpXG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH07XG4gICAgfVxuICAgICRzZXQoJCRwcm9wcykge1xuICAgICAgICBpZiAodGhpcy4kJHNldCAmJiAhaXNfZW1wdHkoJCRwcm9wcykpIHtcbiAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLiQkc2V0KCQkcHJvcHMpO1xuICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRpc3BhdGNoX2Rldih0eXBlLCBkZXRhaWwpIHtcbiAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGN1c3RvbV9ldmVudCh0eXBlLCBPYmplY3QuYXNzaWduKHsgdmVyc2lvbjogJzMuNDYuMicgfSwgZGV0YWlsKSwgdHJ1ZSkpO1xufVxuZnVuY3Rpb24gYXBwZW5kX2Rldih0YXJnZXQsIG5vZGUpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUluc2VydCcsIHsgdGFyZ2V0LCBub2RlIH0pO1xuICAgIGFwcGVuZCh0YXJnZXQsIG5vZGUpO1xufVxuZnVuY3Rpb24gYXBwZW5kX2h5ZHJhdGlvbl9kZXYodGFyZ2V0LCBub2RlKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSB9KTtcbiAgICBhcHBlbmRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSk7XG59XG5mdW5jdGlvbiBpbnNlcnRfZGV2KHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSwgYW5jaG9yIH0pO1xuICAgIGluc2VydCh0YXJnZXQsIG5vZGUsIGFuY2hvcik7XG59XG5mdW5jdGlvbiBpbnNlcnRfaHlkcmF0aW9uX2Rldih0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NSW5zZXJ0JywgeyB0YXJnZXQsIG5vZGUsIGFuY2hvciB9KTtcbiAgICBpbnNlcnRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSwgYW5jaG9yKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9kZXYobm9kZSkge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlJywgeyBub2RlIH0pO1xuICAgIGRldGFjaChub2RlKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9iZXR3ZWVuX2RldihiZWZvcmUsIGFmdGVyKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZyAmJiBiZWZvcmUubmV4dFNpYmxpbmcgIT09IGFmdGVyKSB7XG4gICAgICAgIGRldGFjaF9kZXYoYmVmb3JlLm5leHRTaWJsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZXRhY2hfYmVmb3JlX2RldihhZnRlcikge1xuICAgIHdoaWxlIChhZnRlci5wcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgICAgZGV0YWNoX2RldihhZnRlci5wcmV2aW91c1NpYmxpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRldGFjaF9hZnRlcl9kZXYoYmVmb3JlKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZykge1xuICAgICAgICBkZXRhY2hfZGV2KGJlZm9yZS5uZXh0U2libGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbGlzdGVuX2Rldihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucywgaGFzX3ByZXZlbnRfZGVmYXVsdCwgaGFzX3N0b3BfcHJvcGFnYXRpb24pIHtcbiAgICBjb25zdCBtb2RpZmllcnMgPSBvcHRpb25zID09PSB0cnVlID8gWydjYXB0dXJlJ10gOiBvcHRpb25zID8gQXJyYXkuZnJvbShPYmplY3Qua2V5cyhvcHRpb25zKSkgOiBbXTtcbiAgICBpZiAoaGFzX3ByZXZlbnRfZGVmYXVsdClcbiAgICAgICAgbW9kaWZpZXJzLnB1c2goJ3ByZXZlbnREZWZhdWx0Jyk7XG4gICAgaWYgKGhhc19zdG9wX3Byb3BhZ2F0aW9uKVxuICAgICAgICBtb2RpZmllcnMucHVzaCgnc3RvcFByb3BhZ2F0aW9uJyk7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01BZGRFdmVudExpc3RlbmVyJywgeyBub2RlLCBldmVudCwgaGFuZGxlciwgbW9kaWZpZXJzIH0pO1xuICAgIGNvbnN0IGRpc3Bvc2UgPSBsaXN0ZW4obm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlRXZlbnRMaXN0ZW5lcicsIHsgbm9kZSwgZXZlbnQsIGhhbmRsZXIsIG1vZGlmaWVycyB9KTtcbiAgICAgICAgZGlzcG9zZSgpO1xuICAgIH07XG59XG5mdW5jdGlvbiBhdHRyX2Rldihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgICBpZiAodmFsdWUgPT0gbnVsbClcbiAgICAgICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01SZW1vdmVBdHRyaWJ1dGUnLCB7IG5vZGUsIGF0dHJpYnV0ZSB9KTtcbiAgICBlbHNlXG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0QXR0cmlidXRlJywgeyBub2RlLCBhdHRyaWJ1dGUsIHZhbHVlIH0pO1xufVxuZnVuY3Rpb24gcHJvcF9kZXYobm9kZSwgcHJvcGVydHksIHZhbHVlKSB7XG4gICAgbm9kZVtwcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldFByb3BlcnR5JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBkYXRhc2V0X2Rldihub2RlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICBub2RlLmRhdGFzZXRbcHJvcGVydHldID0gdmFsdWU7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhc2V0JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBzZXRfZGF0YV9kZXYodGV4dCwgZGF0YSkge1xuICAgIGRhdGEgPSAnJyArIGRhdGE7XG4gICAgaWYgKHRleHQud2hvbGVUZXh0ID09PSBkYXRhKVxuICAgICAgICByZXR1cm47XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhJywgeyBub2RlOiB0ZXh0LCBkYXRhIH0pO1xuICAgIHRleHQuZGF0YSA9IGRhdGE7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50KGFyZykge1xuICAgIGlmICh0eXBlb2YgYXJnICE9PSAnc3RyaW5nJyAmJiAhKGFyZyAmJiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiAnbGVuZ3RoJyBpbiBhcmcpKSB7XG4gICAgICAgIGxldCBtc2cgPSAneyNlYWNofSBvbmx5IGl0ZXJhdGVzIG92ZXIgYXJyYXktbGlrZSBvYmplY3RzLic7XG4gICAgICAgIGlmICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIGFyZyAmJiBTeW1ib2wuaXRlcmF0b3IgaW4gYXJnKSB7XG4gICAgICAgICAgICBtc2cgKz0gJyBZb3UgY2FuIHVzZSBhIHNwcmVhZCB0byBjb252ZXJ0IHRoaXMgaXRlcmFibGUgaW50byBhbiBhcnJheS4nO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX3Nsb3RzKG5hbWUsIHNsb3QsIGtleXMpIHtcbiAgICBmb3IgKGNvbnN0IHNsb3Rfa2V5IG9mIE9iamVjdC5rZXlzKHNsb3QpKSB7XG4gICAgICAgIGlmICghfmtleXMuaW5kZXhPZihzbG90X2tleSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgPCR7bmFtZX0+IHJlY2VpdmVkIGFuIHVuZXhwZWN0ZWQgc2xvdCBcIiR7c2xvdF9rZXl9XCIuYCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIFN2ZWx0ZSBjb21wb25lbnRzIHdpdGggc29tZSBtaW5vciBkZXYtZW5oYW5jZW1lbnRzLiBVc2VkIHdoZW4gZGV2PXRydWUuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudERldiBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICBpZiAoIW9wdGlvbnMgfHwgKCFvcHRpb25zLnRhcmdldCAmJiAhb3B0aW9ucy4kJGlubGluZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIid0YXJnZXQnIGlzIGEgcmVxdWlyZWQgb3B0aW9uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyKCk7XG4gICAgfVxuICAgICRkZXN0cm95KCkge1xuICAgICAgICBzdXBlci4kZGVzdHJveSgpO1xuICAgICAgICB0aGlzLiRkZXN0cm95ID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdDb21wb25lbnQgd2FzIGFscmVhZHkgZGVzdHJveWVkJyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICB9O1xuICAgIH1cbiAgICAkY2FwdHVyZV9zdGF0ZSgpIHsgfVxuICAgICRpbmplY3Rfc3RhdGUoKSB7IH1cbn1cbi8qKlxuICogQmFzZSBjbGFzcyB0byBjcmVhdGUgc3Ryb25nbHkgdHlwZWQgU3ZlbHRlIGNvbXBvbmVudHMuXG4gKiBUaGlzIG9ubHkgZXhpc3RzIGZvciB0eXBpbmcgcHVycG9zZXMgYW5kIHNob3VsZCBiZSB1c2VkIGluIGAuZC50c2AgZmlsZXMuXG4gKlxuICogIyMjIEV4YW1wbGU6XG4gKlxuICogWW91IGhhdmUgY29tcG9uZW50IGxpYnJhcnkgb24gbnBtIGNhbGxlZCBgY29tcG9uZW50LWxpYnJhcnlgLCBmcm9tIHdoaWNoXG4gKiB5b3UgZXhwb3J0IGEgY29tcG9uZW50IGNhbGxlZCBgTXlDb21wb25lbnRgLiBGb3IgU3ZlbHRlK1R5cGVTY3JpcHQgdXNlcnMsXG4gKiB5b3Ugd2FudCB0byBwcm92aWRlIHR5cGluZ3MuIFRoZXJlZm9yZSB5b3UgY3JlYXRlIGEgYGluZGV4LmQudHNgOlxuICogYGBgdHNcbiAqIGltcG9ydCB7IFN2ZWx0ZUNvbXBvbmVudFR5cGVkIH0gZnJvbSBcInN2ZWx0ZVwiO1xuICogZXhwb3J0IGNsYXNzIE15Q29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50VHlwZWQ8e2Zvbzogc3RyaW5nfT4ge31cbiAqIGBgYFxuICogVHlwaW5nIHRoaXMgbWFrZXMgaXQgcG9zc2libGUgZm9yIElERXMgbGlrZSBWUyBDb2RlIHdpdGggdGhlIFN2ZWx0ZSBleHRlbnNpb25cbiAqIHRvIHByb3ZpZGUgaW50ZWxsaXNlbnNlIGFuZCB0byB1c2UgdGhlIGNvbXBvbmVudCBsaWtlIHRoaXMgaW4gYSBTdmVsdGUgZmlsZVxuICogd2l0aCBUeXBlU2NyaXB0OlxuICogYGBgc3ZlbHRlXG4gKiA8c2NyaXB0IGxhbmc9XCJ0c1wiPlxuICogXHRpbXBvcnQgeyBNeUNvbXBvbmVudCB9IGZyb20gXCJjb21wb25lbnQtbGlicmFyeVwiO1xuICogPC9zY3JpcHQ+XG4gKiA8TXlDb21wb25lbnQgZm9vPXsnYmFyJ30gLz5cbiAqIGBgYFxuICpcbiAqICMjIyMgV2h5IG5vdCBtYWtlIHRoaXMgcGFydCBvZiBgU3ZlbHRlQ29tcG9uZW50KERldilgP1xuICogQmVjYXVzZVxuICogYGBgdHNcbiAqIGNsYXNzIEFTdWJjbGFzc09mU3ZlbHRlQ29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50PHtmb286IHN0cmluZ30+IHt9XG4gKiBjb25zdCBjb21wb25lbnQ6IHR5cGVvZiBTdmVsdGVDb21wb25lbnQgPSBBU3ViY2xhc3NPZlN2ZWx0ZUNvbXBvbmVudDtcbiAqIGBgYFxuICogd2lsbCB0aHJvdyBhIHR5cGUgZXJyb3IsIHNvIHdlIG5lZWQgdG8gc2VwYXJhdGUgdGhlIG1vcmUgc3RyaWN0bHkgdHlwZWQgY2xhc3MuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudFR5cGVkIGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50RGV2IHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGxvb3BfZ3VhcmQodGltZW91dCkge1xuICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHN0YXJ0ID4gdGltZW91dCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbmZpbml0ZSBsb29wIGRldGVjdGVkJyk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5leHBvcnQgeyBIdG1sVGFnLCBIdG1sVGFnSHlkcmF0aW9uLCBTdmVsdGVDb21wb25lbnQsIFN2ZWx0ZUNvbXBvbmVudERldiwgU3ZlbHRlQ29tcG9uZW50VHlwZWQsIFN2ZWx0ZUVsZW1lbnQsIGFjdGlvbl9kZXN0cm95ZXIsIGFkZF9hdHRyaWJ1dGUsIGFkZF9jbGFzc2VzLCBhZGRfZmx1c2hfY2FsbGJhY2ssIGFkZF9sb2NhdGlvbiwgYWRkX3JlbmRlcl9jYWxsYmFjaywgYWRkX3Jlc2l6ZV9saXN0ZW5lciwgYWRkX3N0eWxlcywgYWRkX3RyYW5zZm9ybSwgYWZ0ZXJVcGRhdGUsIGFwcGVuZCwgYXBwZW5kX2RldiwgYXBwZW5kX2VtcHR5X3N0eWxlc2hlZXQsIGFwcGVuZF9oeWRyYXRpb24sIGFwcGVuZF9oeWRyYXRpb25fZGV2LCBhcHBlbmRfc3R5bGVzLCBhc3NpZ24sIGF0dHIsIGF0dHJfZGV2LCBhdHRyaWJ1dGVfdG9fb2JqZWN0LCBiZWZvcmVVcGRhdGUsIGJpbmQsIGJpbmRpbmdfY2FsbGJhY2tzLCBibGFua19vYmplY3QsIGJ1YmJsZSwgY2hlY2tfb3V0cm9zLCBjaGlsZHJlbiwgY2xhaW1fY29tcG9uZW50LCBjbGFpbV9lbGVtZW50LCBjbGFpbV9odG1sX3RhZywgY2xhaW1fc3BhY2UsIGNsYWltX3N2Z19lbGVtZW50LCBjbGFpbV90ZXh0LCBjbGVhcl9sb29wcywgY29tcG9uZW50X3N1YnNjcmliZSwgY29tcHV0ZV9yZXN0X3Byb3BzLCBjb21wdXRlX3Nsb3RzLCBjcmVhdGVFdmVudERpc3BhdGNoZXIsIGNyZWF0ZV9hbmltYXRpb24sIGNyZWF0ZV9iaWRpcmVjdGlvbmFsX3RyYW5zaXRpb24sIGNyZWF0ZV9jb21wb25lbnQsIGNyZWF0ZV9pbl90cmFuc2l0aW9uLCBjcmVhdGVfb3V0X3RyYW5zaXRpb24sIGNyZWF0ZV9zbG90LCBjcmVhdGVfc3NyX2NvbXBvbmVudCwgY3VycmVudF9jb21wb25lbnQsIGN1c3RvbV9ldmVudCwgZGF0YXNldF9kZXYsIGRlYnVnLCBkZXN0cm95X2Jsb2NrLCBkZXN0cm95X2NvbXBvbmVudCwgZGVzdHJveV9lYWNoLCBkZXRhY2gsIGRldGFjaF9hZnRlcl9kZXYsIGRldGFjaF9iZWZvcmVfZGV2LCBkZXRhY2hfYmV0d2Vlbl9kZXYsIGRldGFjaF9kZXYsIGRpcnR5X2NvbXBvbmVudHMsIGRpc3BhdGNoX2RldiwgZWFjaCwgZWxlbWVudCwgZWxlbWVudF9pcywgZW1wdHksIGVuZF9oeWRyYXRpbmcsIGVzY2FwZSwgZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZSwgZXNjYXBlX29iamVjdCwgZXNjYXBlZCwgZXhjbHVkZV9pbnRlcm5hbF9wcm9wcywgZml4X2FuZF9kZXN0cm95X2Jsb2NrLCBmaXhfYW5kX291dHJvX2FuZF9kZXN0cm95X2Jsb2NrLCBmaXhfcG9zaXRpb24sIGZsdXNoLCBnZXRBbGxDb250ZXh0cywgZ2V0Q29udGV4dCwgZ2V0X2FsbF9kaXJ0eV9mcm9tX3Njb3BlLCBnZXRfYmluZGluZ19ncm91cF92YWx1ZSwgZ2V0X2N1cnJlbnRfY29tcG9uZW50LCBnZXRfY3VzdG9tX2VsZW1lbnRzX3Nsb3RzLCBnZXRfcm9vdF9mb3Jfc3R5bGUsIGdldF9zbG90X2NoYW5nZXMsIGdldF9zcHJlYWRfb2JqZWN0LCBnZXRfc3ByZWFkX3VwZGF0ZSwgZ2V0X3N0b3JlX3ZhbHVlLCBnbG9iYWxzLCBncm91cF9vdXRyb3MsIGhhbmRsZV9wcm9taXNlLCBoYXNDb250ZXh0LCBoYXNfcHJvcCwgaWRlbnRpdHksIGluaXQsIGluc2VydCwgaW5zZXJ0X2RldiwgaW5zZXJ0X2h5ZHJhdGlvbiwgaW5zZXJ0X2h5ZHJhdGlvbl9kZXYsIGludHJvcywgaW52YWxpZF9hdHRyaWJ1dGVfbmFtZV9jaGFyYWN0ZXIsIGlzX2NsaWVudCwgaXNfY3Jvc3NvcmlnaW4sIGlzX2VtcHR5LCBpc19mdW5jdGlvbiwgaXNfcHJvbWlzZSwgbGlzdGVuLCBsaXN0ZW5fZGV2LCBsb29wLCBsb29wX2d1YXJkLCBtZXJnZV9zc3Jfc3R5bGVzLCBtaXNzaW5nX2NvbXBvbmVudCwgbW91bnRfY29tcG9uZW50LCBub29wLCBub3RfZXF1YWwsIG5vdywgbnVsbF90b19lbXB0eSwgb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllcywgb25EZXN0cm95LCBvbk1vdW50LCBvbmNlLCBvdXRyb19hbmRfZGVzdHJveV9ibG9jaywgcHJldmVudF9kZWZhdWx0LCBwcm9wX2RldiwgcXVlcnlfc2VsZWN0b3JfYWxsLCByYWYsIHJ1biwgcnVuX2FsbCwgc2FmZV9ub3RfZXF1YWwsIHNjaGVkdWxlX3VwZGF0ZSwgc2VsZWN0X211bHRpcGxlX3ZhbHVlLCBzZWxlY3Rfb3B0aW9uLCBzZWxlY3Rfb3B0aW9ucywgc2VsZWN0X3ZhbHVlLCBzZWxmLCBzZXRDb250ZXh0LCBzZXRfYXR0cmlidXRlcywgc2V0X2N1cnJlbnRfY29tcG9uZW50LCBzZXRfY3VzdG9tX2VsZW1lbnRfZGF0YSwgc2V0X2RhdGEsIHNldF9kYXRhX2Rldiwgc2V0X2lucHV0X3R5cGUsIHNldF9pbnB1dF92YWx1ZSwgc2V0X25vdywgc2V0X3JhZiwgc2V0X3N0b3JlX3ZhbHVlLCBzZXRfc3R5bGUsIHNldF9zdmdfYXR0cmlidXRlcywgc3BhY2UsIHNwcmVhZCwgc3JjX3VybF9lcXVhbCwgc3RhcnRfaHlkcmF0aW5nLCBzdG9wX3Byb3BhZ2F0aW9uLCBzdWJzY3JpYmUsIHN2Z19lbGVtZW50LCB0ZXh0LCB0aWNrLCB0aW1lX3Jhbmdlc190b19hcnJheSwgdG9fbnVtYmVyLCB0b2dnbGVfY2xhc3MsIHRyYW5zaXRpb25faW4sIHRyYW5zaXRpb25fb3V0LCB0cnVzdGVkLCB1cGRhdGVfYXdhaXRfYmxvY2tfYnJhbmNoLCB1cGRhdGVfa2V5ZWRfZWFjaCwgdXBkYXRlX3Nsb3QsIHVwZGF0ZV9zbG90X2Jhc2UsIHZhbGlkYXRlX2NvbXBvbmVudCwgdmFsaWRhdGVfZWFjaF9hcmd1bWVudCwgdmFsaWRhdGVfZWFjaF9rZXlzLCB2YWxpZGF0ZV9zbG90cywgdmFsaWRhdGVfc3RvcmUsIHhsaW5rX2F0dHIgfTtcbiIsIi8vIGltcG9ydCB7IFNWTSB9IGZyb20gXCJsaWJzdm0tanNcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByYW5nZShuKSB7XHJcbiAgcmV0dXJuIEFycmF5KG4pXHJcbiAgICAuZmlsbCgpXHJcbiAgICAubWFwKChfLCBpKSA9PiBpKTtcclxufVxyXG5cclxuLy8gZXhwb3J0IGZ1bmN0aW9uIHZtaW4oYXJyKSB7XHJcbi8vICAgcmV0dXJuIGFyci5yZWR1Y2UoKHByZXYsIGN1ciApPT4gTWF0aC5taW4oKSlcclxuLy8gfVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNxcmRpc3QocDEsIHAyKSB7XHJcbiAgbGV0IGR4ID0gcDJbMF0gLSBwMVswXSxcclxuICAgIGR5ID0gcDJbMV0gLSBwMVsxXTtcclxuICByZXR1cm4gZHggKiBkeCArIGR5ICogZHk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRNb2RlbFNoYXBlKHRoZXRhLCB4bGltLCB5bGltKSB7XHJcbiAgbGV0IHgxID0geGxpbVswXTtcclxuICBsZXQgeDIgPSB4bGltWzFdO1xyXG4gIGxldCB5MSA9ICgtdGhldGFbMl0gLSB4MSAqIHRoZXRhWzBdKSAvIHRoZXRhWzFdO1xyXG4gIGxldCB5MiA9ICgtdGhldGFbMl0gLSB4MiAqIHRoZXRhWzBdKSAvIHRoZXRhWzFdO1xyXG5cclxuICBsZXQgYmVsb3cgPSBbXSxcclxuICAgIGFib3ZlID0gW1xyXG4gICAgICBbeDEsIHlsaW1bMF1dLFxyXG4gICAgICBbeDEsIHlsaW1bMV1dLFxyXG4gICAgICBbeDIsIHlsaW1bMV1dLFxyXG4gICAgICBbeDIsIHlsaW1bMF1dLFxyXG4gICAgICBbeDEsIHlsaW1bMF1dLFxyXG4gICAgXTtcclxuXHJcbiAgaWYgKHkxID4geWxpbVsxXSAmJiB5MiA+IHlsaW1bMV0pIFthYm92ZSwgYmVsb3ddID0gW2JlbG93LCBhYm92ZV07XHJcbiAgZWxzZSB7XHJcbiAgICBiZWxvdyA9IFtcclxuICAgICAgW3gxLCB5MV0sXHJcbiAgICAgIFt4MiwgeTJdLFxyXG4gICAgICBbeDIsIE1hdGgubWluKHkxLCB5bGltWzBdKV0sXHJcbiAgICAgIFt4MSwgTWF0aC5taW4oeTEsIHlsaW1bMF0pXSxcclxuICAgICAgW3gxLCB5MV0sXHJcbiAgICBdO1xyXG5cclxuICAgIGFib3ZlID0gW1xyXG4gICAgICBbeDEsIHkxXSxcclxuICAgICAgW3gyLCB5Ml0sXHJcbiAgICAgIFt4MiwgTWF0aC5tYXgoeTEsIHlsaW1bMV0pXSxcclxuICAgICAgW3gxLCBNYXRoLm1heCh5MSwgeWxpbVsxXSldLFxyXG4gICAgICBbeDEsIHkxXSxcclxuICAgIF07XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgYm91bmRhcnk6IFtcclxuICAgICAgW3gxLCB5MV0sXHJcbiAgICAgIFt4MiwgeTJdLFxyXG4gICAgXSxcclxuICAgIGJlbG93OiBiZWxvdyxcclxuICAgIGFib3ZlOiBhYm92ZSxcclxuICB9O1xyXG59XHJcblxyXG4vLyBzaG91bGQgbW92ZSB0aGlzIGludG8ganNvbiBpbnN0ZWFkIG9mIGNvbXB1dGluZ1xyXG5leHBvcnQgZnVuY3Rpb24gYXR0YWNrU3VjY2VzcyhzdWJwb3B1bGF0aW9uLCB0aGV0YSkge1xyXG4gIHJldHVybiAwO1xyXG59XHJcblxyXG5sZXQgcm5nID0ge1xyXG4gIHN0YXRlOiAxLFxyXG4gIG06IDB4ODAwMDAwMDAsXHJcbiAgYTogMTEwMzUxNTI0NSxcclxuICBjOiAxMjM0NSxcclxufTtcclxuZnVuY3Rpb24gcmFuZG9tKCkge1xyXG4gIHJuZy5zdGF0ZSA9IChybmcuYSAqIHJuZy5zdGF0ZSArIHJuZy5jKSAlIHJuZy5tO1xyXG4gIHJldHVybiBybmcuc3RhdGUgLyAocm5nLm0gLSAxKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmFuZEdhdXNzKCkge1xyXG4gIGxldCB1ID0gMCxcclxuICAgIHYgPSAwO1xyXG4gIHdoaWxlICh1ID09PSAwKSB1ID0gcmFuZG9tKCk7XHJcbiAgd2hpbGUgKHYgPT09IDApIHYgPSByYW5kb20oKTtcclxuICByZXR1cm4gTWF0aC5zcXJ0KC0yLjAgKiBNYXRoLmxvZyh1KSkgKiBNYXRoLmNvcygyLjAgKiBNYXRoLlBJICogdik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJhbmRJbnQobikge1xyXG4gIHJldHVybiBwYXJzZUludChuICogcmFuZG9tKCkpICUgbjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VfY2xhc3NpZmljYXRpb24obl9zYW1wbGVzLCBmbGlwX3ksIGNsYXNzX3NlcCwgc2VlZCkge1xyXG4gIGxldCBYID0gW10sXHJcbiAgICB5ID0gW107XHJcblxyXG4gIHJuZy5zdGF0ZSA9IHNlZWQ7XHJcblxyXG4gIGxldCBybmRDb3JuZXIgPSBbcmFuZEludCgyKSwgcmFuZEludCgyKV07XHJcbiAgaWYgKHJuZENvcm5lciA9PSBbMSwgMV0pO1xyXG4gIFstMSwgMV0uZm9yRWFjaCgobGFiZWwpID0+IHtcclxuICAgIGxldCBbczEsIHMyXSA9IFtyYW5kb20oKSArIDAuNSwgcmFuZG9tKCkgKyAwLjVdO1xyXG4gICAgbGV0IHQgPSByYW5kR2F1c3MoKSAvIDI7XHJcbiAgICBsZXQgY2x1c3RlciA9IHJhbmdlKG5fc2FtcGxlcyAvIDIpLm1hcCgoKSA9PiB7XHJcbiAgICAgIGxldCBlID0gW1xyXG4gICAgICAgIGxhYmVsICogY2xhc3Nfc2VwICsgczEgKiByYW5kR2F1c3MoKSxcclxuICAgICAgICBsYWJlbCAqIGNsYXNzX3NlcCArIHMyICogcmFuZEdhdXNzKCksXHJcbiAgICAgIF07XHJcbiAgICAgIGVbMV0gKz0gdCAqIGVbMF07XHJcbiAgICAgIHJldHVybiBlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyOyArK2kpIHt9XHJcblxyXG4gICAgWCA9IFguY29uY2F0KGNsdXN0ZXIpO1xyXG5cclxuICAgIC8vIHkgPSB5LmNvbmNhdChyYW5nZShuX3NhbXBsZXMgLyAyKS5tYXAoKCkgPT4gbGFiZWwpKTtcclxuXHJcbiAgICB5ID0geS5jb25jYXQoXHJcbiAgICAgIHJhbmdlKG5fc2FtcGxlcyAvIDIpLm1hcCgoKSA9PiAoMiAqIHJhbmRvbSgpIDwgZmxpcF95ID8gLWxhYmVsIDogbGFiZWwpKVxyXG4gICAgKTtcclxuICB9KTtcclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCAyOyArK2kpIHtcclxuICAgIGxldCBbeE1pbiwgeE1heF0gPSBbXHJcbiAgICAgIE1hdGgubWluKC4uLlgubWFwKCh4KSA9PiB4W2ldKSksXHJcbiAgICAgIE1hdGgubWF4KC4uLlgubWFwKCh4KSA9PiB4W2ldKSksXHJcbiAgICBdO1xyXG4gICAgbGV0IHAycCA9IHhNYXggLSB4TWluO1xyXG4gICAgWCA9IFgubWFwKChlKSA9PiB7XHJcbiAgICAgIGVbaV0gPSAoZVtpXSAtIHhNaW4pIC8gcDJwO1xyXG4gICAgICByZXR1cm4gZTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbGV0IGRzZXQgPSBYLm1hcCgoZSwgaSkgPT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgeDogZSxcclxuICAgICAgeTogeVtpXSxcclxuICAgICAgc3VicG9wczogW10sXHJcbiAgICB9O1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gZHNldDtcclxufVxyXG5cclxuLy8gZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRyYWluX3N2YyhYLCB5KSB7XHJcbi8vICAgbGV0IHN2bSA9IG5ldyBTVk0oe1xyXG4vLyAgICAga2VybmVsOiBTVk0uS0VSTkVMX1RZUEVTLkxJTkVBUixcclxuLy8gICAgIHR5cGU6IFNWTS5TVk1fVFlQRVMuT05FX0NMQVNTLFxyXG4vLyAgICAgY29zdDogMSxcclxuLy8gICB9KTtcclxuXHJcbi8vICAgc3ZtLnRyYWluKFgsIHkpO1xyXG4vLyAgIHJldHVybiBzdm07XHJcbi8vIH1cclxuIiwiPHNjcmlwdD5cclxuICBpbXBvcnQgeyBvbk1vdW50IH0gZnJvbSBcInN2ZWx0ZVwiO1xyXG4gIGltcG9ydCB7IHNxcmRpc3QsIGdldE1vZGVsU2hhcGUgfSBmcm9tIFwiLi4vdXRpbC5qc1wiO1xyXG5cclxuICBleHBvcnQgbGV0IGluaXRTcEluZGV4O1xyXG4gIGV4cG9ydCBsZXQgZGF0YTtcclxuICBleHBvcnQgbGV0IGZJRDtcclxuXHJcbiAgbGV0IGNhbnZhcztcclxuICBsZXQgc3ZnO1xyXG4gIGxldCBzbGlkZXI7XHJcbiAgbGV0IHBsYXlCdXR0b247XHJcbiAgbGV0IHN0ZXBGb3J3YXJkQnV0dG9uLCBzdGVwQmFja0J1dHRvbjtcclxuXHJcbiAgbGV0IHNwX2luZGV4ID0gaW5pdFNwSW5kZXg7XHJcbiAgbGV0IGhvdmVyX2luZGV4ID0gLTE7XHJcbiAgbGV0IHBvaXNvbkluZGV4ID0gMDtcclxuICBsZXQgcG9pc29ucyA9IFtdO1xyXG4gIGxldCBuUG9pc29ucyA9IGRhdGEuYXR0YWNrc1tzcF9pbmRleF0ucG9pc29ucy5sZW5ndGg7XHJcbiAgbGV0IGZyYW1lcmF0ZSA9IE1hdGgubWF4KE1hdGgubWluKDE1LCBwYXJzZUludCgoblBvaXNvbnMgKyAxKSAvIDEwKSksIDEpO1xyXG4gIGxldCBpc1BsYXlpbmcgPSB0cnVlO1xyXG4gIGxldCB3YWl0aW5nID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0IHdpZHRoID0gNzA0O1xyXG4gIGNvbnN0IGhlaWdodCA9IDYwMDtcclxuXHJcbiAgY29uc3QgcGxheVBhdGggPSBcIk0gMCAwIEwgMTAgNSBMIDAgMTAgWlwiO1xyXG4gIGNvbnN0IHBhdXNlUGF0aCA9IFwiTSAwIDAgTCAwIDEwIEwgMyAxMCBMIDMgMCBaIE0gNiAwIEwgNiAxMCBMIDkgMTAgTCA5IDAgWlwiO1xyXG4gIGNvbnN0IHN0ZXBGb3J3YXJkUGF0aCA9IFwiTSAwIDAgTCAzIDAgTCA5IDUgTCAzIDEwIEwgMCAxMCBMIDAgMTAgTCA2IDUgTCAwIDBcIjtcclxuICBjb25zdCBzdGVwQmFja1BhdGggPSBcIk0gOSAwIEwgNiAwIEwgMCA1IEwgNiAxMCBMIDkgMTAgTCA5IDEwIEwgMyA1IEwgOSAwXCI7XHJcblxyXG4gIGNvbnN0IHJlbmRlciA9ICgpID0+IHtcclxuICAgIGxldCBkc2V0ID0gZGF0YS5kc2V0O1xyXG4gICAgY29uc3QgeFZhbHVlID0gKHApID0+IHAueFswXTtcclxuICAgIGNvbnN0IHlWYWx1ZSA9IChwKSA9PiBwLnhbMV07XHJcbiAgICBjb25zdCBnZXRDbGFzcyA9IChwKSA9PiB7XHJcbiAgICAgIGlmIChwLnN1YnBvcHMgPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgIHJldHVybiBwLnkgPT0gMSA/IFwiYmx1ZS1wb2lzb25cIiA6IFwicmVkLXBvaXNvblwiO1xyXG4gICAgICBpZiAocC5zdWJwb3BzLmluY2x1ZGVzKHNwX2luZGV4KSkgcmV0dXJuIFwidGFyZ2V0LXBvaW50XCI7XHJcbiAgICAgIGVsc2UgaWYgKHAuc3VicG9wcy5pbmNsdWRlcyhob3Zlcl9pbmRleCkpIHJldHVybiBcInNlbGVjdGVkLXBvaW50XCI7XHJcbiAgICAgIGVsc2UgaWYgKHAueSA9PSAxKSByZXR1cm4gXCJibHVlLXBvaW50XCI7XHJcbiAgICAgIGVsc2UgcmV0dXJuIFwicmVkLXBvaW50XCI7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IG1hcmdpbiA9IHsgdG9wOiA2MCwgcmlnaHQ6IDQwLCBib3R0b206IDYwLCBsZWZ0OiA0MCB9O1xyXG4gICAgY29uc3QgaW5uZXJXaWR0aCA9IHdpZHRoIC0gbWFyZ2luLmxlZnQgLSBtYXJnaW4ucmlnaHQ7XHJcbiAgICBjb25zdCBpbm5lckhlaWdodCA9IGhlaWdodCAtIG1hcmdpbi50b3AgLSBtYXJnaW4uYm90dG9tO1xyXG5cclxuICAgIGxldCBleHRlbnRYID0gZDMuZXh0ZW50KGRzZXQsIHhWYWx1ZSk7XHJcbiAgICBleHRlbnRYID0gW2V4dGVudFhbMF0gLSAwLjEsIGV4dGVudFhbMV0gKyAwLjFdO1xyXG4gICAgY29uc3QgeFNjYWxlID0gZDNcclxuICAgICAgLnNjYWxlTGluZWFyKClcclxuICAgICAgLmRvbWFpbihleHRlbnRYKVxyXG4gICAgICAucmFuZ2UoWzAsIGlubmVyV2lkdGhdKVxyXG4gICAgICAubmljZSgpO1xyXG5cclxuICAgIGxldCBleHRlbnRZID0gZDMuZXh0ZW50KGRzZXQsIHlWYWx1ZSk7XHJcbiAgICBleHRlbnRZID0gW2V4dGVudFlbMF0gLSAwLjEsIGV4dGVudFlbMV0gKyAwLjFdO1xyXG4gICAgY29uc3QgeVNjYWxlID0gZDNcclxuICAgICAgLnNjYWxlTGluZWFyKClcclxuICAgICAgLmRvbWFpbihleHRlbnRZKVxyXG4gICAgICAucmFuZ2UoW2lubmVySGVpZ2h0LCAwXSlcclxuICAgICAgLm5pY2UoKTtcclxuXHJcbiAgICBjb25zdCBzaGFkaW5nRyA9IGQzXHJcbiAgICAgIC5zZWxlY3Qoc3ZnKVxyXG4gICAgICAuYXR0cihcInBvaW50ZXItZXZlbnRzXCIsIFwibm9uZVwiKVxyXG4gICAgICAuYXBwZW5kKFwiZ1wiKVxyXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7bWFyZ2luLmxlZnR9LCR7bWFyZ2luLnRvcH0pYCk7XHJcblxyXG4gICAgY29uc3QgZHNldEcgPSBkM1xyXG4gICAgICAuc2VsZWN0KHN2ZylcclxuICAgICAgLmF0dHIoXCJwb2ludGVyLWV2ZW50c1wiLCBcIm5vbmVcIilcclxuICAgICAgLmFwcGVuZChcImdcIilcclxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0fSwke21hcmdpbi50b3B9KWApO1xyXG5cclxuICAgIGNvbnN0IHBvaXNvbkcgPSBkM1xyXG4gICAgICAuc2VsZWN0KHN2ZylcclxuICAgICAgLmF0dHIoXCJwb2ludGVyLWV2ZW50c1wiLCBcIm5vbmVcIilcclxuICAgICAgLmFwcGVuZChcImdcIilcclxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0fSwke21hcmdpbi50b3B9KWApO1xyXG5cclxuICAgIGNvbnN0IG1vZGVsRyA9IGQzXHJcbiAgICAgIC5zZWxlY3Qoc3ZnKVxyXG4gICAgICAuYXR0cihcInBvaW50ZXItZXZlbnRzXCIsIFwibm9uZVwiKVxyXG4gICAgICAuYXBwZW5kKFwiZ1wiKVxyXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7bWFyZ2luLmxlZnR9LCR7bWFyZ2luLnRvcH0pYCk7XHJcblxyXG4gICAgY29uc3QgeEF4aXMgPSBkMy5heGlzQm90dG9tKHhTY2FsZSkudGlja1NpemUoLWlubmVySGVpZ2h0KS50aWNrUGFkZGluZygxNSk7XHJcbiAgICBjb25zdCB5QXhpcyA9IGQzLmF4aXNMZWZ0KHlTY2FsZSkudGlja1NpemUoLWlubmVyV2lkdGgpLnRpY2tQYWRkaW5nKDEwKTtcclxuXHJcbiAgICBjb25zdCB5QXhpc0cgPSBkc2V0Ry5hcHBlbmQoXCJnXCIpLmNhbGwoeUF4aXMpO1xyXG5cclxuICAgIGNvbnN0IHhBeGlzRyA9IGRzZXRHXHJcbiAgICAgIC5hcHBlbmQoXCJnXCIpXHJcbiAgICAgIC5jYWxsKHhBeGlzKVxyXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKDAsJHtpbm5lckhlaWdodH0pYCk7XHJcblxyXG4gICAgbGV0IGxpbmUgPSBkM1xyXG4gICAgICAubGluZSgpXHJcbiAgICAgIC54KChkKSA9PiB4U2NhbGUoZFswXSkpXHJcbiAgICAgIC55KChkKSA9PiB5U2NhbGUoZFsxXSkpO1xyXG5cclxuICAgIG1vZGVsR1xyXG4gICAgICAuYXBwZW5kKFwiY2xpcFBhdGhcIilcclxuICAgICAgLmF0dHIoXCJpZFwiLCBgcmVjdC1jbGlwJHtmSUR9YClcclxuICAgICAgLmFwcGVuZChcInJlY3RcIilcclxuICAgICAgLmF0dHIoXCJ4XCIsIDApXHJcbiAgICAgIC5hdHRyKFwieVwiLCAwKVxyXG4gICAgICAuYXR0cihcIndpZHRoXCIsIGlubmVyV2lkdGgpXHJcbiAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGlubmVySGVpZ2h0KTtcclxuXHJcbiAgICBjb25zdCBtb2RlbF9jID0gbW9kZWxHXHJcbiAgICAgIC5hcHBlbmQoXCJsaW5lXCIpXHJcbiAgICAgIC5zdHlsZShcInN0cm9rZVwiLCBcImRhcmtncmF5XCIpXHJcbiAgICAgIC5zdHlsZShcInN0cm9rZS13aWR0aFwiLCA1KVxyXG4gICAgICAuYXR0cihcImNsaXAtcGF0aFwiLCBgdXJsKCNyZWN0LWNsaXAke2ZJRH0pYCk7XHJcblxyXG4gICAgY29uc3QgbW9kZWxfdCA9IG1vZGVsR1xyXG4gICAgICAuYXBwZW5kKFwibGluZVwiKVxyXG4gICAgICAuc3R5bGUoXCJzdHJva2VcIiwgXCJibGFja1wiKVxyXG4gICAgICAuc3R5bGUoXCJzdHJva2Utd2lkdGhcIiwgNSlcclxuICAgICAgLmF0dHIoXCJjbGlwLXBhdGhcIiwgYHVybCgjcmVjdC1jbGlwJHtmSUR9KWApO1xyXG5cclxuICAgIGNvbnN0IGJlbG93QXJlYSA9IHNoYWRpbmdHXHJcbiAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXHJcbiAgICAgIC5hdHRyKFwiY2xpcC1wYXRoXCIsIGB1cmwoI3JlY3QtY2xpcCR7ZklEfSlgKTtcclxuXHJcbiAgICBjb25zdCBhYm92ZUFyZWEgPSBzaGFkaW5nR1xyXG4gICAgICAuYXBwZW5kKFwicGF0aFwiKVxyXG4gICAgICAuYXR0cihcImNsaXAtcGF0aFwiLCBgdXJsKCNyZWN0LWNsaXAke2ZJRH0pYCk7XHJcblxyXG4gICAgbGV0IGRzZXRTY2F0dGVyID0gZHNldEdcclxuICAgICAgLnNlbGVjdEFsbChcImNpcmNsZVwiKVxyXG4gICAgICAuZGF0YShkc2V0KVxyXG4gICAgICAuZW50ZXIoKVxyXG4gICAgICAuYXBwZW5kKFwiY2lyY2xlXCIpXHJcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgZ2V0Q2xhc3MpXHJcbiAgICAgIC5hdHRyKFwiY3hcIiwgKGQpID0+IHhTY2FsZSh4VmFsdWUoZCkpKVxyXG4gICAgICAuYXR0cihcImN5XCIsIChkKSA9PiB5U2NhbGUoeVZhbHVlKGQpKSk7XHJcblxyXG4gICAgbGV0IHBvaXNvblNjYXR0ZXIgPSBwb2lzb25HLnNlbGVjdEFsbChcInBhdGhcIik7XHJcblxyXG4gICAgLy8tLS0gZmlndXJlIGludGVyYWN0aW9uIGNvbnRyb2wgLS0tLy9cclxuICAgIGNvbnN0IHVwZGF0ZUNsYXNzZXMgPSAoKSA9PiB7XHJcbiAgICAgIHBvaXNvblNjYXR0ZXIuYXR0cihcImNsYXNzXCIsIGdldENsYXNzKTtcclxuICAgICAgZHNldFNjYXR0ZXIuYXR0cihcImNsYXNzXCIsIGdldENsYXNzKTtcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgcmVzZXRTbGlkZXIgPSAoKSA9PiB7XHJcbiAgICAgIHNsaWRlci52YWx1ZSA9IHBvaXNvbkluZGV4ID0gMDtcclxuICAgICAgZDMuc2VsZWN0KHNsaWRlcikuYXR0cihcIm1heFwiLCBuUG9pc29ucyk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHBhdXNlID0gKHBhdXNlZCkgPT4ge1xyXG4gICAgICBpc1BsYXlpbmcgPSBwYXVzZWQgPT0gdW5kZWZpbmVkID8gIWlzUGxheWluZyA6IHBhdXNlZDtcclxuICAgICAgZDMuc2VsZWN0KHBsYXlCdXR0b24pXHJcbiAgICAgICAgLnNlbGVjdChcInN2Z1wiKVxyXG4gICAgICAgIC5zZWxlY3QoXCJwYXRoXCIpXHJcbiAgICAgICAgLmF0dHIoXCJkXCIsIGlzUGxheWluZyA/IHBhdXNlUGF0aCA6IHBsYXlQYXRoKTtcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgYW5pbVN0ZXBGcmFtZSA9ICgpID0+IHtcclxuICAgICAgaWYgKGlzUGxheWluZyAmJiAhd2FpdGluZykge1xyXG4gICAgICAgIHNsaWRlci52YWx1ZSA9ICgxICsgK3NsaWRlci52YWx1ZSkgJSAoblBvaXNvbnMgKyAxKTtcclxuICAgICAgICBzbGlkZXJIYW5kbGVyKGZhbHNlKTtcclxuICAgICAgICBpZiAocG9pc29uSW5kZXggPT0gblBvaXNvbnMpIHtcclxuICAgICAgICAgIHdhaXRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiAod2FpdGluZyA9IGZhbHNlKSwgMTAwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHNldFRpbWVvdXQoYW5pbVN0ZXBGcmFtZSwgMTAwMCAvIGZyYW1lcmF0ZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHVwZGF0ZU1vZGVscyA9ICgpID0+IHtcclxuICAgICAgbGV0IG1vZGVsU2hhcGU7XHJcbiAgICAgIGxldCB0aGV0YV9jID0gZGF0YS5hdHRhY2tzW3NwX2luZGV4XS5pbV9tb2RlbHNbMF07XHJcbiAgICAgIGxldCB0aGV0YV90ID0gZGF0YS5hdHRhY2tzW3NwX2luZGV4XS5pbV9tb2RlbHNbcG9pc29uSW5kZXhdO1xyXG5cclxuICAgICAgbW9kZWxTaGFwZSA9IGdldE1vZGVsU2hhcGUodGhldGFfYywgZXh0ZW50WCwgZXh0ZW50WSk7XHJcbiAgICAgIG1vZGVsX2NcclxuICAgICAgICAuYXR0cihcIngxXCIsIHhTY2FsZShtb2RlbFNoYXBlLmJvdW5kYXJ5WzBdWzBdKSlcclxuICAgICAgICAuYXR0cihcIngyXCIsIHhTY2FsZShtb2RlbFNoYXBlLmJvdW5kYXJ5WzFdWzBdKSlcclxuICAgICAgICAuYXR0cihcInkxXCIsIHlTY2FsZShtb2RlbFNoYXBlLmJvdW5kYXJ5WzBdWzFdKSlcclxuICAgICAgICAuYXR0cihcInkyXCIsIHlTY2FsZShtb2RlbFNoYXBlLmJvdW5kYXJ5WzFdWzFdKSk7XHJcblxyXG4gICAgICBtb2RlbFNoYXBlID0gZ2V0TW9kZWxTaGFwZSh0aGV0YV90LCBleHRlbnRYLCBleHRlbnRZKTtcclxuICAgICAgbW9kZWxfdFxyXG4gICAgICAgIC5hdHRyKFwieDFcIiwgeFNjYWxlKG1vZGVsU2hhcGUuYm91bmRhcnlbMF1bMF0pKVxyXG4gICAgICAgIC5hdHRyKFwieDJcIiwgeFNjYWxlKG1vZGVsU2hhcGUuYm91bmRhcnlbMV1bMF0pKVxyXG4gICAgICAgIC5hdHRyKFwieTFcIiwgeVNjYWxlKG1vZGVsU2hhcGUuYm91bmRhcnlbMF1bMV0pKVxyXG4gICAgICAgIC5hdHRyKFwieTJcIiwgeVNjYWxlKG1vZGVsU2hhcGUuYm91bmRhcnlbMV1bMV0pKTtcclxuICAgICAgYmVsb3dBcmVhXHJcbiAgICAgICAgLmF0dHIoXCJkXCIsIGxpbmUobW9kZWxTaGFwZS5iZWxvdykpXHJcbiAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCB0aGV0YV90WzFdIDwgMCA/IFwiYXJlYS1ibHVlXCIgOiBcImFyZWEtcmVkXCIpO1xyXG4gICAgICBhYm92ZUFyZWFcclxuICAgICAgICAuYXR0cihcImRcIiwgbGluZShtb2RlbFNoYXBlLmFib3ZlKSlcclxuICAgICAgICAuYXR0cihcImNsYXNzXCIsIHRoZXRhX3RbMV0gPCAwID8gXCJhcmVhLXJlZFwiIDogXCJhcmVhLWJsdWVcIik7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHVwZGF0ZURhdGEgPSAoKSA9PiB7XHJcbiAgICAgIHBvaXNvbnMuZm9yRWFjaCgoZSwgaSkgPT4gKGUuaWQgPSBpLnRvU3RyaW5nKCkpKTtcclxuICAgICAgcG9pc29uU2NhdHRlciA9IHBvaXNvbkcuc2VsZWN0QWxsKFwicGF0aFwiKS5kYXRhKHBvaXNvbnMsIChkKSA9PiBkLmlkKTtcclxuXHJcbiAgICAgIHBvaXNvblNjYXR0ZXJcclxuICAgICAgICAuZW50ZXIoKVxyXG4gICAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXHJcbiAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCAoZCkgPT4gZ2V0Q2xhc3MoZCkpXHJcbiAgICAgICAgLmF0dHIoXCJkXCIsIGQzLnN5bWJvbCgpLnR5cGUoZDMuc3ltYm9sQ3Jvc3MpLnNpemUoNjAwKSlcclxuICAgICAgICAuYXR0cihcclxuICAgICAgICAgIFwidHJhbnNmb3JtXCIsXHJcbiAgICAgICAgICAoZCkgPT4gYHRyYW5zbGF0ZSgke3hTY2FsZSh4VmFsdWUoZCkpfSwke3lTY2FsZSh5VmFsdWUoZCkpfSlgXHJcbiAgICAgICAgKVxyXG4gICAgICAgIC8vIC5hdHRyKFwiY3hcIiwgKGQpID0+IHhTY2FsZSh4VmFsdWUoZCkpKVxyXG4gICAgICAgIC8vIC5hdHRyKFwiY3lcIiwgKGQpID0+IHlTY2FsZSh5VmFsdWUoZCkpKTtcclxuICAgICAgICAudHJhbnNpdGlvbigpXHJcbiAgICAgICAgLmR1cmF0aW9uKGlzUGxheWluZyA/IDIwMCA6IDIwMClcclxuICAgICAgICAuYXR0cihcImRcIiwgZDMuc3ltYm9sKCkudHlwZShkMy5zeW1ib2xDcm9zcykuc2l6ZSgyMDApKTtcclxuICAgICAgLy8gLnRyYW5zaXRpb24oKVxyXG4gICAgICAvLyAuZHVyYXRpb24oNTAwKVxyXG4gICAgICAvLyAuYXR0cihcclxuICAgICAgLy8gICBcInRyYW5zZm9ybVwiLFxyXG4gICAgICAvLyAgIChkKSA9PlxyXG4gICAgICAvLyAgICAgYHRyYW5zbGF0ZSgke3hTY2FsZSh4VmFsdWUoZCkpfSwke3lTY2FsZSh5VmFsdWUoZCkpfSlyb3RhdGUoLTQ1KWBcclxuICAgICAgLy8gKTtcclxuXHJcbiAgICAgIHBvaXNvblNjYXR0ZXIuZXhpdCgpLnJlbW92ZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBtb3VzZW1vdmVIYW5kbGVyID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgIGxldCBbeCwgeV0gPSBkMy5wb2ludGVyKGV2ZW50KTtcclxuICAgICAgKHggLT0gbWFyZ2luLmxlZnQpLCAoeSAtPSBtYXJnaW4udG9wKTtcclxuICAgICAgW3gsIHldID0gW3hTY2FsZS5pbnZlcnQoeCksIHlTY2FsZS5pbnZlcnQoeSldO1xyXG4gICAgICBsZXQgZDtcclxuICAgICAgW2QsIGhvdmVyX2luZGV4XSA9IGRhdGEuY2x1c3Rlcl9jZW50ZXJzXHJcbiAgICAgICAgLm1hcCgocCwgaSkgPT4gW3NxcmRpc3QocCwgW3gsIHldKSwgaV0pXHJcbiAgICAgICAgLnJlZHVjZSgocHJldiwgY3VyKSA9PiAoY3VyWzBdIDwgcHJldlswXSA/IGN1ciA6IHByZXYpKTtcclxuICAgICAgaWYgKGQgPiAwLjA1KSBob3Zlcl9pbmRleCA9IC0xO1xyXG4gICAgICB1cGRhdGVDbGFzc2VzKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGNsaWNrSGFuZGxlciA9IChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoaG92ZXJfaW5kZXggIT0gLTEgJiYgaG92ZXJfaW5kZXggIT0gc3BfaW5kZXgpIHtcclxuICAgICAgICBzcF9pbmRleCA9IGhvdmVyX2luZGV4O1xyXG4gICAgICAgIG5Qb2lzb25zID0gZGF0YS5hdHRhY2tzW3NwX2luZGV4XS5wb2lzb25zLmxlbmd0aDtcclxuICAgICAgICBmcmFtZXJhdGUgPSBNYXRoLm1heChNYXRoLm1pbigxNSwgcGFyc2VJbnQoKG5Qb2lzb25zICsgMSkgLyAxMCkpLCAxKTtcclxuICAgICAgICByZXNldFNsaWRlcigpO1xyXG4gICAgICAgIHNsaWRlckhhbmRsZXIoKTtcclxuICAgICAgICB1cGRhdGVDbGFzc2VzKCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgbW91c2VvdXRIYW5kbGVyID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgIGhvdmVyX2luZGV4ID0gLTE7XHJcbiAgICAgIHVwZGF0ZUNsYXNzZXMoKTtcclxuICAgICAgdXBkYXRlTW9kZWxzKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHNsaWRlckhhbmRsZXIgPSAoaXNVc2VyKSA9PiB7XHJcbiAgICAgIGlmIChpc1VzZXIpIHBhdXNlKGZhbHNlKTtcclxuICAgICAgcG9pc29uSW5kZXggPSArc2xpZGVyLnZhbHVlO1xyXG4gICAgICBwb2lzb25zID0gZGF0YS5hdHRhY2tzW3NwX2luZGV4XS5wb2lzb25zLnNsaWNlKDAsIHBvaXNvbkluZGV4KTtcclxuICAgICAgdXBkYXRlRGF0YSgpO1xyXG4gICAgICB1cGRhdGVNb2RlbHMoKTtcclxuICAgIH07XHJcblxyXG4gICAgZDMuc2VsZWN0KGNhbnZhcylcclxuICAgICAgLm9uKFwibW91c2Vtb3ZlXCIsIG1vdXNlbW92ZUhhbmRsZXIpXHJcbiAgICAgIC5vbihcImNsaWNrXCIsIGNsaWNrSGFuZGxlcilcclxuICAgICAgLm9uKFwibW91c2VvdXRcIiwgbW91c2VvdXRIYW5kbGVyKTtcclxuXHJcbiAgICBkMy5zZWxlY3Qoc2xpZGVyKVxyXG4gICAgICAuYXR0cihcIm1heFwiLCBuUG9pc29ucylcclxuICAgICAgLm9uKFwiaW5wdXRcIiwgKCkgPT4gc2xpZGVySGFuZGxlcih0cnVlKSk7XHJcblxyXG4gICAgZDMuc2VsZWN0KHBsYXlCdXR0b24pLm9uKFwiY2xpY2tcIiwgcGF1c2UpO1xyXG4gICAgZDMuc2VsZWN0KHN0ZXBGb3J3YXJkQnV0dG9uKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgc2xpZGVyLnZhbHVlID0gTWF0aC5taW4oK3NsaWRlci52YWx1ZSArIDEsIG5Qb2lzb25zKTtcclxuICAgICAgc2xpZGVySGFuZGxlcih0cnVlKTtcclxuICAgIH0pO1xyXG4gICAgZDMuc2VsZWN0KHN0ZXBCYWNrQnV0dG9uKS5vbihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgc2xpZGVyLnZhbHVlID0gTWF0aC5tYXgoK3NsaWRlci52YWx1ZSAtIDEsIDApO1xyXG4gICAgICBzbGlkZXJIYW5kbGVyKHRydWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdXBkYXRlRGF0YSgpO1xyXG4gICAgdXBkYXRlRGF0YSgpOyAvLyBwcm9iYWJseSBhIGJ1ZyBzb21ld2hlcmUsIGJ1dCBuZWVkIHRvIGRvIHRoaXMgdHdpY2UgZm9yIGhpZ2hsaWdodGluZyBzdWJwb3BzIHRvIHdvcmsgZm9yIHNvbWUgcmVhc29uXHJcbiAgICB1cGRhdGVNb2RlbHMoKTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KGFuaW1TdGVwRnJhbWUsIDEwMDAgLyBmcmFtZXJhdGUpO1xyXG4gIH07XHJcblxyXG4gIG9uTW91bnQoKCkgPT4ge1xyXG4gICAgcmVuZGVyKCk7XHJcbiAgfSk7XHJcbjwvc2NyaXB0PlxyXG5cclxuPHN2ZyBiaW5kOnRoaXM9e3N2Z30ge3dpZHRofSB7aGVpZ2h0fSBjbGFzcz1cIm92ZXJsYXlcIj5cclxuICA8dGV4dCB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIHg9XCI1MCVcIiB5PVwiOTklXCJcclxuICAgID57cG9pc29uSW5kZXh9IC8ge25Qb2lzb25zfSBQb2lzb25zPC90ZXh0XHJcbiAgPjwvc3ZnXHJcbj5cclxuPGNhbnZhcyBiaW5kOnRoaXM9e2NhbnZhc30ge3dpZHRofSB7aGVpZ2h0fSAvPlxyXG48YnV0dG9uXHJcbiAgYmluZDp0aGlzPXtwbGF5QnV0dG9ufVxyXG4gIGNsYXNzPVwiYnV0dG9uIHBsYXktYnV0dG9uXCJcclxuICBzdHlsZT1cImN1cnNvcjogcG9pbnRlclwiXHJcbj5cclxuICA8c3ZnIHdpZHRoPVwiMTBcIiBoZWlnaHQ9XCIxMFwiIHZpZXdCb3g9XCIwIDAgMTAgMTBcIj5cclxuICAgIDxwYXRoIGQ9e3BhdXNlUGF0aH0gZmlsbD1cIiM4ODhcIiAvPlxyXG4gIDwvc3ZnPlxyXG48L2J1dHRvbj5cclxuPGJ1dHRvblxyXG4gIGJpbmQ6dGhpcz17c3RlcEZvcndhcmRCdXR0b259XHJcbiAgY2xhc3M9XCJidXR0b24gc3RlcC1mb3J3YXJkLWJ1dHRvblwiXHJcbiAgc3R5bGU9XCJjdXJzb3I6IHBvaW50ZXJcIlxyXG4+XHJcbiAgPHN2ZyB3aWR0aD1cIjEwXCIgaGVpZ2h0PVwiMTBcIiB2aWV3Qm94PVwiMCAwIDEwIDEwXCI+XHJcbiAgICA8cGF0aCBkPXtzdGVwRm9yd2FyZFBhdGh9IGZpbGw9XCIjODg4XCIgLz5cclxuICA8L3N2Zz5cclxuPC9idXR0b24+XHJcbjxidXR0b25cclxuICBiaW5kOnRoaXM9e3N0ZXBCYWNrQnV0dG9ufVxyXG4gIGNsYXNzPVwiYnV0dG9uIHN0ZXAtYmFjay1idXR0b25cIlxyXG4gIHN0eWxlPVwiY3Vyc29yOiBwb2ludGVyXCJcclxuPlxyXG4gIDxzdmcgd2lkdGg9XCIxMFwiIGhlaWdodD1cIjEwXCIgdmlld0JveD1cIjAgMCAxMCAxMFwiPlxyXG4gICAgPHBhdGggZD17c3RlcEJhY2tQYXRofSBmaWxsPVwiIzg4OFwiIC8+XHJcbiAgPC9zdmc+XHJcbjwvYnV0dG9uPlxyXG48aW5wdXRcclxuICBiaW5kOnRoaXM9e3NsaWRlcn1cclxuICB0eXBlPVwicmFuZ2VcIlxyXG4gIGNsYXNzPVwic2xpZGVyIGF0dGFjay1zbGlkZXJcIlxyXG4gIG1pbj1cIjBcIlxyXG4gIG1heD1cIjFcIlxyXG4gIHZhbHVlPVwiMFwiXHJcbi8+XHJcbiIsIjxzY3JpcHQ+XHJcbiAgaW1wb3J0IHsgb25Nb3VudCB9IGZyb20gXCJzdmVsdGVcIjtcclxuICAvLyBpbXBvcnQgeyBTVk0gfSBmcm9tIFwibGlic3ZtLWpzXCI7XHJcbiAgaW1wb3J0IHsgbWFrZV9jbGFzc2lmaWNhdGlvbiwgZ2V0TW9kZWxTaGFwZSB9IGZyb20gXCIuLi91dGlsLmpzXCI7XHJcblxyXG4gIGV4cG9ydCBsZXQgZklEO1xyXG4gIGV4cG9ydCBsZXQgY29udHJvbHM7XHJcblxyXG4gIGxldCBjYW52YXM7XHJcbiAgbGV0IHN2ZztcclxuICBsZXQgcmVzZXRCdXR0b247XHJcbiAgbGV0IGFscGhhU2xpZGVyO1xyXG4gIGxldCBiZXRhU2xpZGVyO1xyXG4gIGxldCBzZWVkU2xpZGVyO1xyXG4gIGxldCBhbHBoYVRleHQ7XHJcbiAgbGV0IGJldGFUZXh0O1xyXG4gIGxldCBzZWVkVGV4dDtcclxuXHJcbiAgbGV0IGZsaXBfeSA9IDAuMDtcclxuICBsZXQgY2xhc3Nfc2VwID0gMS4wO1xyXG4gIGxldCBzZWVkID0gMTtcclxuICBjb25zdCBuX3NhbXBsZXMgPSAxMjg7XHJcblxyXG4gIGxldCBkc2V0ID0gbWFrZV9jbGFzc2lmaWNhdGlvbihuX3NhbXBsZXMsIGZsaXBfeSwgY2xhc3Nfc2VwLCBzZWVkKTtcclxuICBsZXQgc3ZtO1xyXG4gIGxldCBzcF9pbmRleCA9IDA7XHJcbiAgbGV0IGhvdmVyX2luZGV4ID0gLTE7XHJcbiAgbGV0IGFjdGlvbiA9IFwiYWRkXCI7XHJcbiAgbGV0IHBvaXNvbkxhYmVsID0gMTtcclxuXHJcbiAgbGV0IHBvaXNvbnMgPSBbXTtcclxuICBsZXQgcHJldmlld1BvaXNvbiA9IFtdO1xyXG5cclxuICBjb25zdCB3aWR0aCA9IDk4NDtcclxuICBjb25zdCBoZWlnaHQgPSA0NTA7XHJcblxyXG4gIGNvbnN0IHJlc2V0UGF0aCA9IFwiTSAwIDBcIjtcclxuXHJcbiAgY29uc3QgcmVuZGVyID0gKCkgPT4ge1xyXG4gICAgY29uc3QgeFZhbHVlID0gKHApID0+IHAueFswXTtcclxuICAgIGNvbnN0IHlWYWx1ZSA9IChwKSA9PiBwLnhbMV07XHJcbiAgICBjb25zdCBnZXRDbGFzcyA9IChwKSA9PiB7XHJcbiAgICAgIGlmIChwLnN1YnBvcHMgPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgIHJldHVybiBwLnkgPT0gMSA/IFwiYmx1ZS1wb2lzb25cIiA6IFwicmVkLXBvaXNvblwiO1xyXG4gICAgICBpZiAocC5zdWJwb3BzLmluY2x1ZGVzKHNwX2luZGV4KSkgcmV0dXJuIFwidGFyZ2V0LXBvaW50XCI7XHJcbiAgICAgIGVsc2UgaWYgKHAuc3VicG9wcy5pbmNsdWRlcyhob3Zlcl9pbmRleCkpIHJldHVybiBcInNlbGVjdGVkLXBvaW50XCI7XHJcbiAgICAgIGVsc2UgaWYgKHAueSA9PSAxKSByZXR1cm4gXCJibHVlLXBvaW50XCI7XHJcbiAgICAgIGVsc2UgcmV0dXJuIFwicmVkLXBvaW50XCI7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IG1hcmdpbiA9IHsgdG9wOiA1LCByaWdodDogNDAsIGJvdHRvbTogMTUwLCBsZWZ0OiA0MCB9O1xyXG4gICAgY29uc3QgaW5uZXJXaWR0aCA9IHdpZHRoIC0gbWFyZ2luLmxlZnQgLSBtYXJnaW4ucmlnaHQ7XHJcbiAgICBjb25zdCBpbm5lckhlaWdodCA9IGhlaWdodCAtIG1hcmdpbi50b3AgLSBtYXJnaW4uYm90dG9tO1xyXG5cclxuICAgIGxldCBleHRlbnRYID0gWzAuMCwgMS4wXTtcclxuICAgIGxldCBleHRlbnRYUGFkID0gW2V4dGVudFhbMF0gLSAwLjEsIGV4dGVudFhbMV0gKyAwLjFdO1xyXG4gICAgY29uc3QgeFNjYWxlID0gZDNcclxuICAgICAgLnNjYWxlTGluZWFyKClcclxuICAgICAgLmRvbWFpbihleHRlbnRYUGFkKVxyXG4gICAgICAucmFuZ2UoWzAsIGlubmVyV2lkdGhdKVxyXG4gICAgICAubmljZSgpO1xyXG5cclxuICAgIGxldCBleHRlbnRZID0gWy0wLjAsIDEuMF07XHJcbiAgICBsZXQgZXh0ZW50WVBhZCA9IFtleHRlbnRZWzBdIC0gMC4xLCBleHRlbnRZWzFdICsgMC4xXTtcclxuICAgIGNvbnN0IHlTY2FsZSA9IGQzXHJcbiAgICAgIC5zY2FsZUxpbmVhcigpXHJcbiAgICAgIC5kb21haW4oZXh0ZW50WVBhZClcclxuICAgICAgLnJhbmdlKFtpbm5lckhlaWdodCwgMF0pXHJcbiAgICAgIC5uaWNlKCk7XHJcblxyXG4gICAgY29uc3Qgc2hhZGluZ0cgPSBkM1xyXG4gICAgICAuc2VsZWN0KHN2ZylcclxuICAgICAgLmF0dHIoXCJwb2ludGVyLWV2ZW50c1wiLCBcIm5vbmVcIilcclxuICAgICAgLmFwcGVuZChcImdcIilcclxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0fSwke21hcmdpbi50b3B9KWApO1xyXG5cclxuICAgIGNvbnN0IGRzZXRHID0gZDNcclxuICAgICAgLnNlbGVjdChzdmcpXHJcbiAgICAgIC5hdHRyKFwicG9pbnRlci1ldmVudHNcIiwgXCJub25lXCIpXHJcbiAgICAgIC5hcHBlbmQoXCJnXCIpXHJcbiAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdH0sJHttYXJnaW4udG9wfSlgKTtcclxuXHJcbiAgICBjb25zdCBwb2lzb25HID0gZDNcclxuICAgICAgLnNlbGVjdChzdmcpXHJcbiAgICAgIC5hdHRyKFwicG9pbnRlci1ldmVudHNcIiwgXCJub25lXCIpXHJcbiAgICAgIC5hcHBlbmQoXCJnXCIpXHJcbiAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdH0sJHttYXJnaW4udG9wfSlgKTtcclxuXHJcbiAgICBjb25zdCBwcmV2aWV3UG9pc29uRyA9IGQzXHJcbiAgICAgIC5zZWxlY3Qoc3ZnKVxyXG4gICAgICAuYXR0cihcInBvaW50ZXItZXZlbnRzXCIsIFwibm9uZVwiKVxyXG4gICAgICAuYXBwZW5kKFwiZ1wiKVxyXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7bWFyZ2luLmxlZnR9LCR7bWFyZ2luLnRvcH0pYCk7XHJcblxyXG4gICAgY29uc3QgbW9kZWxHID0gZDNcclxuICAgICAgLnNlbGVjdChzdmcpXHJcbiAgICAgIC5hdHRyKFwicG9pbnRlci1ldmVudHNcIiwgXCJub25lXCIpXHJcbiAgICAgIC5hcHBlbmQoXCJnXCIpXHJcbiAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdH0sJHttYXJnaW4udG9wfSlgKTtcclxuXHJcbiAgICBjb25zdCB4QXhpcyA9IGQzLmF4aXNCb3R0b20oeFNjYWxlKS50aWNrU2l6ZSgtaW5uZXJIZWlnaHQpLnRpY2tQYWRkaW5nKDE1KTtcclxuICAgIGNvbnN0IHlBeGlzID0gZDMuYXhpc0xlZnQoeVNjYWxlKS50aWNrU2l6ZSgtaW5uZXJXaWR0aCkudGlja1BhZGRpbmcoMTApO1xyXG5cclxuICAgIGNvbnN0IHlBeGlzRyA9IGRzZXRHLmFwcGVuZChcImdcIikuY2FsbCh5QXhpcyk7XHJcblxyXG4gICAgY29uc3QgeEF4aXNHID0gZHNldEdcclxuICAgICAgLmFwcGVuZChcImdcIilcclxuICAgICAgLmNhbGwoeEF4aXMpXHJcbiAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoMCwke2lubmVySGVpZ2h0fSlgKTtcclxuXHJcbiAgICBsZXQgbGluZSA9IGQzXHJcbiAgICAgIC5saW5lKClcclxuICAgICAgLngoKGQpID0+IHhTY2FsZShkWzBdKSlcclxuICAgICAgLnkoKGQpID0+IHlTY2FsZShkWzFdKSk7XHJcblxyXG4gICAgbW9kZWxHXHJcbiAgICAgIC5hcHBlbmQoXCJjbGlwUGF0aFwiKVxyXG4gICAgICAuYXR0cihcImlkXCIsIGByZWN0LWNsaXAke2ZJRH1gKVxyXG4gICAgICAuYXBwZW5kKFwicmVjdFwiKVxyXG4gICAgICAuYXR0cihcInhcIiwgMClcclxuICAgICAgLmF0dHIoXCJ5XCIsIDApXHJcbiAgICAgIC5hdHRyKFwid2lkdGhcIiwgaW5uZXJXaWR0aClcclxuICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgaW5uZXJIZWlnaHQpO1xyXG5cclxuICAgIGNvbnN0IG1vZGVsX2MgPSBtb2RlbEdcclxuICAgICAgLmFwcGVuZChcImxpbmVcIilcclxuICAgICAgLnN0eWxlKFwic3Ryb2tlXCIsIFwiZGFya2dyYXlcIilcclxuICAgICAgLnN0eWxlKFwic3Ryb2tlLXdpZHRoXCIsIDUpXHJcbiAgICAgIC5hdHRyKFwiY2xpcC1wYXRoXCIsIGB1cmwoI3JlY3QtY2xpcCR7ZklEfSlgKTtcclxuXHJcbiAgICBjb25zdCBtb2RlbF90ID0gbW9kZWxHXHJcbiAgICAgIC5hcHBlbmQoXCJsaW5lXCIpXHJcbiAgICAgIC5zdHlsZShcInN0cm9rZVwiLCBcImJsYWNrXCIpXHJcbiAgICAgIC5zdHlsZShcInN0cm9rZS13aWR0aFwiLCA1KVxyXG4gICAgICAuYXR0cihcImNsaXAtcGF0aFwiLCBgdXJsKCNyZWN0LWNsaXAke2ZJRH0pYCk7XHJcblxyXG4gICAgY29uc3QgYmVsb3dBcmVhID0gc2hhZGluZ0dcclxuICAgICAgLmFwcGVuZChcInBhdGhcIilcclxuICAgICAgLmF0dHIoXCJjbGlwLXBhdGhcIiwgYHVybCgjcmVjdC1jbGlwJHtmSUR9KWApO1xyXG5cclxuICAgIGNvbnN0IGFib3ZlQXJlYSA9IHNoYWRpbmdHXHJcbiAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXHJcbiAgICAgIC5hdHRyKFwiY2xpcC1wYXRoXCIsIGB1cmwoI3JlY3QtY2xpcCR7ZklEfSlgKTtcclxuXHJcbiAgICBsZXQgZHNldFNjYXR0ZXIgPSBkc2V0R1xyXG4gICAgICAuc2VsZWN0QWxsKFwiY2lyY2xlXCIpXHJcbiAgICAgIC5kYXRhKGRzZXQpXHJcbiAgICAgIC5lbnRlcigpXHJcbiAgICAgIC5hcHBlbmQoXCJjaXJjbGVcIilcclxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBnZXRDbGFzcylcclxuICAgICAgLmF0dHIoXCJjeFwiLCAoZCkgPT4geFNjYWxlKHhWYWx1ZShkKSkpXHJcbiAgICAgIC5hdHRyKFwiY3lcIiwgKGQpID0+IHlTY2FsZSh5VmFsdWUoZCkpKTtcclxuXHJcbiAgICBsZXQgcG9pc29uU2NhdHRlciA9IHBvaXNvbkcuc2VsZWN0QWxsKFwicGF0aFwiKTtcclxuICAgIGxldCBwcmV2aWV3UG9pc29uU2NhdHRlciA9IHByZXZpZXdQb2lzb25HLnNlbGVjdEFsbChcInBhdGhcIik7XHJcblxyXG4gICAgYWxwaGFTbGlkZXIgPSBkMy5zZWxlY3QoY29udHJvbHMpLnNlbGVjdChcIiNhbHBoYVNsaWRlclwiKTtcclxuICAgIGJldGFTbGlkZXIgPSBkMy5zZWxlY3QoY29udHJvbHMpLnNlbGVjdChcIiNiZXRhU2xpZGVyXCIpO1xyXG4gICAgc2VlZFNsaWRlciA9IGQzLnNlbGVjdChjb250cm9scykuc2VsZWN0KFwiI3NlZWRTbGlkZXJcIik7XHJcblxyXG4gICAgYWxwaGFUZXh0ID0gZDMuc2VsZWN0KGNvbnRyb2xzKS5zZWxlY3RBbGwoXCJzdmdcIikuc2VsZWN0KFwiI2FscGhhVGV4dFwiKTtcclxuICAgIGJldGFUZXh0ID0gZDMuc2VsZWN0KGNvbnRyb2xzKS5zZWxlY3RBbGwoXCJzdmdcIikuc2VsZWN0KFwiI2JldGFUZXh0XCIpO1xyXG4gICAgc2VlZFRleHQgPSBkMy5zZWxlY3QoY29udHJvbHMpLnNlbGVjdEFsbChcInN2Z1wiKS5zZWxlY3QoXCIjc2VlZFRleHRcIik7XHJcblxyXG4gICAgLy8tLS0gZmlndXJlIGludGVyYWN0aW9uIGNvbnRyb2wgLS0tLy9cclxuICAgIGNvbnN0IHVwZGF0ZUNsYXNzZXMgPSAoKSA9PiB7XHJcbiAgICAgIHBvaXNvblNjYXR0ZXIuYXR0cihcImNsYXNzXCIsIGdldENsYXNzKTtcclxuICAgICAgZHNldFNjYXR0ZXIuYXR0cihcImNsYXNzXCIsIGdldENsYXNzKTtcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgcmVzZXRQb2lzb25zID0gKCkgPT4ge1xyXG4gICAgICBwb2lzb25zID0gW107XHJcbiAgICAgIHBvaXNvblNjYXR0ZXIgPSBwb2lzb25HLnNlbGVjdEFsbChcInBhdGhcIikuZGF0YShwb2lzb25zKS5leGl0KCkucmVtb3ZlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIGNvbnN0IHVwZGF0ZU1vZGVscyA9ICgpID0+IHtcclxuICAgIC8vICAgbGV0IG1vZGVsU2hhcGU7XHJcbiAgICAvLyAgIGxldCB0aGV0YV9jID0gZGF0YS5hdHRhY2tzW3NwX2luZGV4XS5pbV9tb2RlbHNbMF07XHJcbiAgICAvLyAgIGxldCB0aGV0YV90ID0gZGF0YS5hdHRhY2tzW3NwX2luZGV4XS5pbV9tb2RlbHNbcG9pc29uSW5kZXhdO1xyXG5cclxuICAgIC8vICAgbW9kZWxTaGFwZSA9IGdldE1vZGVsU2hhcGUodGhldGFfYywgZXh0ZW50WCwgZXh0ZW50WSk7XHJcbiAgICAvLyAgIG1vZGVsX2NcclxuICAgIC8vICAgICAuYXR0cihcIngxXCIsIHhTY2FsZShtb2RlbFNoYXBlLmJvdW5kYXJ5WzBdWzBdKSlcclxuICAgIC8vICAgICAuYXR0cihcIngyXCIsIHhTY2FsZShtb2RlbFNoYXBlLmJvdW5kYXJ5WzFdWzBdKSlcclxuICAgIC8vICAgICAuYXR0cihcInkxXCIsIHlTY2FsZShtb2RlbFNoYXBlLmJvdW5kYXJ5WzBdWzFdKSlcclxuICAgIC8vICAgICAuYXR0cihcInkyXCIsIHlTY2FsZShtb2RlbFNoYXBlLmJvdW5kYXJ5WzFdWzFdKSk7XHJcblxyXG4gICAgLy8gICBtb2RlbFNoYXBlID0gZ2V0TW9kZWxTaGFwZSh0aGV0YV90LCBleHRlbnRYLCBleHRlbnRZKTtcclxuICAgIC8vICAgbW9kZWxfdFxyXG4gICAgLy8gICAgIC5hdHRyKFwieDFcIiwgeFNjYWxlKG1vZGVsU2hhcGUuYm91bmRhcnlbMF1bMF0pKVxyXG4gICAgLy8gICAgIC5hdHRyKFwieDJcIiwgeFNjYWxlKG1vZGVsU2hhcGUuYm91bmRhcnlbMV1bMF0pKVxyXG4gICAgLy8gICAgIC5hdHRyKFwieTFcIiwgeVNjYWxlKG1vZGVsU2hhcGUuYm91bmRhcnlbMF1bMV0pKVxyXG4gICAgLy8gICAgIC5hdHRyKFwieTJcIiwgeVNjYWxlKG1vZGVsU2hhcGUuYm91bmRhcnlbMV1bMV0pKTtcclxuICAgIC8vICAgYmVsb3dBcmVhXHJcbiAgICAvLyAgICAgLmF0dHIoXCJkXCIsIGxpbmUobW9kZWxTaGFwZS5iZWxvdykpXHJcbiAgICAvLyAgICAgLmF0dHIoXCJjbGFzc1wiLCB0aGV0YV90WzFdIDwgMCA/IFwiYXJlYS1ibHVlXCIgOiBcImFyZWEtcmVkXCIpO1xyXG4gICAgLy8gICBhYm92ZUFyZWFcclxuICAgIC8vICAgICAuYXR0cihcImRcIiwgbGluZShtb2RlbFNoYXBlLmFib3ZlKSlcclxuICAgIC8vICAgICAuYXR0cihcImNsYXNzXCIsIHRoZXRhX3RbMV0gPCAwID8gXCJhcmVhLXJlZFwiIDogXCJhcmVhLWJsdWVcIik7XHJcbiAgICAvLyB9O1xyXG5cclxuICAgIGNvbnN0IG1vdXNlbW92ZUhhbmRsZXIgPSAoZXZlbnQpID0+IHtcclxuICAgICAgbGV0IFt4LCB5XSA9IGQzLnBvaW50ZXIoZXZlbnQpO1xyXG4gICAgICAoeCAtPSBtYXJnaW4ubGVmdCksICh5IC09IG1hcmdpbi50b3ApO1xyXG4gICAgICBbeCwgeV0gPSBbeFNjYWxlLmludmVydCh4KSwgeVNjYWxlLmludmVydCh5KV07XHJcbiAgICAgIGxldCBwb2lzb24gPSBbeCwgeV07XHJcblxyXG4gICAgICBzd2l0Y2ggKGFjdGlvbikge1xyXG4gICAgICAgIGNhc2UgXCJhZGRcIjpcclxuICAgICAgICAgIHByZXZpZXdQb2lzb24gPVxyXG4gICAgICAgICAgICB4ID49IGV4dGVudFhbMF0gJiZcclxuICAgICAgICAgICAgeCA8PSBleHRlbnRYWzFdICYmXHJcbiAgICAgICAgICAgIHkgPj0gZXh0ZW50WVswXSAmJlxyXG4gICAgICAgICAgICB5IDw9IGV4dGVudFlbMV1cclxuICAgICAgICAgICAgICA/IFtcclxuICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHBvaXNvbixcclxuICAgICAgICAgICAgICAgICAgICB5OiBwb2lzb25MYWJlbCxcclxuICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgICA6IFtdO1xyXG4gICAgICAgICAgcHJldmlld1BvaXNvblNjYXR0ZXIgPSBwcmV2aWV3UG9pc29uR1xyXG4gICAgICAgICAgICAuc2VsZWN0QWxsKFwicGF0aFwiKVxyXG4gICAgICAgICAgICAuZGF0YShwcmV2aWV3UG9pc29uKTtcclxuXHJcbiAgICAgICAgICBwcmV2aWV3UG9pc29uU2NhdHRlci5leGl0KCkucmVtb3ZlKCk7XHJcblxyXG4gICAgICAgICAgcHJldmlld1BvaXNvblNjYXR0ZXJcclxuICAgICAgICAgICAgLmF0dHIoXCJkXCIsIGQzLnN5bWJvbCgpLnR5cGUoZDMuc3ltYm9sQ3Jvc3MpLnNpemUoMjAwKSlcclxuICAgICAgICAgICAgLmF0dHIoXHJcbiAgICAgICAgICAgICAgXCJ0cmFuc2Zvcm1cIixcclxuICAgICAgICAgICAgICAoZCkgPT4gYHRyYW5zbGF0ZSgke3hTY2FsZSh4VmFsdWUoZCkpfSwke3lTY2FsZSh5VmFsdWUoZCkpfSlgXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgLmVudGVyKClcclxuICAgICAgICAgICAgLmFwcGVuZChcInBhdGhcIilcclxuICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBnZXRDbGFzcylcclxuICAgICAgICAgICAgLmF0dHIoXCJkXCIsIGQzLnN5bWJvbCgpLnR5cGUoZDMuc3ltYm9sQ3Jvc3MpLnNpemUoMjAwKSlcclxuICAgICAgICAgICAgLmF0dHIoXHJcbiAgICAgICAgICAgICAgXCJ0cmFuc2Zvcm1cIixcclxuICAgICAgICAgICAgICAoZCkgPT4gYHRyYW5zbGF0ZSgke3hTY2FsZSh4VmFsdWUoZCkpfSwke3lTY2FsZSh5VmFsdWUoZCkpfSlgXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICB1cGRhdGVDbGFzc2VzKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGNsaWNrSGFuZGxlciA9IChldmVudCkgPT4ge1xyXG4gICAgICBsZXQgW3gsIHldID0gZDMucG9pbnRlcihldmVudCk7XHJcbiAgICAgICh4IC09IG1hcmdpbi5sZWZ0KSwgKHkgLT0gbWFyZ2luLnRvcCk7XHJcbiAgICAgIFt4LCB5XSA9IFt4U2NhbGUuaW52ZXJ0KHgpLCB5U2NhbGUuaW52ZXJ0KHkpXTtcclxuICAgICAgbGV0IHBvaXNvbiA9IFt4LCB5XTtcclxuXHJcbiAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XHJcbiAgICAgICAgY2FzZSBcImFkZFwiOlxyXG4gICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICB4ID49IGV4dGVudFhbMF0gJiZcclxuICAgICAgICAgICAgeCA8PSBleHRlbnRYWzFdICYmXHJcbiAgICAgICAgICAgIHkgPj0gZXh0ZW50WVswXSAmJlxyXG4gICAgICAgICAgICB5IDw9IGV4dGVudFlbMV1cclxuICAgICAgICAgICkge1xyXG4gICAgICAgICAgICBwb2lzb25zLnB1c2goe1xyXG4gICAgICAgICAgICAgIHg6IHBvaXNvbixcclxuICAgICAgICAgICAgICB5OiBwb2lzb25MYWJlbCxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHBvaXNvblNjYXR0ZXIgPSBwb2lzb25HLnNlbGVjdEFsbChcInBhdGhcIikuZGF0YShwb2lzb25zKTtcclxuICAgICAgICAgICAgcG9pc29uU2NhdHRlclxyXG4gICAgICAgICAgICAgIC5lbnRlcigpXHJcbiAgICAgICAgICAgICAgLmFwcGVuZChcInBhdGhcIilcclxuICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIGdldENsYXNzKVxyXG4gICAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBkMy5zeW1ib2woKS50eXBlKGQzLnN5bWJvbENyb3NzKS5zaXplKDIwMCkpXHJcbiAgICAgICAgICAgICAgLmF0dHIoXHJcbiAgICAgICAgICAgICAgICBcInRyYW5zZm9ybVwiLFxyXG4gICAgICAgICAgICAgICAgKGQpID0+IGB0cmFuc2xhdGUoJHt4U2NhbGUoeFZhbHVlKGQpKX0sJHt5U2NhbGUoeVZhbHVlKGQpKX0pYFxyXG4gICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc29sZS5sb2cocG9pc29ucyk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IG1vdXNlb3V0SGFuZGxlciA9IChldmVudCkgPT4ge1xyXG4gICAgICBob3Zlcl9pbmRleCA9IC0xO1xyXG4gICAgICB1cGRhdGVDbGFzc2VzKCk7XHJcblxyXG4gICAgICBwcmV2aWV3UG9pc29uU2NhdHRlci5kYXRhKFtdKS5leGl0KCkucmVtb3ZlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHJlZ2VuZXJhdGVEYXRhc2V0ID0gKCkgPT4ge1xyXG4gICAgICBkc2V0ID0gbWFrZV9jbGFzc2lmaWNhdGlvbihuX3NhbXBsZXMsIGZsaXBfeSwgY2xhc3Nfc2VwLCBzZWVkKTtcclxuICAgICAgZHNldFNjYXR0ZXIgPSBkc2V0Ry5zZWxlY3RBbGwoXCJjaXJjbGVcIikuZGF0YShkc2V0KTtcclxuICAgICAgZHNldFNjYXR0ZXJcclxuICAgICAgICAuZGF0YShkc2V0KVxyXG4gICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgZ2V0Q2xhc3MpXHJcbiAgICAgICAgLnRyYW5zaXRpb24oKVxyXG4gICAgICAgIC5kdXJhdGlvbigyNTApXHJcbiAgICAgICAgLmF0dHIoXCJjeFwiLCAoZCkgPT4geFNjYWxlKHhWYWx1ZShkKSkpXHJcbiAgICAgICAgLmF0dHIoXCJjeVwiLCAoZCkgPT4geVNjYWxlKHlWYWx1ZShkKSkpO1xyXG4gICAgICBkc2V0U2NhdHRlci5leGl0KCkucmVtb3ZlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHNsaWRlckhhbmRsZXIgPSAoc2xpZGVyKSA9PiB7XHJcbiAgICAgIHN3aXRjaCAoc2xpZGVyKSB7XHJcbiAgICAgICAgY2FzZSBcImFscGhhXCI6XHJcbiAgICAgICAgICBjbGFzc19zZXAgPSAwLjI1ICogK2FscGhhU2xpZGVyLm5vZGUoKS52YWx1ZTtcclxuICAgICAgICAgIGFscGhhVGV4dC50ZXh0KGBDbGFzcyBTZXBhcmF0aW9uIM6xID0gJHtjbGFzc19zZXAudG9GaXhlZCgyKX1gKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJiZXRhXCI6XHJcbiAgICAgICAgICBmbGlwX3kgPSAwLjEgKiArYmV0YVNsaWRlci5ub2RlKCkudmFsdWU7XHJcbiAgICAgICAgICBiZXRhVGV4dC50ZXh0KGBSYW5kb20gTGFiZWwgRnJhY3Rpb24gzrIgPSAke2ZsaXBfeS50b0ZpeGVkKDIpfWApO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcInNlZWRcIjpcclxuICAgICAgICAgIHNlZWQgPSArc2VlZFNsaWRlci5ub2RlKCkudmFsdWU7XHJcbiAgICAgICAgICBzZWVkVGV4dC50ZXh0KGBEYXRhc2V0IFNlZWQgcyA9ICR7c2VlZH1gKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIHJlZ2VuZXJhdGVEYXRhc2V0KCk7XHJcbiAgICAgIC8vIHJlc2V0UG9pc29ucygpO1xyXG4gICAgfTtcclxuXHJcbiAgICBkMy5zZWxlY3QoY2FudmFzKVxyXG4gICAgICAub24oXCJtb3VzZW1vdmVcIiwgbW91c2Vtb3ZlSGFuZGxlcilcclxuICAgICAgLm9uKFwiY2xpY2tcIiwgY2xpY2tIYW5kbGVyKVxyXG4gICAgICAub24oXCJtb3VzZW91dFwiLCBtb3VzZW91dEhhbmRsZXIpO1xyXG5cclxuICAgIGFscGhhU2xpZGVyLm9uKFwiaW5wdXRcIiwgKCkgPT4gc2xpZGVySGFuZGxlcihcImFscGhhXCIpKTtcclxuICAgIGJldGFTbGlkZXIub24oXCJpbnB1dFwiLCAoKSA9PiBzbGlkZXJIYW5kbGVyKFwiYmV0YVwiKSk7XHJcbiAgICBzZWVkU2xpZGVyLm9uKFwiY2hhbmdlXCIsICgpID0+IHNsaWRlckhhbmRsZXIoXCJzZWVkXCIpKTtcclxuICB9O1xyXG5cclxuICBvbk1vdW50KCgpID0+IHtcclxuICAgIHJlbmRlcigpO1xyXG4gIH0pO1xyXG48L3NjcmlwdD5cclxuXHJcbjxzdmcgYmluZDp0aGlzPXtzdmd9IHt3aWR0aH0ge2hlaWdodH0gY2xhc3M9XCJvdmVybGF5XCIgLz5cclxuPGNhbnZhcyBiaW5kOnRoaXM9e2NhbnZhc30ge3dpZHRofSB7aGVpZ2h0fSAvPlxyXG4iLCIvLyBIb3QgcmVsb2FkaW5nXHJcbi8vIGltcG9ydCAqIGFzIF91bnVzZWQgZnJvbSBcInJhdy1sb2FkZXIhLi9pbmRleC5lanNcIjtcclxuLy8gVE9ETzogZGlzYWJsZSBiZWZvcmUgcHVibGlzaGluZ1xyXG5cclxuaW1wb3J0IEF0dGFja0FuaW1hdGlvbiBmcm9tIFwiLi9kaWFncmFtcy9hdHRhY2stYW5pbWF0aW9uLnN2ZWx0ZVwiO1xyXG5pbXBvcnQgUG9pc29uRGVtbyBmcm9tIFwiLi9kaWFncmFtcy9wb2lzb25pbmctZGVtby5zdmVsdGVcIjtcclxuXHJcbmxldCBmSUQgPSAwO1xyXG5cclxue1xyXG4gIGNvbnN0IGZpZ3VyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3ZlbHRlLXBvaXNvbi1kZW1vLWRmaWd1cmVcIik7XHJcbiAgbGV0IGRlbW87XHJcbiAgZmlndXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJyZWFkeVwiLCAoKSA9PiB7XHJcbiAgICBjb25zdCB0YXJnZXQgPSBmaWd1cmUucXVlcnlTZWxlY3RvcihcIiNzdmVsdGUtZGVtby10YXJnZXRcIik7XHJcbiAgICBjb25zdCBjb250cm9scyA9IGZpZ3VyZS5xdWVyeVNlbGVjdG9yKFwiI3N2ZWx0ZS1kZW1vLWNvbnRyb2xzXCIpO1xyXG4gICAgZGVtbyA9IG5ldyBQb2lzb25EZW1vKHtcclxuICAgICAgdGFyZ2V0OiB0YXJnZXQsXHJcbiAgICAgIHByb3BzOiB7XHJcbiAgICAgICAgZklEOiBmSUQrKyxcclxuICAgICAgICBjb250cm9sczogY29udHJvbHMsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxue1xyXG4gIGNvbnN0IGZpZ3VyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3ZlbHRlLXNjYXR0ZXJwbG90LWRmaWd1cmUtZXhhbXBsZTFcIik7XHJcbiAgbGV0IHNjYXR0ZXJwbG90O1xyXG4gIGZpZ3VyZS5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xyXG4gICAgZmV0Y2goXCJodHRwczovL2VzY290dHJvc2UwMS5naXRodWIuaW8vcG9pc29uaW5nLWRhdGEvMS4wMC0wLjEtNS5qc29uXCIpXHJcbiAgICAgIC50aGVuKChyZXNwKSA9PiByZXNwLmpzb24oKSlcclxuICAgICAgLnRoZW4oKGRhdGFKc29uKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZmlndXJlLnF1ZXJ5U2VsZWN0b3IoXCIjc3ZlbHRlLXNjYXR0ZXJwbG90LXRhcmdldFwiKTtcclxuICAgICAgICBzY2F0dGVycGxvdCA9IG5ldyBBdHRhY2tBbmltYXRpb24oe1xyXG4gICAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXHJcbiAgICAgICAgICBwcm9wczoge1xyXG4gICAgICAgICAgICBkYXRhOiBkYXRhSnNvbixcclxuICAgICAgICAgICAgaW5pdFNwSW5kZXg6IDYsXHJcbiAgICAgICAgICAgIGZJRDogZklEKyssXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxue1xyXG4gIGNvbnN0IGZpZ3VyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3ZlbHRlLXNjYXR0ZXJwbG90LWRmaWd1cmUtZXhhbXBsZTJcIik7XHJcbiAgbGV0IHNjYXR0ZXJwbG90O1xyXG4gIGZpZ3VyZS5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xyXG4gICAgZmV0Y2goXCJodHRwczovL2VzY290dHJvc2UwMS5naXRodWIuaW8vcG9pc29uaW5nLWRhdGEvMi4wMC0xLjAtNC5qc29uXCIpXHJcbiAgICAgIC50aGVuKChyZXNwKSA9PiByZXNwLmpzb24oKSlcclxuICAgICAgLnRoZW4oKGRhdGFKc29uKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZmlndXJlLnF1ZXJ5U2VsZWN0b3IoXCIjc3ZlbHRlLXNjYXR0ZXJwbG90LXRhcmdldFwiKTtcclxuICAgICAgICBzY2F0dGVycGxvdCA9IG5ldyBBdHRhY2tBbmltYXRpb24oe1xyXG4gICAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXHJcbiAgICAgICAgICBwcm9wczoge1xyXG4gICAgICAgICAgICBkYXRhOiBkYXRhSnNvbixcclxuICAgICAgICAgICAgaW5pdFNwSW5kZXg6IDYsXHJcbiAgICAgICAgICAgIGZJRDogZklEKyssXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxue1xyXG4gIGNvbnN0IGZpZ3VyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3ZlbHRlLXNjYXR0ZXJwbG90LWRmaWd1cmUtZXhhbXBsZTNcIik7XHJcbiAgbGV0IHNjYXR0ZXJwbG90O1xyXG4gIGZpZ3VyZS5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xyXG4gICAgZmV0Y2goXCJodHRwczovL2VzY290dHJvc2UwMS5naXRodWIuaW8vcG9pc29uaW5nLWRhdGEvMC4wMC0wLjAtNC5qc29uXCIpXHJcbiAgICAgIC50aGVuKChyZXNwKSA9PiByZXNwLmpzb24oKSlcclxuICAgICAgLnRoZW4oKGRhdGFKc29uKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZmlndXJlLnF1ZXJ5U2VsZWN0b3IoXCIjc3ZlbHRlLXNjYXR0ZXJwbG90LXRhcmdldFwiKTtcclxuICAgICAgICBzY2F0dGVycGxvdCA9IG5ldyBBdHRhY2tBbmltYXRpb24oe1xyXG4gICAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXHJcbiAgICAgICAgICBwcm9wczoge1xyXG4gICAgICAgICAgICBkYXRhOiBkYXRhSnNvbixcclxuICAgICAgICAgICAgaW5pdFNwSW5kZXg6IDgsXHJcbiAgICAgICAgICAgIGZJRDogZklEKyssXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxue1xyXG4gIGNvbnN0IGZpZ3VyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3ZlbHRlLXNjYXR0ZXJwbG90LWRmaWd1cmUtZXhhbXBsZTRcIik7XHJcbiAgbGV0IHNjYXR0ZXJwbG90O1xyXG4gIGZpZ3VyZS5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xyXG4gICAgZmV0Y2goXCJodHRwczovL2VzY290dHJvc2UwMS5naXRodWIuaW8vcG9pc29uaW5nLWRhdGEvMi4wMC0wLjAtNC5qc29uXCIpXHJcbiAgICAgIC50aGVuKChyZXNwKSA9PiByZXNwLmpzb24oKSlcclxuICAgICAgLnRoZW4oKGRhdGFKc29uKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZmlndXJlLnF1ZXJ5U2VsZWN0b3IoXCIjc3ZlbHRlLXNjYXR0ZXJwbG90LXRhcmdldFwiKTtcclxuICAgICAgICBzY2F0dGVycGxvdCA9IG5ldyBBdHRhY2tBbmltYXRpb24oe1xyXG4gICAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXHJcbiAgICAgICAgICBwcm9wczoge1xyXG4gICAgICAgICAgICBkYXRhOiBkYXRhSnNvbixcclxuICAgICAgICAgICAgaW5pdFNwSW5kZXg6IDQsXHJcbiAgICAgICAgICAgIGZJRDogZklEKyssXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxue1xyXG4gIGNvbnN0IGZpZ3VyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3ZlbHRlLXNjYXR0ZXJwbG90LWRmaWd1cmUtZXhhbXBsZTVcIik7XHJcbiAgbGV0IHNjYXR0ZXJwbG90O1xyXG4gIGZpZ3VyZS5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xyXG4gICAgZmV0Y2goXCJodHRwczovL2VzY290dHJvc2UwMS5naXRodWIuaW8vcG9pc29uaW5nLWRhdGEvZGF0YS8yLjAwLTAuMC00Lmpzb25cIilcclxuICAgICAgLnRoZW4oKHJlc3ApID0+IHJlc3AuanNvbigpKVxyXG4gICAgICAudGhlbigoZGF0YUpzb24pID0+IHtcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSBmaWd1cmUucXVlcnlTZWxlY3RvcihcIiNzdmVsdGUtc2NhdHRlcnBsb3QtdGFyZ2V0XCIpO1xyXG4gICAgICAgIHNjYXR0ZXJwbG90ID0gbmV3IEF0dGFja0FuaW1hdGlvbih7XHJcbiAgICAgICAgICB0YXJnZXQ6IHRhcmdldCxcclxuICAgICAgICAgIHByb3BzOiB7XHJcbiAgICAgICAgICAgIGRhdGE6IGRhdGFKc29uLFxyXG4gICAgICAgICAgICBpbml0U3BJbmRleDogMyxcclxuICAgICAgICAgICAgZklEOiBmSUQrKyxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=